{"version":3,"sources":["libs/history.js","libs/picturefill.js","nation/Animation.js","nation/EventDispatcher.js","nation/ProgressBar.js","nation/Utils.js","syrup/Application.js","syrup/SiteMediator.js","syrup/common/BackgroundLines.js","syrup/common/EventDispatcher.js","syrup/common/Events.js","syrup/common/ShapeSystem.js","syrup/common/SiteBackground.js","syrup/common/SiteOptions.js","syrup/common/SiteSettings.js","syrup/common/core/BasicShape.js","syrup/common/shapes/ArcShape.js","syrup/common/shapes/CircleShape.js","syrup/common/shapes/LineShape.js","syrup/common/shapes/LShape.js","syrup/common/shapes/TriangleShape.js"],"names":[],"mappings":"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","file":"syrup.js","sourcesContent":["/*!\n * History API JavaScript Library v4.2.1\n *\n * Support: IE8+, FF3+, Opera 9+, Safari, Chrome and other\n *\n * Copyright 2011-2015, Dmitrii Pakhtinov ( spb.piksel@gmail.com )\n *\n * http://spb-piksel.ru/\n *\n * Dual licensed under the MIT and GPL licenses:\n *   http://www.opensource.org/licenses/mit-license.php\n *   http://www.gnu.org/licenses/gpl.html\n *\n * Update: 2015-05-22 13:02\n */\n(function(factory) {\n    if (typeof define === 'function' && define['amd']) {\n        // https://github.com/devote/HTML5-History-API/issues/73\n        var rndKey = '[history' + (new Date()).getTime() + ']';\n        var onError = requirejs['onError'];\n        factory.toString = function() {\n          return rndKey;\n        };\n        requirejs['onError'] = function(err) {\n          if (err.message.indexOf(rndKey) === -1) {\n            onError.call(requirejs, err);\n          }\n        };\n        define([], factory);\n    }\n    // execute anyway\n    factory();\n})(function() {\n    // Define global variable\n    var global = (typeof window === 'object' ? window : this) || {};\n    // Prevent the code from running if there is no window.history object or library already loaded\n    if (!global.history || \"emulate\" in global.history) return global.history;\n    // symlink to document\n    var document = global.document;\n    // HTML element\n    var documentElement = document.documentElement;\n    // symlink to constructor of Object\n    var Object = global['Object'];\n    // symlink to JSON Object\n    var JSON = global['JSON'];\n    // symlink to instance object of 'Location'\n    var windowLocation = global.location;\n    // symlink to instance object of 'History'\n    var windowHistory = global.history;\n    // new instance of 'History'. The default is a reference to the original object instance\n    var historyObject = windowHistory;\n    // symlink to method 'history.pushState'\n    var historyPushState = windowHistory.pushState;\n    // symlink to method 'history.replaceState'\n    var historyReplaceState = windowHistory.replaceState;\n    // if the browser supports HTML5-History-API\n    var isSupportHistoryAPI = !!historyPushState;\n    // verifies the presence of an object 'state' in interface 'History'\n    var isSupportStateObjectInHistory = 'state' in windowHistory;\n    // symlink to method 'Object.defineProperty'\n    var defineProperty = Object.defineProperty;\n    // new instance of 'Location', for IE8 will use the element HTMLAnchorElement, instead of pure object\n    var locationObject = redefineProperty({}, 't') ? {} : document.createElement('a');\n    // prefix for the names of events\n    var eventNamePrefix = '';\n    // String that will contain the name of the method\n    var addEventListenerName = global.addEventListener ? 'addEventListener' : (eventNamePrefix = 'on') && 'attachEvent';\n    // String that will contain the name of the method\n    var removeEventListenerName = global.removeEventListener ? 'removeEventListener' : 'detachEvent';\n    // String that will contain the name of the method\n    var dispatchEventName = global.dispatchEvent ? 'dispatchEvent' : 'fireEvent';\n    // reference native methods for the events\n    var addEvent = global[addEventListenerName];\n    var removeEvent = global[removeEventListenerName];\n    var dispatch = global[dispatchEventName];\n    // default settings\n    var settings = {\"basepath\": '/', \"redirect\": 0, \"type\": '/', \"init\": 0};\n    // key for the sessionStorage\n    var sessionStorageKey = '__historyAPI__';\n    // Anchor Element for parseURL function\n    var anchorElement = document.createElement('a');\n    // last URL before change to new URL\n    var lastURL = windowLocation.href;\n    // Control URL, need to fix the bug in Opera\n    var checkUrlForPopState = '';\n    // for fix on Safari 8\n    var triggerEventsInWindowAttributes = 1;\n    // trigger event 'onpopstate' on page load\n    var isFireInitialState = false;\n    // if used history.location of other code\n    var isUsedHistoryLocationFlag = 0;\n    // store a list of 'state' objects in the current session\n    var stateStorage = {};\n    // in this object will be stored custom handlers\n    var eventsList = {};\n    // stored last title\n    var lastTitle = document.title;\n\n    /**\n     * Properties that will be replaced in the global\n     * object 'window', to prevent conflicts\n     *\n     * @type {Object}\n     */\n    var eventsDescriptors = {\n        \"onhashchange\": null,\n        \"onpopstate\": null\n    };\n\n    /**\n     * Fix for Chrome in iOS\n     * See https://github.com/devote/HTML5-History-API/issues/29\n     */\n    var fastFixChrome = function(method, args) {\n        var isNeedFix = global.history !== windowHistory;\n        if (isNeedFix) {\n            global.history = windowHistory;\n        }\n        method.apply(windowHistory, args);\n        if (isNeedFix) {\n            global.history = historyObject;\n        }\n    };\n\n    /**\n     * Properties that will be replaced/added to object\n     * 'window.history', includes the object 'history.location',\n     * for a complete the work with the URL address\n     *\n     * @type {Object}\n     */\n    var historyDescriptors = {\n        /**\n         * Setting library initialization\n         *\n         * @param {null|String} [basepath] The base path to the site; defaults to the root \"/\".\n         * @param {null|String} [type] Substitute the string after the anchor; by default \"/\".\n         * @param {null|Boolean} [redirect] Enable link translation.\n         */\n        \"setup\": function(basepath, type, redirect) {\n            settings[\"basepath\"] = ('' + (basepath == null ? settings[\"basepath\"] : basepath))\n                .replace(/(?:^|\\/)[^\\/]*$/, '/');\n            settings[\"type\"] = type == null ? settings[\"type\"] : type;\n            settings[\"redirect\"] = redirect == null ? settings[\"redirect\"] : !!redirect;\n        },\n        /**\n         * @namespace history\n         * @param {String} [type]\n         * @param {String} [basepath]\n         */\n        \"redirect\": function(type, basepath) {\n            historyObject['setup'](basepath, type);\n            basepath = settings[\"basepath\"];\n            if (global.top == global.self) {\n                var relative = parseURL(null, false, true)._relative;\n                var path = windowLocation.pathname + windowLocation.search;\n                if (isSupportHistoryAPI) {\n                    path = path.replace(/([^\\/])$/, '$1/');\n                    if (relative != basepath && (new RegExp(\"^\" + basepath + \"$\", \"i\")).test(path)) {\n                        windowLocation.replace(relative);\n                    }\n                } else if (path != basepath) {\n                    path = path.replace(/([^\\/])\\?/, '$1/?');\n                    if ((new RegExp(\"^\" + basepath, \"i\")).test(path)) {\n                        windowLocation.replace(basepath + '#' + path.\n                            replace(new RegExp(\"^\" + basepath, \"i\"), settings[\"type\"]) + windowLocation.hash);\n                    }\n                }\n            }\n        },\n        /**\n         * The method adds a state object entry\n         * to the history.\n         *\n         * @namespace history\n         * @param {Object} state\n         * @param {string} title\n         * @param {string} [url]\n         */\n        pushState: function(state, title, url) {\n            var t = document.title;\n            if (lastTitle != null) {\n                document.title = lastTitle;\n            }\n            historyPushState && fastFixChrome(historyPushState, arguments);\n            changeState(state, url);\n            document.title = t;\n            lastTitle = title;\n        },\n        /**\n         * The method updates the state object,\n         * title, and optionally the URL of the\n         * current entry in the history.\n         *\n         * @namespace history\n         * @param {Object} state\n         * @param {string} title\n         * @param {string} [url]\n         */\n        replaceState: function(state, title, url) {\n            var t = document.title;\n            if (lastTitle != null) {\n                document.title = lastTitle;\n            }\n            delete stateStorage[windowLocation.href];\n            historyReplaceState && fastFixChrome(historyReplaceState, arguments);\n            changeState(state, url, true);\n            document.title = t;\n            lastTitle = title;\n        },\n        /**\n         * Object 'history.location' is similar to the\n         * object 'window.location', except that in\n         * HTML4 browsers it will behave a bit differently\n         *\n         * @namespace history\n         */\n        \"location\": {\n            set: function(value) {\n                if (isUsedHistoryLocationFlag === 0) isUsedHistoryLocationFlag = 1;\n                global.location = value;\n            },\n            get: function() {\n                if (isUsedHistoryLocationFlag === 0) isUsedHistoryLocationFlag = 1;\n                return isSupportHistoryAPI ? windowLocation : locationObject;\n            }\n        },\n        /**\n         * A state object is an object representing\n         * a user interface state.\n         *\n         * @namespace history\n         */\n        \"state\": {\n            get: function() {\n                return stateStorage[windowLocation.href] || null;\n            }\n        }\n    };\n\n    /**\n     * Properties for object 'history.location'.\n     * Object 'history.location' is similar to the\n     * object 'window.location', except that in\n     * HTML4 browsers it will behave a bit differently\n     *\n     * @type {Object}\n     */\n    var locationDescriptors = {\n        /**\n         * Navigates to the given page.\n         *\n         * @namespace history.location\n         */\n        assign: function(url) {\n            if (('' + url).indexOf('#') === 0) {\n                changeState(null, url);\n            } else {\n                windowLocation.assign(url);\n            }\n        },\n        /**\n         * Reloads the current page.\n         *\n         * @namespace history.location\n         */\n        reload: function() {\n            windowLocation.reload();\n        },\n        /**\n         * Removes the current page from\n         * the session history and navigates\n         * to the given page.\n         *\n         * @namespace history.location\n         */\n        replace: function(url) {\n            if (('' + url).indexOf('#') === 0) {\n                changeState(null, url, true);\n            } else {\n                windowLocation.replace(url);\n            }\n        },\n        /**\n         * Returns the current page's location.\n         *\n         * @namespace history.location\n         */\n        toString: function() {\n            return this.href;\n        },\n        /**\n         * Returns the current page's location.\n         * Can be set, to navigate to another page.\n         *\n         * @namespace history.location\n         */\n        \"href\": {\n            get: function() {\n                return parseURL()._href;\n            }\n        },\n        /**\n         * Returns the current page's protocol.\n         *\n         * @namespace history.location\n         */\n        \"protocol\": null,\n        /**\n         * Returns the current page's host and port number.\n         *\n         * @namespace history.location\n         */\n        \"host\": null,\n        /**\n         * Returns the current page's host.\n         *\n         * @namespace history.location\n         */\n        \"hostname\": null,\n        /**\n         * Returns the current page's port number.\n         *\n         * @namespace history.location\n         */\n        \"port\": null,\n        /**\n         * Returns the current page's path only.\n         *\n         * @namespace history.location\n         */\n        \"pathname\": {\n            get: function() {\n                return parseURL()._pathname;\n            }\n        },\n        /**\n         * Returns the current page's search\n         * string, beginning with the character\n         * '?' and to the symbol '#'\n         *\n         * @namespace history.location\n         */\n        \"search\": {\n            get: function() {\n                return parseURL()._search;\n            }\n        },\n        /**\n         * Returns the current page's hash\n         * string, beginning with the character\n         * '#' and to the end line\n         *\n         * @namespace history.location\n         */\n        \"hash\": {\n            set: function(value) {\n                changeState(null, ('' + value).replace(/^(#|)/, '#'), false, lastURL);\n            },\n            get: function() {\n                return parseURL()._hash;\n            }\n        }\n    };\n\n    /**\n     * Just empty function\n     *\n     * @return void\n     */\n    function emptyFunction() {\n        // dummy\n    }\n\n    /**\n     * Prepares a parts of the current or specified reference for later use in the library\n     *\n     * @param {string} [href]\n     * @param {boolean} [isWindowLocation]\n     * @param {boolean} [isNotAPI]\n     * @return {Object}\n     */\n    function parseURL(href, isWindowLocation, isNotAPI) {\n        var re = /(?:(\\w+\\:))?(?:\\/\\/(?:[^@]*@)?([^\\/:\\?#]+)(?::([0-9]+))?)?([^\\?#]*)(?:(\\?[^#]+)|\\?)?(?:(#.*))?/;\n        if (href != null && href !== '' && !isWindowLocation) {\n            var current = parseURL(),\n                base = document.getElementsByTagName('base')[0];\n            if (!isNotAPI && base && base.getAttribute('href')) {\n              // Fix for IE ignoring relative base tags.\n              // See http://stackoverflow.com/questions/3926197/html-base-tag-and-local-folder-path-with-internet-explorer\n              base.href = base.href;\n              current = parseURL(base.href, null, true);\n            }\n            var _pathname = current._pathname, _protocol = current._protocol;\n            // convert to type of string\n            href = '' + href;\n            // convert relative link to the absolute\n            href = /^(?:\\w+\\:)?\\/\\//.test(href) ? href.indexOf(\"/\") === 0\n                ? _protocol + href : href : _protocol + \"//\" + current._host + (\n                href.indexOf(\"/\") === 0 ? href : href.indexOf(\"?\") === 0\n                    ? _pathname + href : href.indexOf(\"#\") === 0\n                    ? _pathname + current._search + href : _pathname.replace(/[^\\/]+$/g, '') + href\n                );\n        } else {\n            href = isWindowLocation ? href : windowLocation.href;\n            // if current browser not support History-API\n            if (!isSupportHistoryAPI || isNotAPI) {\n                // get hash fragment\n                href = href.replace(/^[^#]*/, '') || \"#\";\n                // form the absolute link from the hash\n                // https://github.com/devote/HTML5-History-API/issues/50\n                href = windowLocation.protocol.replace(/:.*$|$/, ':') + '//' + windowLocation.host + settings['basepath']\n                    + href.replace(new RegExp(\"^#[\\/]?(?:\" + settings[\"type\"] + \")?\"), \"\");\n            }\n        }\n        // that would get rid of the links of the form: /../../\n        anchorElement.href = href;\n        // decompose the link in parts\n        var result = re.exec(anchorElement.href);\n        // host name with the port number\n        var host = result[2] + (result[3] ? ':' + result[3] : '');\n        // folder\n        var pathname = result[4] || '/';\n        // the query string\n        var search = result[5] || '';\n        // hash\n        var hash = result[6] === '#' ? '' : (result[6] || '');\n        // relative link, no protocol, no host\n        var relative = pathname + search + hash;\n        // special links for set to hash-link, if browser not support History API\n        var nohash = pathname.replace(new RegExp(\"^\" + settings[\"basepath\"], \"i\"), settings[\"type\"]) + search;\n        // result\n        return {\n            _href: result[1] + '//' + host + relative,\n            _protocol: result[1],\n            _host: host,\n            _hostname: result[2],\n            _port: result[3] || '',\n            _pathname: pathname,\n            _search: search,\n            _hash: hash,\n            _relative: relative,\n            _nohash: nohash,\n            _special: nohash + hash\n        }\n    }\n\n    /**\n     * Initializing storage for the custom state's object\n     */\n    function storageInitialize() {\n        var sessionStorage;\n        /**\n         * sessionStorage throws error when cookies are disabled\n         * Chrome content settings when running the site in a Facebook IFrame.\n         * see: https://github.com/devote/HTML5-History-API/issues/34\n         * and: http://stackoverflow.com/a/12976988/669360\n         */\n        try {\n            sessionStorage = global['sessionStorage'];\n            sessionStorage.setItem(sessionStorageKey + 't', '1');\n            sessionStorage.removeItem(sessionStorageKey + 't');\n        } catch(_e_) {\n            sessionStorage = {\n                getItem: function(key) {\n                    var cookie = document.cookie.split(key + \"=\");\n                    return cookie.length > 1 && cookie.pop().split(\";\").shift() || 'null';\n                },\n                setItem: function(key, value) {\n                    var state = {};\n                    // insert one current element to cookie\n                    if (state[windowLocation.href] = historyObject.state) {\n                        document.cookie = key + '=' + JSON.stringify(state);\n                    }\n                }\n            }\n        }\n\n        try {\n            // get cache from the storage in browser\n            stateStorage = JSON.parse(sessionStorage.getItem(sessionStorageKey)) || {};\n        } catch(_e_) {\n            stateStorage = {};\n        }\n\n        // hang up the event handler to event unload page\n        addEvent(eventNamePrefix + 'unload', function() {\n            // save current state's object\n            sessionStorage.setItem(sessionStorageKey, JSON.stringify(stateStorage));\n        }, false);\n    }\n\n    /**\n     * This method is implemented to override the built-in(native)\n     * properties in the browser, unfortunately some browsers are\n     * not allowed to override all the properties and even add.\n     * For this reason, this was written by a method that tries to\n     * do everything necessary to get the desired result.\n     *\n     * @param {Object} object The object in which will be overridden/added property\n     * @param {String} prop The property name to be overridden/added\n     * @param {Object} [descriptor] An object containing properties set/get\n     * @param {Function} [onWrapped] The function to be called when the wrapper is created\n     * @return {Object|Boolean} Returns an object on success, otherwise returns false\n     */\n    function redefineProperty(object, prop, descriptor, onWrapped) {\n        var testOnly = 0;\n        // test only if descriptor is undefined\n        if (!descriptor) {\n            descriptor = {set: emptyFunction};\n            testOnly = 1;\n        }\n        // variable will have a value of true the success of attempts to set descriptors\n        var isDefinedSetter = !descriptor.set;\n        var isDefinedGetter = !descriptor.get;\n        // for tests of attempts to set descriptors\n        var test = {configurable: true, set: function() {\n            isDefinedSetter = 1;\n        }, get: function() {\n            isDefinedGetter = 1;\n        }};\n\n        try {\n            // testing for the possibility of overriding/adding properties\n            defineProperty(object, prop, test);\n            // running the test\n            object[prop] = object[prop];\n            // attempt to override property using the standard method\n            defineProperty(object, prop, descriptor);\n        } catch(_e_) {\n        }\n\n        // If the variable 'isDefined' has a false value, it means that need to try other methods\n        if (!isDefinedSetter || !isDefinedGetter) {\n            // try to override/add the property, using deprecated functions\n            if (object.__defineGetter__) {\n                // testing for the possibility of overriding/adding properties\n                object.__defineGetter__(prop, test.get);\n                object.__defineSetter__(prop, test.set);\n                // running the test\n                object[prop] = object[prop];\n                // attempt to override property using the deprecated functions\n                descriptor.get && object.__defineGetter__(prop, descriptor.get);\n                descriptor.set && object.__defineSetter__(prop, descriptor.set);\n            }\n\n            // Browser refused to override the property, using the standard and deprecated methods\n            if (!isDefinedSetter || !isDefinedGetter) {\n                if (testOnly) {\n                    return false;\n                } else if (object === global) {\n                    // try override global properties\n                    try {\n                        // save original value from this property\n                        var originalValue = object[prop];\n                        // set null to built-in(native) property\n                        object[prop] = null;\n                    } catch(_e_) {\n                    }\n                    // This rule for Internet Explorer 8\n                    if ('execScript' in global) {\n                        /**\n                         * to IE8 override the global properties using\n                         * VBScript, declaring it in global scope with\n                         * the same names.\n                         */\n                        global['execScript']('Public ' + prop, 'VBScript');\n                        global['execScript']('var ' + prop + ';', 'JavaScript');\n                    } else {\n                        try {\n                            /**\n                             * This hack allows to override a property\n                             * with the set 'configurable: false', working\n                             * in the hack 'Safari' to 'Mac'\n                             */\n                            defineProperty(object, prop, {value: emptyFunction});\n                        } catch(_e_) {\n                            if (prop === 'onpopstate') {\n                                /**\n                                 * window.onpopstate fires twice in Safari 8.0.\n                                 * Block initial event on window.onpopstate\n                                 * See: https://github.com/devote/HTML5-History-API/issues/69\n                                 */\n                                addEvent('popstate', descriptor = function() {\n                                    removeEvent('popstate', descriptor, false);\n                                    var onpopstate = object.onpopstate;\n                                    // cancel initial event on attribute handler\n                                    object.onpopstate = null;\n                                    setTimeout(function() {\n                                      // restore attribute value after short time\n                                      object.onpopstate = onpopstate;\n                                    }, 1);\n                                }, false);\n                                // cancel trigger events on attributes in object the window\n                                triggerEventsInWindowAttributes = 0;\n                            }\n                        }\n                    }\n                    // set old value to new variable\n                    object[prop] = originalValue;\n\n                } else {\n                    // the last stage of trying to override the property\n                    try {\n                        try {\n                            // wrap the object in a new empty object\n                            var temp = Object.create(object);\n                            defineProperty(Object.getPrototypeOf(temp) === object ? temp : object, prop, descriptor);\n                            for(var key in object) {\n                                // need to bind a function to the original object\n                                if (typeof object[key] === 'function') {\n                                    temp[key] = object[key].bind(object);\n                                }\n                            }\n                            try {\n                                // to run a function that will inform about what the object was to wrapped\n                                onWrapped.call(temp, temp, object);\n                            } catch(_e_) {\n                            }\n                            object = temp;\n                        } catch(_e_) {\n                            // sometimes works override simply by assigning the prototype property of the constructor\n                            defineProperty(object.constructor.prototype, prop, descriptor);\n                        }\n                    } catch(_e_) {\n                        // all methods have failed\n                        return false;\n                    }\n                }\n            }\n        }\n\n        return object;\n    }\n\n    /**\n     * Adds the missing property in descriptor\n     *\n     * @param {Object} object An object that stores values\n     * @param {String} prop Name of the property in the object\n     * @param {Object|null} descriptor Descriptor\n     * @return {Object} Returns the generated descriptor\n     */\n    function prepareDescriptorsForObject(object, prop, descriptor) {\n        descriptor = descriptor || {};\n        // the default for the object 'location' is the standard object 'window.location'\n        object = object === locationDescriptors ? windowLocation : object;\n        // setter for object properties\n        descriptor.set = (descriptor.set || function(value) {\n            object[prop] = value;\n        });\n        // getter for object properties\n        descriptor.get = (descriptor.get || function() {\n            return object[prop];\n        });\n        return descriptor;\n    }\n\n    /**\n     * Wrapper for the methods 'addEventListener/attachEvent' in the context of the 'window'\n     *\n     * @param {String} event The event type for which the user is registering\n     * @param {Function} listener The method to be called when the event occurs.\n     * @param {Boolean} capture If true, capture indicates that the user wishes to initiate capture.\n     * @return void\n     */\n    function addEventListener(event, listener, capture) {\n        if (event in eventsList) {\n            // here stored the event listeners 'popstate/hashchange'\n            eventsList[event].push(listener);\n        } else {\n            // FireFox support non-standart four argument aWantsUntrusted\n            // https://github.com/devote/HTML5-History-API/issues/13\n            if (arguments.length > 3) {\n                addEvent(event, listener, capture, arguments[3]);\n            } else {\n                addEvent(event, listener, capture);\n            }\n        }\n    }\n\n    /**\n     * Wrapper for the methods 'removeEventListener/detachEvent' in the context of the 'window'\n     *\n     * @param {String} event The event type for which the user is registered\n     * @param {Function} listener The parameter indicates the Listener to be removed.\n     * @param {Boolean} capture Was registered as a capturing listener or not.\n     * @return void\n     */\n    function removeEventListener(event, listener, capture) {\n        var list = eventsList[event];\n        if (list) {\n            for(var i = list.length; i--;) {\n                if (list[i] === listener) {\n                    list.splice(i, 1);\n                    break;\n                }\n            }\n        } else {\n            removeEvent(event, listener, capture);\n        }\n    }\n\n    /**\n     * Wrapper for the methods 'dispatchEvent/fireEvent' in the context of the 'window'\n     *\n     * @param {Event|String} event Instance of Event or event type string if 'eventObject' used\n     * @param {*} [eventObject] For Internet Explorer 8 required event object on this argument\n     * @return {Boolean} If 'preventDefault' was called the value is false, else the value is true.\n     */\n    function dispatchEvent(event, eventObject) {\n        var eventType = ('' + (typeof event === \"string\" ? event : event.type)).replace(/^on/, '');\n        var list = eventsList[eventType];\n        if (list) {\n            // need to understand that there is one object of Event\n            eventObject = typeof event === \"string\" ? eventObject : event;\n            if (eventObject.target == null) {\n                // need to override some of the properties of the Event object\n                for(var props = ['target', 'currentTarget', 'srcElement', 'type']; event = props.pop();) {\n                    // use 'redefineProperty' to override the properties\n                    eventObject = redefineProperty(eventObject, event, {\n                        get: event === 'type' ? function() {\n                            return eventType;\n                        } : function() {\n                            return global;\n                        }\n                    });\n                }\n            }\n            if (triggerEventsInWindowAttributes) {\n              // run function defined in the attributes 'onpopstate/onhashchange' in the 'window' context\n              ((eventType === 'popstate' ? global.onpopstate : global.onhashchange)\n                  || emptyFunction).call(global, eventObject);\n            }\n            // run other functions that are in the list of handlers\n            for(var i = 0, len = list.length; i < len; i++) {\n                list[i].call(global, eventObject);\n            }\n            return true;\n        } else {\n            return dispatch(event, eventObject);\n        }\n    }\n\n    /**\n     * dispatch current state event\n     */\n    function firePopState() {\n        var o = document.createEvent ? document.createEvent('Event') : document.createEventObject();\n        if (o.initEvent) {\n            o.initEvent('popstate', false, false);\n        } else {\n            o.type = 'popstate';\n        }\n        o.state = historyObject.state;\n        // send a newly created events to be processed\n        dispatchEvent(o);\n    }\n\n    /**\n     * fire initial state for non-HTML5 browsers\n     */\n    function fireInitialState() {\n        if (isFireInitialState) {\n            isFireInitialState = false;\n            firePopState();\n        }\n    }\n\n    /**\n     * Change the data of the current history for HTML4 browsers\n     *\n     * @param {Object} state\n     * @param {string} [url]\n     * @param {Boolean} [replace]\n     * @param {string} [lastURLValue]\n     * @return void\n     */\n    function changeState(state, url, replace, lastURLValue) {\n        if (!isSupportHistoryAPI) {\n            // if not used implementation history.location\n            if (isUsedHistoryLocationFlag === 0) isUsedHistoryLocationFlag = 2;\n            // normalization url\n            var urlObject = parseURL(url, isUsedHistoryLocationFlag === 2 && ('' + url).indexOf(\"#\") !== -1);\n            // if current url not equal new url\n            if (urlObject._relative !== parseURL()._relative) {\n                // if empty lastURLValue to skip hash change event\n                lastURL = lastURLValue;\n                if (replace) {\n                    // only replace hash, not store to history\n                    windowLocation.replace(\"#\" + urlObject._special);\n                } else {\n                    // change hash and add new record to history\n                    windowLocation.hash = urlObject._special;\n                }\n            }\n        } else {\n            lastURL = windowLocation.href;\n        }\n        if (!isSupportStateObjectInHistory && state) {\n            stateStorage[windowLocation.href] = state;\n        }\n        isFireInitialState = false;\n    }\n\n    /**\n     * Event handler function changes the hash in the address bar\n     *\n     * @param {Event} event\n     * @return void\n     */\n    function onHashChange(event) {\n        // https://github.com/devote/HTML5-History-API/issues/46\n        var fireNow = lastURL;\n        // new value to lastURL\n        lastURL = windowLocation.href;\n        // if not empty fireNow, otherwise skipped the current handler event\n        if (fireNow) {\n            // if checkUrlForPopState equal current url, this means that the event was raised popstate browser\n            if (checkUrlForPopState !== windowLocation.href) {\n                // otherwise,\n                // the browser does not support popstate event or just does not run the event by changing the hash.\n                firePopState();\n            }\n            // current event object\n            event = event || global.event;\n\n            var oldURLObject = parseURL(fireNow, true);\n            var newURLObject = parseURL();\n            // HTML4 browser not support properties oldURL/newURL\n            if (!event.oldURL) {\n                event.oldURL = oldURLObject._href;\n                event.newURL = newURLObject._href;\n            }\n            if (oldURLObject._hash !== newURLObject._hash) {\n                // if current hash not equal previous hash\n                dispatchEvent(event);\n            }\n        }\n    }\n\n    /**\n     * The event handler is fully loaded document\n     *\n     * @param {*} [noScroll]\n     * @return void\n     */\n    function onLoad(noScroll) {\n        // Get rid of the events popstate when the first loading a document in the webkit browsers\n        setTimeout(function() {\n            // hang up the event handler for the built-in popstate event in the browser\n            addEvent('popstate', function(e) {\n                // set the current url, that suppress the creation of the popstate event by changing the hash\n                checkUrlForPopState = windowLocation.href;\n                // for Safari browser in OS Windows not implemented 'state' object in 'History' interface\n                // and not implemented in old HTML4 browsers\n                if (!isSupportStateObjectInHistory) {\n                    e = redefineProperty(e, 'state', {get: function() {\n                        return historyObject.state;\n                    }});\n                }\n                // send events to be processed\n                dispatchEvent(e);\n            }, false);\n        }, 0);\n        // for non-HTML5 browsers\n        if (!isSupportHistoryAPI && noScroll !== true && \"location\" in historyObject) {\n            // scroll window to anchor element\n            scrollToAnchorId(locationObject.hash);\n            // fire initial state for non-HTML5 browser after load page\n            fireInitialState();\n        }\n    }\n\n    /**\n     * Finds the closest ancestor anchor element (including the target itself).\n     *\n     * @param {HTMLElement} target The element to start scanning from.\n     * @return {HTMLElement} An element which is the closest ancestor anchor.\n     */\n    function anchorTarget(target) {\n        while (target) {\n            if (target.nodeName === 'A') return target;\n            target = target.parentNode;\n        }\n    }\n\n    /**\n     * Handles anchor elements with a hash fragment for non-HTML5 browsers\n     *\n     * @param {Event} e\n     */\n    function onAnchorClick(e) {\n        var event = e || global.event;\n        var target = anchorTarget(event.target || event.srcElement);\n        var defaultPrevented = \"defaultPrevented\" in event ? event['defaultPrevented'] : event.returnValue === false;\n        if (target && target.nodeName === \"A\" && !defaultPrevented) {\n            var current = parseURL();\n            var expect = parseURL(target.getAttribute(\"href\", 2));\n            var isEqualBaseURL = current._href.split('#').shift() === expect._href.split('#').shift();\n            if (isEqualBaseURL && expect._hash) {\n                if (current._hash !== expect._hash) {\n                    locationObject.hash = expect._hash;\n                }\n                scrollToAnchorId(expect._hash);\n                if (event.preventDefault) {\n                    event.preventDefault();\n                } else {\n                    event.returnValue = false;\n                }\n            }\n        }\n    }\n\n    /**\n     * Scroll page to current anchor in url-hash\n     *\n     * @param hash\n     */\n    function scrollToAnchorId(hash) {\n        var target = document.getElementById(hash = (hash || '').replace(/^#/, ''));\n        if (target && target.id === hash && target.nodeName === \"A\") {\n            var rect = target.getBoundingClientRect();\n            global.scrollTo((documentElement.scrollLeft || 0), rect.top + (documentElement.scrollTop || 0)\n                - (documentElement.clientTop || 0));\n        }\n    }\n\n    /**\n     * Library initialization\n     *\n     * @return {Boolean} return true if all is well, otherwise return false value\n     */\n    function initialize() {\n        /**\n         * Get custom settings from the query string\n         */\n        var scripts = document.getElementsByTagName('script');\n        var src = (scripts[scripts.length - 1] || {}).src || '';\n        var arg = src.indexOf('?') !== -1 ? src.split('?').pop() : '';\n        arg.replace(/(\\w+)(?:=([^&]*))?/g, function(a, key, value) {\n            settings[key] = (value || '').replace(/^(0|false)$/, '');\n        });\n\n        /**\n         * hang up the event handler to listen to the events hashchange\n         */\n        addEvent(eventNamePrefix + 'hashchange', onHashChange, false);\n\n        // a list of objects with pairs of descriptors/object\n        var data = [locationDescriptors, locationObject, eventsDescriptors, global, historyDescriptors, historyObject];\n\n        // if browser support object 'state' in interface 'History'\n        if (isSupportStateObjectInHistory) {\n            // remove state property from descriptor\n            delete historyDescriptors['state'];\n        }\n\n        // initializing descriptors\n        for(var i = 0; i < data.length; i += 2) {\n            for(var prop in data[i]) {\n                if (data[i].hasOwnProperty(prop)) {\n                    if (typeof data[i][prop] === 'function') {\n                        // If the descriptor is a simple function, simply just assign it an object\n                        data[i + 1][prop] = data[i][prop];\n                    } else {\n                        // prepare the descriptor the required format\n                        var descriptor = prepareDescriptorsForObject(data[i], prop, data[i][prop]);\n                        // try to set the descriptor object\n                        if (!redefineProperty(data[i + 1], prop, descriptor, function(n, o) {\n                            // is satisfied if the failed override property\n                            if (o === historyObject) {\n                                // the problem occurs in Safari on the Mac\n                                global.history = historyObject = data[i + 1] = n;\n                            }\n                        })) {\n                            // if there is no possibility override.\n                            // This browser does not support descriptors, such as IE7\n\n                            // remove previously hung event handlers\n                            removeEvent(eventNamePrefix + 'hashchange', onHashChange, false);\n\n                            // fail to initialize :(\n                            return false;\n                        }\n\n                        // create a repository for custom handlers onpopstate/onhashchange\n                        if (data[i + 1] === global) {\n                            eventsList[prop] = eventsList[prop.substr(2)] = [];\n                        }\n                    }\n                }\n            }\n        }\n\n        // check settings\n        historyObject['setup']();\n\n        // redirect if necessary\n        if (settings['redirect']) {\n            historyObject['redirect']();\n        }\n\n        // initialize\n        if (settings[\"init\"]) {\n            // You agree that you will use window.history.location instead window.location\n            isUsedHistoryLocationFlag = 1;\n        }\n\n        // If browser does not support object 'state' in interface 'History'\n        if (!isSupportStateObjectInHistory && JSON) {\n            storageInitialize();\n        }\n\n        // track clicks on anchors\n        if (!isSupportHistoryAPI) {\n            document[addEventListenerName](eventNamePrefix + \"click\", onAnchorClick, false);\n        }\n\n        if (document.readyState === 'complete') {\n            onLoad(true);\n        } else {\n            if (!isSupportHistoryAPI && parseURL()._relative !== settings[\"basepath\"]) {\n                isFireInitialState = true;\n            }\n            /**\n             * Need to avoid triggering events popstate the initial page load.\n             * Hang handler popstate as will be fully loaded document that\n             * would prevent triggering event onpopstate\n             */\n            addEvent(eventNamePrefix + 'load', onLoad, false);\n        }\n\n        // everything went well\n        return true;\n    }\n\n    /**\n     * Starting the library\n     */\n    if (!initialize()) {\n        // if unable to initialize descriptors\n        // therefore quite old browser and there\n        // is no sense to continue to perform\n        return;\n    }\n\n    /**\n     * If the property history.emulate will be true,\n     * this will be talking about what's going on\n     * emulation capabilities HTML5-History-API.\n     * Otherwise there is no emulation, ie the\n     * built-in browser capabilities.\n     *\n     * @type {boolean}\n     * @const\n     */\n    historyObject['emulate'] = !isSupportHistoryAPI;\n\n    /**\n     * Replace the original methods on the wrapper\n     */\n    global[addEventListenerName] = addEventListener;\n    global[removeEventListenerName] = removeEventListener;\n    global[dispatchEventName] = dispatchEvent;\n\n    return historyObject;\n});\n","/*! Picturefill - v3.0.0-beta1 - 2015-07-24\n* http://scottjehl.github.io/picturefill\n* Copyright (c) 2015 https://github.com/scottjehl/picturefill/blob/master/Authors.txt; Licensed MIT */\n(function(window) {\n\t/*jshint eqnull:true */\n\tvar ua = navigator.userAgent;\n\n\tif ( window.HTMLPictureElement && ((/ecko/).test(ua) && ua.match(/rv\\:(\\d+)/) && RegExp.$1 < 41) ) {\n\t\taddEventListener(\"resize\", (function() {\n\t\t\tvar timer;\n\n\t\t\tvar dummySrc = document.createElement(\"source\");\n\n\t\t\tvar fixRespimg = function(img) {\n\t\t\t\tvar source, sizes;\n\t\t\t\tvar picture = img.parentNode;\n\n\t\t\t\tif (picture.nodeName.toUpperCase() === \"PICTURE\") {\n\t\t\t\t\tsource = dummySrc.cloneNode();\n\n\t\t\t\t\tpicture.insertBefore(source, picture.firstElementChild);\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tpicture.removeChild(source);\n\t\t\t\t\t});\n\t\t\t\t} else if (!img._pfLastSize || img.offsetWidth > img._pfLastSize) {\n\t\t\t\t\timg._pfLastSize = img.offsetWidth;\n\t\t\t\t\tsizes = img.sizes;\n\t\t\t\t\timg.sizes += \",100vw\";\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\timg.sizes = sizes;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar findPictureImgs = function() {\n\t\t\t\tvar i;\n\t\t\t\tvar imgs = document.querySelectorAll(\"picture > img, img[srcset][sizes]\");\n\t\t\t\tfor (i = 0; i < imgs.length; i++) {\n\t\t\t\t\tfixRespimg(imgs[i]);\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar onResize = function() {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = setTimeout(findPictureImgs, 99);\n\t\t\t};\n\t\t\tvar mq = window.matchMedia && matchMedia(\"(orientation: landscape)\");\n\t\t\tvar init = function() {\n\t\t\t\tonResize();\n\n\t\t\t\tif (mq && mq.addListener) {\n\t\t\t\t\tmq.addListener(onResize);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tdummySrc.srcset = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n\n\t\t\tif (/^[c|i]|d$/.test(document.readyState || \"\")) {\n\t\t\t\tinit();\n\t\t\t} else {\n\t\t\t\tdocument.addEventListener(\"DOMContentLoaded\", init);\n\t\t\t}\n\n\t\t\treturn onResize;\n\t\t})());\n\t}\n})(window);\n\n/*! Picturefill - Responsive Images that work today.\n *  Author: Scott Jehl, Filament Group, 2012 ( new proposal implemented by Shawn Jansepar )\n *  License: MIT\n *  Spec: http://picture.responsiveimages.org/\n */\n(function( window, document, undefined ) {\n\t/* global parseSizes */\n\t// Enable strict mode\n\t\"use strict\";\n\n\t// HTML shim|v it for old IE (IE9 will still need the HTML video tag workaround)\n\tdocument.createElement( \"picture\" );\n\n\tvar warn, eminpx, alwaysCheckWDescriptor, evalId;\n\t// local object for method references and testing exposure\n\tvar pf = {};\n\tvar noop = function() {};\n\tvar image = document.createElement( \"img\" );\n\tvar getImgAttr = image.getAttribute;\n\tvar setImgAttr = image.setAttribute;\n\tvar removeImgAttr = image.removeAttribute;\n\tvar docElem = document.documentElement;\n\tvar types = {};\n\tvar cfg = {\n\t\t//resource selection:\n\t\talgorithm: \"\"\n\t};\n\tvar srcAttr = \"data-pfsrc\";\n\tvar srcsetAttr = srcAttr + \"set\";\n\t// ua sniffing is done for undetectable img loading features,\n\t// to do some non crucial perf optimizations\n\tvar ua = navigator.userAgent;\n\tvar supportAbort = (/rident/).test(ua) || ((/ecko/).test(ua) && ua.match(/rv\\:(\\d+)/) && RegExp.$1 > 35 );\n\tvar curSrcProp = \"currentSrc\";\n\tvar regWDesc = /\\s+\\+?\\d+(e\\d+)?w/;\n\tvar regSize = /(\\([^)]+\\))?\\s*(.+)/;\n\tvar setOptions = window.picturefillCFG;\n\t/**\n\t * Shortcut property for https://w3c.github.io/webappsec/specs/mixedcontent/#restricts-mixed-content ( for easy overriding in tests )\n\t */\n\t// baseStyle also used by getEmValue (i.e.: width: 1em is important)\n\tvar baseStyle = \"position:absolute;left:0;visibility:hidden;display:block;padding:0;border:none;font-size:1em;width:1em;overflow:hidden;clip:rect(0px, 0px, 0px, 0px)\";\n\tvar fsCss = \"font-size:100%!important;\";\n\tvar isVwDirty = true;\n\n\tvar cssCache = {};\n\tvar sizeLengthCache = {};\n\tvar DPR = window.devicePixelRatio;\n\tvar units = {\n\t\tpx: 1,\n\t\t\"in\": 96\n\t};\n\tvar anchor = document.createElement( \"a\" );\n\t/**\n\t * alreadyRun flag used for setOptions. is it true setOptions will reevaluate\n\t * @type {boolean}\n\t */\n\tvar alreadyRun = false;\n\n\t// Reusable, non-\"g\" Regexes\n\n\t// (Don't use \\s, to avoid matching non-breaking space.)\n\tvar regexLeadingSpaces = /^[ \\t\\n\\r\\u000c]+/,\n\t    regexLeadingCommasOrSpaces = /^[, \\t\\n\\r\\u000c]+/,\n\t    regexLeadingNotSpaces = /^[^ \\t\\n\\r\\u000c]+/,\n\t    regexTrailingCommas = /[,]+$/,\n\t    regexNonNegativeInteger = /^\\d+$/,\n\n\t    // ( Positive or negative or unsigned integers or decimals, without or without exponents.\n\t    // Must include at least one digit.\n\t    // According to spec tests any decimal point must be followed by a digit.\n\t    // No leading plus sign is allowed.)\n\t    // https://html.spec.whatwg.org/multipage/infrastructure.html#valid-floating-point-number\n\t    regexFloatingPoint = /^-?(?:[0-9]+|[0-9]*\\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/;\n\n\tvar on = function(obj, evt, fn, capture) {\n\t\tif ( obj.addEventListener ) {\n\t\t\tobj.addEventListener(evt, fn, capture || false);\n\t\t} else if ( obj.attachEvent ) {\n\t\t\tobj.attachEvent( \"on\" + evt, fn);\n\t\t}\n\t};\n\n\t/**\n\t * simple memoize function:\n\t */\n\n\tvar memoize = function(fn) {\n\t\tvar cache = {};\n\t\treturn function(input) {\n\t\t\tif ( !(input in cache) ) {\n\t\t\t\tcache[ input ] = fn(input);\n\t\t\t}\n\t\t\treturn cache[ input ];\n\t\t};\n\t};\n\n\t// UTILITY FUNCTIONS\n\n\t// Manual is faster than RegEx\n\t// http://jsperf.com/whitespace-character/5\n\tfunction isSpace(c) {\n\t\treturn (c === \"\\u0020\" || // space\n\t\t        c === \"\\u0009\" || // horizontal tab\n\t\t        c === \"\\u000A\" || // new line\n\t\t        c === \"\\u000C\" || // form feed\n\t\t        c === \"\\u000D\");  // carriage return\n\t}\n\n\t/**\n\t * gets a mediaquery and returns a boolean or gets a css length and returns a number\n\t * @param css mediaqueries or css length\n\t * @returns {boolean|number}\n\t *\n\t * based on: https://gist.github.com/jonathantneal/db4f77009b155f083738\n\t */\n\tvar evalCSS = (function() {\n\n\t\tvar regLength = /^([\\d\\.]+)(em|vw|px)$/;\n\t\tvar replace = function() {\n\t\t\tvar args = arguments, index = 0, string = args[0];\n\t\t\twhile (++index in args) {\n\t\t\t\tstring = string.replace(args[index], args[++index]);\n\t\t\t}\n\t\t\treturn string;\n\t\t};\n\n\t\tvar buidlStr = memoize(function(css) {\n\n\t\t\treturn \"return \" + replace((css || \"\").toLowerCase(),\n\t\t\t\t// interpret `and`\n\t\t\t\t/\\band\\b/g, \"&&\",\n\n\t\t\t\t// interpret `,`\n\t\t\t\t/,/g, \"||\",\n\n\t\t\t\t// interpret `min-` as >=\n\t\t\t\t/min-([a-z-\\s]+):/g, \"e.$1>=\",\n\n\t\t\t\t// interpret `max-` as <=\n\t\t\t\t/max-([a-z-\\s]+):/g, \"e.$1<=\",\n\n\t\t\t\t//calc value\n\t\t\t\t/calc([^)]+)/g, \"($1)\",\n\n\t\t\t\t// interpret css values\n\t\t\t\t/(\\d+[\\.]*[\\d]*)([a-z]+)/g, \"($1 * e.$2)\",\n\t\t\t\t//make eval less evil\n\t\t\t\t/^(?!(e.[a-z]|[0-9\\.&=|><\\+\\-\\*\\(\\)\\/])).*/ig, \"\"\n\t\t\t) + \";\";\n\t\t});\n\n\t\treturn function(css, length) {\n\t\t\tvar parsedLength;\n\t\t\tif (!(css in cssCache)) {\n\t\t\t\tcssCache[css] = false;\n\t\t\t\tif (length && (parsedLength = css.match( regLength ))) {\n\t\t\t\t\tcssCache[css] = parsedLength[ 1 ] * units[parsedLength[ 2 ]];\n\t\t\t\t} else {\n\t\t\t\t\t/*jshint evil:true */\n\t\t\t\t\ttry{\n\t\t\t\t\t\tcssCache[css] = new Function(\"e\", buidlStr(css))(units);\n\t\t\t\t\t} catch(e) {}\n\t\t\t\t\t/*jshint evil:false */\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn cssCache[css];\n\t\t};\n\t})();\n\n\tvar setResolution = function( candidate, sizesattr ) {\n\t\tif ( candidate.w ) { // h = means height: || descriptor.type === 'h' do not handle yet...\n\t\t\tcandidate.cWidth = pf.calcListLength( sizesattr || \"100vw\" );\n\t\t\tcandidate.res = candidate.w / candidate.cWidth ;\n\t\t} else {\n\t\t\tcandidate.res = candidate.d;\n\t\t}\n\t\treturn candidate;\n\t};\n\n\t/**\n\t *\n\t * @param opt\n\t */\n\tvar picturefill = function( opt ) {\n\t\tvar elements, i, plen;\n\n\t\tvar options = opt || {};\n\n\t\tif ( options.elements && options.elements.nodeType === 1 ) {\n\t\t\tif ( options.elements.nodeName.toUpperCase() === \"IMG\" ) {\n\t\t\t\toptions.elements =  [ options.elements ];\n\t\t\t} else {\n\t\t\t\toptions.context = options.elements;\n\t\t\t\toptions.elements =  null;\n\t\t\t}\n\t\t}\n\n\t\telements = options.elements || pf.qsa( (options.context || document), ( options.reevaluate || options.reselect ) ? pf.sel : pf.selShort );\n\n\t\tif ( (plen = elements.length) ) {\n\n\t\t\tpf.setupRun( options );\n\t\t\talreadyRun = true;\n\n\t\t\t// Loop through all elements\n\t\t\tfor ( i = 0; i < plen; i++ ) {\n\t\t\t\tpf.fillImg(elements[ i ], options);\n\t\t\t}\n\n\t\t\tpf.teardownRun( options );\n\t\t}\n\t};\n\n\t/**\n\t * outputs a warning for the developer\n\t * @param {message}\n\t * @type {Function}\n\t */\n\twarn = ( window.console && console.warn ) ?\n\t\tfunction( message ) {\n\t\t\tconsole.warn( message );\n\t\t} :\n\t\tnoop\n\t;\n\n\tif ( !(curSrcProp in image) ) {\n\t\tcurSrcProp = \"src\";\n\t}\n\n\t// Add support for standard mime types.\n\ttypes[ \"image/jpeg\" ] = true;\n\ttypes[ \"image/gif\" ] = true;\n\ttypes[ \"image/png\" ] = true;\n\n\tfunction detectTypeSupport( type, typeUri ) {\n\t\t// based on Modernizr's lossless img-webp test\n\t\t// note: asynchronous\n\t\tvar image = new window.Image();\n\t\timage.onerror = function() {\n\t\t\ttypes[ type ] = false;\n\t\t\tpicturefill();\n\t\t};\n\t\timage.onload = function() {\n\t\t\ttypes[ type ] = image.width === 1;\n\t\t\tpicturefill();\n\t\t};\n\t\timage.src = typeUri;\n\t\treturn \"pending\";\n\t}\n\n\t// test svg support\n\ttypes[ \"image/svg+xml\" ] = document.implementation.hasFeature( \"http://wwwindow.w3.org/TR/SVG11/feature#Image\", \"1.1\" );\n\n\t/**\n\t * updates the internal vW property with the current viewport width in px\n\t */\n\tfunction updateMetrics() {\n\n\t\tisVwDirty = false;\n\t\tDPR = window.devicePixelRatio;\n\t\tcssCache = {};\n\t\tsizeLengthCache = {};\n\n\t\tpf.DPR = DPR || 1;\n\n\t\tunits.width = Math.max(window.innerWidth || 0, docElem.clientWidth);\n\t\tunits.height = Math.max(window.innerHeight || 0, docElem.clientHeight);\n\n\t\tunits.vw = units.width / 100;\n\t\tunits.vh = units.height / 100;\n\n\t\tevalId = [ units.height, units.width, DPR ].join(\"-\");\n\n\t\tunits.em = pf.getEmValue();\n\t\tunits.rem = units.em;\n\t}\n\n\tfunction chooseLowRes( lowerValue, higherValue, dprValue, isCached ) {\n\t\tvar bonusFactor, tooMuch, bonus, meanDensity;\n\n\t\t//experimental\n\t\tif (cfg.algorithm === \"saveData\" ){\n\t\t\tif ( lowerValue > 2.7 ) {\n\t\t\t\tmeanDensity = dprValue + 1;\n\t\t\t} else {\n\t\t\t\ttooMuch = higherValue - dprValue;\n\t\t\t\tbonusFactor = Math.pow(lowerValue - 0.6, 1.5);\n\n\t\t\t\tbonus = tooMuch * bonusFactor;\n\n\t\t\t\tif (isCached) {\n\t\t\t\t\tbonus += 0.1 * bonusFactor;\n\t\t\t\t}\n\n\t\t\t\tmeanDensity = lowerValue + bonus;\n\t\t\t}\n\t\t} else {\n\t\t\tmeanDensity = (dprValue > 1) ?\n\t\t\t\tMath.sqrt(lowerValue * higherValue) :\n\t\t\t\tlowerValue;\n\t\t}\n\n\t\treturn meanDensity > dprValue;\n\t}\n\n\tfunction applyBestCandidate( img ) {\n\t\tvar srcSetCandidates;\n\t\tvar matchingSet = pf.getSet( img );\n\t\tvar evaluated = false;\n\t\tif ( matchingSet !== \"pending\" ) {\n\t\t\tevaluated = evalId;\n\t\t\tif ( matchingSet ) {\n\t\t\t\tsrcSetCandidates = pf.setRes( matchingSet );\n\t\t\t\tpf.applySetCandidate( srcSetCandidates, img );\n\t\t\t}\n\t\t}\n\t\timg[ pf.ns ].evaled = evaluated;\n\t}\n\n\tfunction ascendingSort( a, b ) {\n\t\treturn a.res - b.res;\n\t}\n\n\tfunction setSrcToCur( img, src, set ) {\n\t\tvar candidate;\n\t\tif ( !set && src ) {\n\t\t\tset = img[ pf.ns ].sets;\n\t\t\tset = set && set[set.length - 1];\n\t\t}\n\n\t\tcandidate = getCandidateForSrc(src, set);\n\n\t\tif ( candidate ) {\n\t\t\tsrc = pf.makeUrl(src);\n\t\t\timg[ pf.ns ].curSrc = src;\n\t\t\timg[ pf.ns ].curCan = candidate;\n\n\t\t\tif ( !candidate.res ) {\n\t\t\t\tsetResolution( candidate, candidate.set.sizes );\n\t\t\t}\n\t\t}\n\t\treturn candidate;\n\t}\n\n\tfunction getCandidateForSrc( src, set ) {\n\t\tvar i, candidate, candidates;\n\t\tif ( src && set ) {\n\t\t\tcandidates = pf.parseSet( set );\n\t\t\tsrc = pf.makeUrl(src);\n\t\t\tfor ( i = 0; i < candidates.length; i++ ) {\n\t\t\t\tif ( src === pf.makeUrl(candidates[ i ].url) ) {\n\t\t\t\t\tcandidate = candidates[ i ];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn candidate;\n\t}\n\n\tfunction getAllSourceElements( picture, candidates ) {\n\t\tvar i, len, source, srcset;\n\n\t\t// SPEC mismatch intended for size and perf:\n\t\t// actually only source elements preceding the img should be used\n\t\t// also note: don't use qsa here, because IE8 sometimes doesn't like source as the key part in a selector\n\t\tvar sources = picture.getElementsByTagName( \"source\" );\n\n\t\tfor ( i = 0, len = sources.length; i < len; i++ ) {\n\t\t\tsource = sources[ i ];\n\t\t\tsource[ pf.ns ] = true;\n\t\t\tsrcset = source.getAttribute( \"srcset\" );\n\n\t\t\t// if source does not have a srcset attribute, skip\n\t\t\tif ( srcset ) {\n\t\t\t\tcandidates.push( {\n\t\t\t\t\tsrcset: srcset,\n\t\t\t\t\tmedia: source.getAttribute( \"media\" ),\n\t\t\t\t\ttype: source.getAttribute( \"type\" ),\n\t\t\t\t\tsizes: source.getAttribute( \"sizes\" )\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Srcset Parser\n\t * By Alex Bell |  MIT License\n\t *\n\t * @returns Array [{url: _, d: _, w: _, h:_, set:_(????)}, ...]\n\t *\n\t * Based super duper closely on the reference algorithm at:\n\t * https://html.spec.whatwg.org/multipage/embedded-content.html#parse-a-srcset-attribute\n\t */\n\n\t// 1. Let input be the value passed to this algorithm.\n\t// (TO-DO : Explain what \"set\" argument is here. Maybe choose a more\n\t// descriptive & more searchable name.  Since passing the \"set\" in really has\n\t// nothing to do with parsing proper, I would prefer this assignment eventually\n\t// go in an external fn.)\n\tfunction parseSrcset(input, set) {\n\n\t\tfunction collectCharacters(regEx) {\n\t\t\tvar chars,\n\t\t\t    match = regEx.exec(input.substring(pos));\n\t\t\tif (match) {\n\t\t\t\tchars = match[ 0 ];\n\t\t\t\tpos += chars.length;\n\t\t\t\treturn chars;\n\t\t\t}\n\t\t}\n\n\t\tvar inputLength = input.length,\n\t\t    url,\n\t\t    descriptors,\n\t\t    currentDescriptor,\n\t\t    state,\n\t\t    c,\n\n\t\t    // 2. Let position be a pointer into input, initially pointing at the start\n\t\t    //    of the string.\n\t\t    pos = 0,\n\n\t\t    // 3. Let candidates be an initially empty source set.\n\t\t    candidates = [];\n\n\t\t/**\n\t\t* Adds descriptor properties to a candidate, pushes to the candidates array\n\t\t* @return undefined\n\t\t*/\n\t\t// (Declared outside of the while loop so that it's only created once.\n\t\t// (This fn is defined before it is used, in order to pass JSHINT.\n\t\t// Unfortunately this breaks the sequencing of the spec comments. :/ )\n\t\tfunction parseDescriptors() {\n\n\t\t\t// 9. Descriptor parser: Let error be no.\n\t\t\tvar pError = false,\n\n\t\t\t// 10. Let width be absent.\n\t\t\t// 11. Let density be absent.\n\t\t\t// 12. Let future-compat-h be absent. (We're implementing it now as h)\n\t\t\t    w, d, h, i,\n\t\t\t    candidate = {},\n\t\t\t    desc, lastChar, value, intVal, floatVal;\n\n\t\t\t// 13. For each descriptor in descriptors, run the appropriate set of steps\n\t\t\t// from the following list:\n\t\t\tfor (i = 0 ; i < descriptors.length; i++) {\n\t\t\t\tdesc = descriptors[ i ];\n\n\t\t\t\tlastChar = desc[ desc.length - 1 ];\n\t\t\t\tvalue = desc.substring(0, desc.length - 1);\n\t\t\t\tintVal = parseInt(value, 10);\n\t\t\t\tfloatVal = parseFloat(value);\n\n\t\t\t\t// If the descriptor consists of a valid non-negative integer followed by\n\t\t\t\t// a U+0077 LATIN SMALL LETTER W character\n\t\t\t\tif (regexNonNegativeInteger.test(value) && (lastChar === \"w\")) {\n\n\t\t\t\t\t// If width and density are not both absent, then let error be yes.\n\t\t\t\t\tif (w || d) {pError = true;}\n\n\t\t\t\t\t// Apply the rules for parsing non-negative integers to the descriptor.\n\t\t\t\t\t// If the result is zero, let error be yes.\n\t\t\t\t\t// Otherwise, let width be the result.\n\t\t\t\t\tif (intVal === 0) {pError = true;} else {w = intVal;}\n\n\t\t\t\t// If the descriptor consists of a valid floating-point number followed by\n\t\t\t\t// a U+0078 LATIN SMALL LETTER X character\n\t\t\t\t} else if (regexFloatingPoint.test(value) && (lastChar === \"x\")) {\n\n\t\t\t\t\t// If width, density and future-compat-h are not all absent, then let error\n\t\t\t\t\t// be yes.\n\t\t\t\t\tif (w || d || h) {pError = true;}\n\n\t\t\t\t\t// Apply the rules for parsing floating-point number values to the descriptor.\n\t\t\t\t\t// If the result is less than zero, let error be yes. Otherwise, let density\n\t\t\t\t\t// be the result.\n\t\t\t\t\tif (floatVal < 0) {pError = true;} else {d = floatVal;}\n\n\t\t\t\t// If the descriptor consists of a valid non-negative integer followed by\n\t\t\t\t// a U+0068 LATIN SMALL LETTER H character\n\t\t\t\t} else if (regexNonNegativeInteger.test(value) && (lastChar === \"h\")) {\n\n\t\t\t\t\t// If height and density are not both absent, then let error be yes.\n\t\t\t\t\tif (h || d) {pError = true;}\n\n\t\t\t\t\t// Apply the rules for parsing non-negative integers to the descriptor.\n\t\t\t\t\t// If the result is zero, let error be yes. Otherwise, let future-compat-h\n\t\t\t\t\t// be the result.\n\t\t\t\t\tif (intVal === 0) {pError = true;} else {h = intVal;}\n\n\t\t\t\t// Anything else, Let error be yes.\n\t\t\t\t} else {pError = true;}\n\t\t\t} // (close step 13 for loop)\n\n\t\t\t// 15. If error is still no, then append a new image source to candidates whose\n\t\t\t// URL is url, associated with a width width if not absent and a pixel\n\t\t\t// density density if not absent. Otherwise, there is a parse error.\n\t\t\tif (!pError) {\n\t\t\t\tcandidate.url = url;\n\n\t\t\t\tif (w) { candidate.w = w;}\n\t\t\t\tif (d) { candidate.d = d;}\n\t\t\t\tif (h) { candidate.h = h;}\n\t\t\t\tif (!h && !d && !w) {candidate.d = 1;}\n\t\t\t\tif (candidate.d === 1) {set.has1x = true;}\n\t\t\t\tcandidate.set = set;\n\n\t\t\t\tcandidates.push(candidate);\n\t\t\t}\n\t\t} // (close parseDescriptors fn)\n\n\t\t/**\n\t\t* Tokenizes descriptor properties prior to parsing\n\t\t* Returns undefined.\n\t\t* (Again, this fn is defined before it is used, in order to pass JSHINT.\n\t\t* Unfortunately this breaks the logical sequencing of the spec comments. :/ )\n\t\t*/\n\t\tfunction tokenize() {\n\n\t\t\t// 8.1. Descriptor tokeniser: Skip whitespace\n\t\t\tcollectCharacters(regexLeadingSpaces);\n\n\t\t\t// 8.2. Let current descriptor be the empty string.\n\t\t\tcurrentDescriptor = \"\";\n\n\t\t\t// 8.3. Let state be in descriptor.\n\t\t\tstate = \"in descriptor\";\n\n\t\t\twhile (true) {\n\n\t\t\t\t// 8.4. Let c be the character at position.\n\t\t\t\tc = input.charAt(pos);\n\n\t\t\t\t//  Do the following depending on the value of state.\n\t\t\t\t//  For the purpose of this step, \"EOF\" is a special character representing\n\t\t\t\t//  that position is past the end of input.\n\n\t\t\t\t// In descriptor\n\t\t\t\tif (state === \"in descriptor\") {\n\t\t\t\t\t// Do the following, depending on the value of c:\n\n\t\t\t\t  // Space character\n\t\t\t\t  // If current descriptor is not empty, append current descriptor to\n\t\t\t\t  // descriptors and let current descriptor be the empty string.\n\t\t\t\t  // Set state to after descriptor.\n\t\t\t\t\tif (isSpace(c)) {\n\t\t\t\t\t\tif (currentDescriptor) {\n\t\t\t\t\t\t\tdescriptors.push(currentDescriptor);\n\t\t\t\t\t\t\tcurrentDescriptor = \"\";\n\t\t\t\t\t\t\tstate = \"after descriptor\";\n\t\t\t\t\t\t}\n\n\t\t\t\t\t// U+002C COMMA (,)\n\t\t\t\t\t// Advance position to the next character in input. If current descriptor\n\t\t\t\t\t// is not empty, append current descriptor to descriptors. Jump to the step\n\t\t\t\t\t// labeled descriptor parser.\n\t\t\t\t\t} else if (c === \",\") {\n\t\t\t\t\t\tpos += 1;\n\t\t\t\t\t\tif (currentDescriptor) {\n\t\t\t\t\t\t\tdescriptors.push(currentDescriptor);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparseDescriptors();\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t// U+0028 LEFT PARENTHESIS (()\n\t\t\t\t\t// Append c to current descriptor. Set state to in parens.\n\t\t\t\t\t} else if (c === \"\\u0028\") {\n\t\t\t\t\t\tcurrentDescriptor = currentDescriptor + c;\n\t\t\t\t\t\tstate = \"in parens\";\n\n\t\t\t\t\t// EOF\n\t\t\t\t\t// If current descriptor is not empty, append current descriptor to\n\t\t\t\t\t// descriptors. Jump to the step labeled descriptor parser.\n\t\t\t\t\t} else if (c === \"\") {\n\t\t\t\t\t\tif (currentDescriptor) {\n\t\t\t\t\t\t\tdescriptors.push(currentDescriptor);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparseDescriptors();\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t// Anything else\n\t\t\t\t\t// Append c to current descriptor.\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurrentDescriptor = currentDescriptor + c;\n\t\t\t\t\t}\n\t\t\t\t// (end \"in descriptor\"\n\n\t\t\t\t// In parens\n\t\t\t\t} else if (state === \"in parens\") {\n\n\t\t\t\t\t// U+0029 RIGHT PARENTHESIS ())\n\t\t\t\t\t// Append c to current descriptor. Set state to in descriptor.\n\t\t\t\t\tif (c === \")\") {\n\t\t\t\t\t\tcurrentDescriptor = currentDescriptor + c;\n\t\t\t\t\t\tstate = \"in descriptor\";\n\n\t\t\t\t\t// EOF\n\t\t\t\t\t// Append current descriptor to descriptors. Jump to the step labeled\n\t\t\t\t\t// descriptor parser.\n\t\t\t\t\t} else if (c === \"\") {\n\t\t\t\t\t\tdescriptors.push(currentDescriptor);\n\t\t\t\t\t\tparseDescriptors();\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t// Anything else\n\t\t\t\t\t// Append c to current descriptor.\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurrentDescriptor = currentDescriptor + c;\n\t\t\t\t\t}\n\n\t\t\t\t// After descriptor\n\t\t\t\t} else if (state === \"after descriptor\") {\n\n\t\t\t\t\t// Do the following, depending on the value of c:\n\t\t\t\t\t// Space character: Stay in this state.\n\t\t\t\t\tif (isSpace(c)) {\n\n\t\t\t\t\t// EOF: Jump to the step labeled descriptor parser.\n\t\t\t\t\t} else if (c === \"\") {\n\t\t\t\t\t\tparseDescriptors();\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t// Anything else\n\t\t\t\t\t// Set state to in descriptor. Set position to the previous character in input.\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstate = \"in descriptor\";\n\t\t\t\t\t\tpos -= 1;\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Advance position to the next character in input.\n\t\t\t\tpos += 1;\n\n\t\t\t// Repeat this step.\n\t\t\t} // (close while true loop)\n\t\t}\n\n\t\t// 4. Splitting loop: Collect a sequence of characters that are space\n\t\t//    characters or U+002C COMMA characters. If any U+002C COMMA characters\n\t\t//    were collected, that is a parse error.\n\t\twhile (true) {\n\t\t\tcollectCharacters(regexLeadingCommasOrSpaces);\n\n\t\t\t// 5. If position is past the end of input, return candidates and abort these steps.\n\t\t\tif (pos >= inputLength) {\n\t\t\t\treturn candidates; // (we're done, this is the sole return path)\n\t\t\t}\n\n\t\t\t// 6. Collect a sequence of characters that are not space characters,\n\t\t\t//    and let that be url.\n\t\t\turl = collectCharacters(regexLeadingNotSpaces);\n\n\t\t\t// 7. Let descriptors be a new empty list.\n\t\t\tdescriptors = [];\n\n\t\t\t// 8. If url ends with a U+002C COMMA character (,), follow these substeps:\n\t\t\t//\t\t(1). Remove all trailing U+002C COMMA characters from url. If this removed\n\t\t\t//         more than one character, that is a parse error.\n\t\t\tif (url.slice(-1) === \",\") {\n\t\t\t\turl = url.replace(regexTrailingCommas, \"\");\n\t\t\t\t// (Jump ahead to step 9 to skip tokenization and just push the candidate).\n\t\t\t\tparseDescriptors();\n\n\t\t\t//\tOtherwise, follow these substeps:\n\t\t\t} else {\n\t\t\t\ttokenize();\n\t\t\t} // (close else of step 8)\n\n\t\t// 16. Return to the step labeled splitting loop.\n\t\t} // (Close of big while loop.)\n\t}\n\n\t/* jshint ignore:start */\n\t// jscs:disable\n\n\t/*\n\t * Sizes Parser\n\t *\n\t * By Alex Bell |  MIT License\n\t *\n\t * Non-strict but accurate and lightweight JS Parser for the string value <img sizes=\"here\">\n\t *\n\t * Reference algorithm at:\n\t * https://html.spec.whatwg.org/multipage/embedded-content.html#parse-a-sizes-attribute\n\t *\n\t * Most comments are copied in directly from the spec\n\t * (except for comments in parens).\n\t *\n\t * Grammar is:\n\t * <source-size-list> = <source-size># [ , <source-size-value> ]? | <source-size-value>\n\t * <source-size> = <media-condition> <source-size-value>\n\t * <source-size-value> = <length>\n\t * http://www.w3.org/html/wg/drafts/html/master/embedded-content.html#attr-img-sizes\n\t *\n\t * E.g. \"(max-width: 30em) 100vw, (max-width: 50em) 70vw, 100vw\"\n\t * or \"(min-width: 30em), calc(30vw - 15px)\" or just \"30vw\"\n\t *\n\t * Returns the first valid <css-length> with a media condition that evaluates to true,\n\t * or \"100vw\" if all valid media conditions evaluate to false.\n\t *\n\t */\n\n\tfunction parseSizes(strValue) {\n\n\t\t// (Percentage CSS lengths are not allowed in this case, to avoid confusion:\n\t\t// https://html.spec.whatwg.org/multipage/embedded-content.html#valid-source-size-list\n\t\t// CSS allows a single optional plus or minus sign:\n\t\t// http://www.w3.org/TR/CSS2/syndata.html#numbers\n\t\t// CSS is ASCII case-insensitive:\n\t\t// http://www.w3.org/TR/CSS2/syndata.html#characters )\n\t\t// Spec allows exponential notation for <number> type:\n\t\t// http://dev.w3.org/csswg/css-values/#numbers\n\t\tvar regexCssLengthWithUnits = /^(?:[+-]?[0-9]+|[0-9]*\\.[0-9]+)(?:[eE][+-]?[0-9]+)?(?:ch|cm|em|ex|in|mm|pc|pt|px|rem|vh|vmin|vmax|vw)$/i;\n\n\t\t// (This is a quick and lenient test. Because of optional unlimited-depth internal\n\t\t// grouping parens and strict spacing rules, this could get very complicated.)\n\t\tvar regexCssCalc = /^calc\\((?:[0-9a-z \\.\\+\\-\\*\\/\\(\\)]+)\\)$/i;\n\n\t\tvar i;\n\t\tvar unparsedSizesList;\n\t\tvar unparsedSizesListLength;\n\t\tvar unparsedSize;\n\t\tvar lastComponentValue;\n\t\tvar size;\n\n\t\t// UTILITY FUNCTIONS\n\n\t\t//  (Toy CSS parser. The goals here are:\n\t\t//  1) expansive test coverage without the weight of a full CSS parser.\n\t\t//  2) Avoiding regex wherever convenient.\n\t\t//  Quick tests: http://jsfiddle.net/gtntL4gr/3/\n\t\t//  Returns an array of arrays.)\n\t\tfunction parseComponentValues(str) {\n\t\t\tvar chrctr;\n\t\t\tvar component = \"\";\n\t\t\tvar componentArray = [];\n\t\t\tvar listArray = [];\n\t\t\tvar parenDepth = 0;\n\t\t\tvar pos = 0;\n\t\t\tvar inComment = false;\n\n\t\t\tfunction pushComponent() {\n\t\t\t\tif (component) {\n\t\t\t\t\tcomponentArray.push(component);\n\t\t\t\t\tcomponent = \"\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction pushComponentArray() {\n\t\t\t\tif (componentArray[0]) {\n\t\t\t\t\tlistArray.push(componentArray);\n\t\t\t\t\tcomponentArray = [];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// (Loop forwards from the beginning of the string.)\n\t\t\twhile (true) {\n\t\t\t\tchrctr = str[pos];\n\n\t\t\t\tif (chrctr === undefined) { // ( End of string reached.)\n\t\t\t\t\tpushComponent();\n\t\t\t\t\tpushComponentArray();\n\t\t\t\t\treturn listArray;\n\t\t\t\t} else if (inComment) {\n\t\t\t\t\tif ((chrctr === \"*\") && (str[pos + 1] === \"/\")) { // (At end of a comment.)\n\t\t\t\t\t\tinComment = false;\n\t\t\t\t\t\tpos += 2;\n\t\t\t\t\t\tpushComponent();\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpos += 1; // (Skip all characters inside comments.)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t} else if (isSpace(chrctr)) {\n\t\t\t\t\t// (If previous character in loop was also a space, or if\n\t\t\t\t\t// at the beginning of the string, do not add space char to\n\t\t\t\t\t// component.)\n\t\t\t\t\tif ((str[pos - 1] && isSpace(str[pos - 1])) || (!component)) {\n\t\t\t\t\t\tpos += 1;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else if (parenDepth === 0) {\n\t\t\t\t\t\tpushComponent();\n\t\t\t\t\t\tpos +=1;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// (Replace any space character with a plain space for legibility.)\n\t\t\t\t\t\tchrctr = \" \";\n\t\t\t\t\t}\n\t\t\t\t} else if (chrctr === \"(\") {\n\t\t\t\t\tparenDepth += 1;\n\t\t\t\t} else if (chrctr === \")\") {\n\t\t\t\t\tparenDepth -= 1;\n\t\t\t\t} else if (chrctr === \",\") {\n\t\t\t\t\tpushComponent()\n\t\t\t\t\tpushComponentArray();\n\t\t\t\t\tpos += 1;\n\t\t\t\t\tcontinue;\n\t\t\t\t} else if ((chrctr === \"/\") && (str[pos + 1] === \"*\")) {\n\t\t\t\t\tinComment = true;\n\t\t\t\t\tpos += 2;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tcomponent = component + chrctr;\n\t\t\t\tpos += 1;\n\t\t\t}\n\t\t}\n\n\t\tfunction isValidNonNegativeSourceSizeValue(s) {\n\t\t\tif (regexCssLengthWithUnits.test(s) && (parseFloat(s) >= 0)) {return true;}\n\t\t\tif (regexCssCalc.test(s)) {return true;}\n\t\t\t// ( http://www.w3.org/TR/CSS2/syndata.html#numbers says:\n\t\t\t// \"-0 is equivalent to 0 and is not a negative number.\" which means that\n\t\t\t// unitless zero and unitless negative zero must be accepted as special cases.)\n\t\t\tif ((s === \"0\") || (s === \"-0\") || (s === \"+0\")) {return true;}\n\t\t\treturn false;\n\t\t}\n\n\t\t// When asked to parse a sizes attribute from an element, parse a\n\t\t// comma-separated list of component values from the value of the element's\n\t\t// sizes attribute (or the empty string, if the attribute is absent), and let\n\t\t// unparsed sizes list be the result.\n\t\t// http://dev.w3.org/csswg/css-syntax/#parse-comma-separated-list-of-component-values\n\n\t\tunparsedSizesList = parseComponentValues(strValue);\n\t\tunparsedSizesListLength = unparsedSizesList.length;\n\n\t\t// For each unparsed size in unparsed sizes list:\n\t\tfor (i = 0; i < unparsedSizesListLength; i++) {\n\t\t\tunparsedSize = unparsedSizesList[i];\n\n\t\t\t// 1. Remove all consecutive <whitespace-token>s from the end of unparsed size.\n\t\t\t// ( parseComponentValues() already omits spaces outside of parens. )\n\n\t\t\t// If unparsed size is now empty, that is a parse error; continue to the next\n\t\t\t// iteration of this algorithm.\n\t\t\t// ( parseComponentValues() won't push an empty array. )\n\n\t\t\t// 2. If the last component value in unparsed size is a valid non-negative\n\t\t\t// <source-size-value>, let size be its value and remove the component value\n\t\t\t// from unparsed size. Any CSS function other than the calc() function is\n\t\t\t// invalid. Otherwise, there is a parse error; continue to the next iteration\n\t\t\t// of this algorithm.\n\t\t\t// http://dev.w3.org/csswg/css-syntax/#parse-component-value\n\t\t\tlastComponentValue = unparsedSize[unparsedSize.length - 1];\n\n\t\t\tif (isValidNonNegativeSourceSizeValue(lastComponentValue)) {\n\t\t\t\tsize = lastComponentValue;\n\t\t\t\tunparsedSize.pop();\n\t\t\t} else {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// 3. Remove all consecutive <whitespace-token>s from the end of unparsed\n\t\t\t// size. If unparsed size is now empty, return size and exit this algorithm.\n\t\t\t// If this was not the last item in unparsed sizes list, that is a parse error.\n\t\t\tif (unparsedSize.length === 0) {\n\t\t\t\treturn size;\n\t\t\t}\n\n\t\t\t// 4. Parse the remaining component values in unparsed size as a\n\t\t\t// <media-condition>. If it does not parse correctly, or it does parse\n\t\t\t// correctly but the <media-condition> evaluates to false, continue to the\n\t\t\t// next iteration of this algorithm.\n\t\t\t// (Parsing all possible compound media conditions in JS is heavy, complicated,\n\t\t\t// and the payoff is unclear. Is there ever an situation where the\n\t\t\t// media condition parses incorrectly but still somehow evaluates to true?\n\t\t\t// Can we just rely on the browser/polyfill to do it?)\n\t\t\tunparsedSize = unparsedSize.join(\" \");\n\t\t\tif (!(pf.matchesMedia( unparsedSize ) ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// 5. Return size and exit this algorithm.\n\t\t\treturn size;\n\t\t}\n\n\t\t// If the above algorithm exhausts unparsed sizes list without returning a\n\t\t// size value, return 100vw.\n\t\treturn \"100vw\";\n\t}\n\t// jscs: enable\n\t/* jshint ignore:end */\n\n\t// namespace\n\tpf.ns = (\"pf\" + new Date().getTime()).substr(0, 9);\n\n\t// srcset support test\n\tpf.supSrcset = \"srcset\" in image;\n\tpf.supSizes = \"sizes\" in image;\n\n\t// using pf.qsa instead of dom traversing does scale much better,\n\t// especially on sites mixing responsive and non-responsive images\n\tpf.selShort = \"picture>img,img[srcset]\";\n\tpf.sel = pf.selShort;\n\tpf.cfg = cfg;\n\n\tif ( pf.supSrcset ) {\n\t\tpf.sel += \",img[\" + srcsetAttr + \"]\";\n\t}\n\n\t/**\n\t * Shortcut property for `devicePixelRatio` ( for easy overriding in tests )\n\t */\n\tpf.DPR = (DPR  || 1 );\n\tpf.u = units;\n\n\t// container of supported mime types that one might need to qualify before using\n\tpf.types =  types;\n\n\talwaysCheckWDescriptor = pf.supSrcset && !pf.supSizes;\n\n\tpf.setSize = noop;\n\n\t/**\n\t * Gets a string and returns the absolute URL\n\t * @param src\n\t * @returns {String} absolute URL\n\t */\n\n\tpf.makeUrl = memoize(function(src) {\n\t\tanchor.href = src;\n\t\treturn anchor.href;\n\t});\n\n\t/**\n\t * Gets a DOM element or document and a selctor and returns the found matches\n\t * Can be extended with jQuery/Sizzle for IE7 support\n\t * @param context\n\t * @param sel\n\t * @returns {NodeList}\n\t */\n\tpf.qsa = function(context, sel) {\n\t\treturn context.querySelectorAll(sel);\n\t};\n\n\t/**\n\t * Shortcut method for matchMedia ( for easy overriding in tests )\n\t * wether native or pf.mMQ is used will be decided lazy on first call\n\t * @returns {boolean}\n\t */\n\tpf.matchesMedia = function() {\n\t\tif ( window.matchMedia && (matchMedia( \"(min-width: 0.1em)\" ) || {}).matches ) {\n\t\t\tpf.matchesMedia = function( media ) {\n\t\t\t\treturn !media || ( matchMedia( media ).matches );\n\t\t\t};\n\t\t} else {\n\t\t\tpf.matchesMedia = pf.mMQ;\n\t\t}\n\n\t\treturn pf.matchesMedia.apply( this, arguments );\n\t};\n\n\t/**\n\t * A simplified matchMedia implementation for IE8 and IE9\n\t * handles only min-width/max-width with px or em values\n\t * @param media\n\t * @returns {boolean}\n\t */\n\tpf.mMQ = function( media ) {\n\t\treturn media ? evalCSS(media) : true;\n\t};\n\n\t/**\n\t * Returns the calculated length in css pixel from the given sourceSizeValue\n\t * http://dev.w3.org/csswg/css-values-3/#length-value\n\t * intended Spec mismatches:\n\t * * Does not check for invalid use of CSS functions\n\t * * Does handle a computed length of 0 the same as a negative and therefore invalid value\n\t * @param sourceSizeValue\n\t * @returns {Number}\n\t */\n\tpf.calcLength = function( sourceSizeValue ) {\n\n\t\tvar value = evalCSS(sourceSizeValue, true) || false;\n\t\tif (value < 0) {\n\t\t\tvalue = false;\n\t\t}\n\n\t\treturn value;\n\t};\n\n\t/**\n\t * Takes a type string and checks if its supported\n\t */\n\n\tpf.supportsType = function( type ) {\n\t\treturn ( type ) ? types[ type ] : true;\n\t};\n\n\t/**\n\t * Parses a sourceSize into mediaCondition (media) and sourceSizeValue (length)\n\t * @param sourceSizeStr\n\t * @returns {*}\n\t */\n\tpf.parseSize = memoize(function( sourceSizeStr ) {\n\t\tvar match = ( sourceSizeStr || \"\" ).match(regSize);\n\t\treturn {\n\t\t\tmedia: match && match[1],\n\t\t\tlength: match && match[2]\n\t\t};\n\t});\n\n\tpf.parseSet = function( set ) {\n\t\tif ( !set.cands ) {\n\t\t\tset.cands = parseSrcset(set.srcset, set);\n\t\t}\n\t\treturn set.cands;\n\t};\n\n\t/**\n\t * returns 1em in css px for html/body default size\n\t * function taken from respondjs\n\t * @returns {*|number}\n\t */\n\tpf.getEmValue = function() {\n\t\tvar body;\n\t\tif ( !eminpx && (body = document.body) ) {\n\t\t\tvar div = document.createElement( \"div\" ),\n\t\t\t\toriginalHTMLCSS = docElem.style.cssText,\n\t\t\t\toriginalBodyCSS = body.style.cssText;\n\n\t\t\tdiv.style.cssText = baseStyle;\n\n\t\t\t// 1em in a media query is the value of the default font size of the browser\n\t\t\t// reset docElem and body to ensure the correct value is returned\n\t\t\tdocElem.style.cssText = fsCss;\n\t\t\tbody.style.cssText = fsCss;\n\n\t\t\tbody.appendChild( div );\n\t\t\teminpx = div.offsetWidth;\n\t\t\tbody.removeChild( div );\n\n\t\t\t//also update eminpx before returning\n\t\t\teminpx = parseFloat( eminpx, 10 );\n\n\t\t\t// restore the original values\n\t\t\tdocElem.style.cssText = originalHTMLCSS;\n\t\t\tbody.style.cssText = originalBodyCSS;\n\n\t\t}\n\t\treturn eminpx || 16;\n\t};\n\n\t/**\n\t * Takes a string of sizes and returns the width in pixels as a number\n\t */\n\tpf.calcListLength = function( sourceSizeListStr ) {\n\t\t// Split up source size list, ie ( max-width: 30em ) 100%, ( max-width: 50em ) 50%, 33%\n\t\t//\n\t\t//                           or (min-width:30em) calc(30% - 15px)\n\t\tif ( !(sourceSizeListStr in sizeLengthCache) || cfg.uT ) {\n\t\t\tvar winningLength = pf.calcLength( parseSizes( sourceSizeListStr ) );\n\n\t\t\tsizeLengthCache[ sourceSizeListStr ] = !winningLength ? units.width : winningLength;\n\t\t}\n\n\t\treturn sizeLengthCache[ sourceSizeListStr ];\n\t};\n\n\t/**\n\t * Takes a candidate object with a srcset property in the form of url/\n\t * ex. \"images/pic-medium.png 1x, images/pic-medium-2x.png 2x\" or\n\t *     \"images/pic-medium.png 400w, images/pic-medium-2x.png 800w\" or\n\t *     \"images/pic-small.png\"\n\t * Get an array of image candidates in the form of\n\t *      {url: \"/foo/bar.png\", resolution: 1}\n\t * where resolution is http://dev.w3.org/csswg/css-values-3/#resolution-value\n\t * If sizes is specified, res is calculated\n\t */\n\tpf.setRes = function( set ) {\n\t\tvar candidates;\n\t\tif ( set ) {\n\n\t\t\tcandidates = pf.parseSet( set );\n\n\t\t\tfor ( var i = 0, len = candidates.length; i < len; i++ ) {\n\t\t\t\tsetResolution( candidates[ i ], set.sizes );\n\t\t\t}\n\t\t}\n\t\treturn candidates;\n\t};\n\n\tpf.setRes.res = setResolution;\n\n\tpf.applySetCandidate = function( candidates, img ) {\n\t\tif ( !candidates.length ) {return;}\n\t\tvar candidate,\n\t\t\ti,\n\t\t\tj,\n\t\t\tlength,\n\t\t\tbestCandidate,\n\t\t\tcurSrc,\n\t\t\tcurCan,\n\t\t\tisSameSet,\n\t\t\tcandidateSrc,\n\t\t\tabortCurSrc;\n\n\t\tvar imageData = img[ pf.ns ];\n\t\tvar dpr = pf.DPR;\n\n\t\tcurSrc = imageData.curSrc || img[curSrcProp];\n\n\t\tcurCan = imageData.curCan || setSrcToCur(img, curSrc, candidates[0].set);\n\n\t\t// if we have a current source, we might either become lazy or give this source some advantage\n\t\tif ( curCan && curCan.set === candidates[ 0 ].set ) {\n\n\t\t\t// if browser can abort image request and the image has a higher pixel density than needed\n\t\t\t// and this image isn't downloaded yet, we skip next part and try to save bandwidth\n\t\t\tabortCurSrc = (supportAbort && !img.complete && curCan.res - 0.1 > dpr);\n\n\t\t\tif ( !abortCurSrc ) {\n\t\t\t\tcurCan.cached = true;\n\n\t\t\t\t// if current candidate is \"best\", \"better\" or \"okay\",\n\t\t\t\t// set it to bestCandidate\n\t\t\t\tif ( curCan && isSameSet && curCan.res >= dpr ) {\n\t\t\t\t\tbestCandidate = curCan;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( !bestCandidate ) {\n\n\t\t\tcandidates.sort( ascendingSort );\n\n\t\t\tlength = candidates.length;\n\t\t\tbestCandidate = candidates[ length - 1 ];\n\n\t\t\tfor ( i = 0; i < length; i++ ) {\n\t\t\t\tcandidate = candidates[ i ];\n\t\t\t\tif ( candidate.res >= dpr ) {\n\t\t\t\t\tj = i - 1;\n\n\t\t\t\t\t// we have found the perfect candidate,\n\t\t\t\t\t// but let's improve this a little bit with some assumptions ;-)\n\t\t\t\t\tif (candidates[ j ] &&\n\t\t\t\t\t\t(abortCurSrc || curSrc !== pf.makeUrl( candidate.url )) &&\n\t\t\t\t\t\tchooseLowRes(candidates[ j ].res, candidate.res, dpr, candidates[ j ].cached)) {\n\n\t\t\t\t\t\tbestCandidate = candidates[ j ];\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbestCandidate = candidate;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( bestCandidate ) {\n\n\t\t\tcandidateSrc = pf.makeUrl( bestCandidate.url );\n\n\t\t\timageData.curSrc = candidateSrc;\n\t\t\timageData.curCan = bestCandidate;\n\n\t\t\tif ( candidateSrc !== curSrc ) {\n\t\t\t\tpf.setSrc( img, bestCandidate );\n\t\t\t}\n\t\t\tpf.setSize( img );\n\t\t}\n\t};\n\n\tpf.setSrc = function( img, bestCandidate ) {\n\t\tvar origWidth;\n\t\timg.src = bestCandidate.url;\n\n\t\t// although this is a specific Safari issue, we don't want to take too much different code paths\n\t\tif ( bestCandidate.set.type === \"image/svg+xml\" ) {\n\t\t\torigWidth = img.style.width;\n\t\t\timg.style.width = (img.offsetWidth + 1) + \"px\";\n\n\t\t\t// next line only should trigger a repaint\n\t\t\t// if... is only done to trick dead code removal\n\t\t\tif ( img.offsetWidth + 1 ) {\n\t\t\t\timg.style.width = origWidth;\n\t\t\t}\n\t\t}\n\t};\n\n\tpf.getSet = function( img ) {\n\t\tvar i, set, supportsType;\n\t\tvar match = false;\n\t\tvar sets = img [ pf.ns ].sets;\n\n\t\tfor ( i = 0; i < sets.length && !match; i++ ) {\n\t\t\tset = sets[i];\n\n\t\t\tif ( !set.srcset || !pf.matchesMedia( set.media ) || !(supportsType = pf.supportsType( set.type )) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif ( supportsType === \"pending\" ) {\n\t\t\t\tset = supportsType;\n\t\t\t}\n\n\t\t\tmatch = set;\n\t\t\tbreak;\n\t\t}\n\n\t\treturn match;\n\t};\n\n\tpf.parseSets = function( element, parent, options ) {\n\t\tvar srcsetAttribute, imageSet, isWDescripor, srcsetParsed;\n\n\t\tvar hasPicture = parent && parent.nodeName.toUpperCase() === \"PICTURE\";\n\t\tvar imageData = element[ pf.ns ];\n\n\t\tif ( imageData.src === undefined || options.src ) {\n\t\t\timageData.src = getImgAttr.call( element, \"src\" );\n\t\t\tif ( imageData.src ) {\n\t\t\t\tsetImgAttr.call( element, srcAttr, imageData.src );\n\t\t\t} else {\n\t\t\t\tremoveImgAttr.call( element, srcAttr );\n\t\t\t}\n\t\t}\n\n\t\tif ( imageData.srcset === undefined || options.srcset || !pf.supSrcset || element.srcset ) {\n\t\t\tsrcsetAttribute = getImgAttr.call( element, \"srcset\" );\n\t\t\timageData.srcset = srcsetAttribute;\n\t\t\tsrcsetParsed = true;\n\t\t}\n\n\t\timageData.sets = [];\n\n\t\tif ( hasPicture ) {\n\t\t\timageData.pic = true;\n\t\t\tgetAllSourceElements( parent, imageData.sets );\n\t\t}\n\n\t\tif ( imageData.srcset ) {\n\t\t\timageSet = {\n\t\t\t\tsrcset: imageData.srcset,\n\t\t\t\tsizes: getImgAttr.call( element, \"sizes\" )\n\t\t\t};\n\n\t\t\timageData.sets.push( imageSet );\n\n\t\t\tisWDescripor = (alwaysCheckWDescriptor || imageData.src) && regWDesc.test(imageData.srcset || \"\");\n\n\t\t\t// add normal src as candidate, if source has no w descriptor\n\t\t\tif ( !isWDescripor && imageData.src && !getCandidateForSrc(imageData.src, imageSet) && !imageSet.has1x ) {\n\t\t\t\timageSet.srcset += \", \" + imageData.src;\n\t\t\t\timageSet.cands.push({\n\t\t\t\t\turl: imageData.src,\n\t\t\t\t\td: 1,\n\t\t\t\t\tset: imageSet\n\t\t\t\t});\n\t\t\t}\n\n\t\t} else if ( imageData.src ) {\n\t\t\timageData.sets.push( {\n\t\t\t\tsrcset: imageData.src,\n\t\t\t\tsizes: null\n\t\t\t} );\n\t\t}\n\n\t\timageData.curCan = null;\n\t\timageData.curSrc = undefined;\n\n\t\t// if img has picture or the srcset was removed or has a srcset and does not support srcset at all\n\t\t// or has a w descriptor (and does not support sizes) set support to false to evaluate\n\t\timageData.supported = !( hasPicture || ( imageSet && !pf.supSrcset ) || isWDescripor );\n\n\t\tif ( srcsetParsed && pf.supSrcset && !imageData.supported ) {\n\t\t\tif ( srcsetAttribute ) {\n\t\t\t\tsetImgAttr.call( element, srcsetAttr, srcsetAttribute );\n\t\t\t\telement.srcset = \"\";\n\t\t\t} else {\n\t\t\t\tremoveImgAttr.call( element, srcsetAttr );\n\t\t\t}\n\t\t}\n\n\t\tif (imageData.supported && !imageData.srcset && ((!imageData.src && element.src) ||  element.src !== pf.makeUrl(imageData.src))) {\n\t\t\tif (imageData.src === null) {\n\t\t\t\telement.removeAttribute(\"src\");\n\t\t\t} else {\n\t\t\t\telement.src = imageData.src;\n\t\t\t}\n\t\t}\n\n\t\timageData.parsed = true;\n\t};\n\n\tpf.fillImg = function(element, options) {\n\t\tvar imageData;\n\t\tvar extreme = options.reselect || options.reevaluate;\n\n\t\t// expando for caching data on the img\n\t\tif ( !element[ pf.ns ] ) {\n\t\t\telement[ pf.ns ] = {};\n\t\t}\n\n\t\timageData = element[ pf.ns ];\n\n\t\t// if the element has already been evaluated, skip it\n\t\t// unless `options.reevaluate` is set to true ( this, for example,\n\t\t// is set to true when running `picturefill` on `resize` ).\n\t\tif ( !extreme && imageData.evaled === evalId ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !imageData.parsed || options.reevaluate ) {\n\t\t\tpf.parseSets( element, element.parentNode, options );\n\t\t}\n\n\t\tif ( !imageData.supported ) {\n\t\t\tapplyBestCandidate( element );\n\t\t} else {\n\t\t\timageData.evaled = evalId;\n\t\t}\n\t};\n\n\tpf.setupRun = function() {\n\t\tif ( !alreadyRun || isVwDirty || (DPR !== window.devicePixelRatio) ) {\n\t\t\tupdateMetrics();\n\t\t}\n\t};\n\n\t// If picture is supported, well, that's awesome.\n\tif ( window.HTMLPictureElement ) {\n\t\tpicturefill = noop;\n\t\tpf.fillImg = noop;\n\t} else {\n\n\t\t // Set up picture polyfill by polling the document\n\t\t(function() {\n\t\t\tvar isDomReady;\n\t\t\tvar regReady = window.attachEvent ? /d$|^c/ : /d$|^c|^i/;\n\n\t\t\tvar run = function() {\n\t\t\t\tvar readyState = document.readyState || \"\";\n\n\t\t\t\ttimerId = setTimeout(run, readyState === \"loading\" ? 200 :  999);\n\t\t\t\tif ( document.body ) {\n\t\t\t\t\tpf.fillImgs();\n\t\t\t\t\tisDomReady = isDomReady || regReady.test(readyState);\n\t\t\t\t\tif ( isDomReady ) {\n\t\t\t\t\t\tclearTimeout( timerId );\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar timerId = setTimeout(run, document.body ? 9 : 99);\n\n\t\t\t// Also attach picturefill on resize and readystatechange\n\t\t\t// http://modernjavascript.blogspot.com/2013/08/building-better-debounce.html\n\t\t\tvar debounce = function(func, wait) {\n\t\t\t\tvar timeout, timestamp;\n\t\t\t\tvar later = function() {\n\t\t\t\t\tvar last = (new Date()) - timestamp;\n\n\t\t\t\t\tif (last < wait) {\n\t\t\t\t\t\ttimeout = setTimeout(later, wait - last);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttimeout = null;\n\t\t\t\t\t\tfunc();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\treturn function() {\n\t\t\t\t\ttimestamp = new Date();\n\n\t\t\t\t\tif (!timeout) {\n\t\t\t\t\t\ttimeout = setTimeout(later, wait);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t\tvar lastClientWidth = docElem.clientHeight;\n\t\t\tvar onResize = function() {\n\t\t\t\tisVwDirty = Math.max(window.innerWidth || 0, docElem.clientWidth) !== units.width || docElem.clientHeight !== lastClientWidth;\n\t\t\t\tlastClientWidth = docElem.clientHeight;\n\t\t\t\tif ( isVwDirty ) {\n\t\t\t\t\tpf.fillImgs();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\ton( window, \"resize\", debounce(onResize, 99 ) );\n\t\t\ton( document, \"readystatechange\", run );\n\n\t\t\ttypes[ \"image/webp\" ] = detectTypeSupport(\"image/webp\", \"data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA==\" );\n\t\t})();\n\t}\n\n\tpf.picturefill = picturefill;\n\t//use this internally for easy monkey patching/performance testing\n\tpf.fillImgs = picturefill;\n\tpf.teardownRun = noop;\n\n\t/* expose methods for testing */\n\tpicturefill._ = pf;\n\n\twindow.picturefillCFG = {\n\t\tpf: pf,\n\t\tpush: function(args) {\n\t\t\tvar name = args.shift();\n\t\t\tif (typeof pf[name] === \"function\") {\n\t\t\t\tpf[name].apply(pf, args);\n\t\t\t} else {\n\t\t\t\tcfg[name] = args[0];\n\t\t\t\tif (alreadyRun) {\n\t\t\t\t\tpf.fillImgs( { reselect: true } );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\twhile (setOptions && setOptions.length) {\n\t\twindow.picturefillCFG.push(setOptions.shift());\n\t}\n\n\t/* expose picturefill */\n\twindow.picturefill = picturefill;\n\n\t/* expose picturefill */\n\tif ( typeof module === \"object\" && typeof module.exports === \"object\" ) {\n\t\t// CommonJS, just export\n\t\tmodule.exports = picturefill;\n\t} else if ( typeof define === \"function\" && define.amd ) {\n\t\t// AMD support\n\t\tdefine( \"picturefill\", function() { return picturefill; } );\n\t}\n\n} )( window, document );\n","////////////////////////////////////////////////////////////////////////////////\r\n// Nation Library\r\n// Barebones animation for when a full library is not already in the project\r\n// Uses CSS3 animation where available\r\n// Animates values in pixels, percentages, colours, and unitless values (eg. opacity)\r\n////////////////////////////////////////////////////////////////////////////////\r\nvar NATION = NATION || {};\r\n\r\n/**\r\n * ### Dependencies:\r\n * [NATION.Utils](Utils.js.html)\r\n *\r\n * ### About:\r\n * Creates animations on elements. This class does not need instantiating.\r\n * \r\n * Animates values in pixels, percentages, colours, and unitless values (eg. opacity). Now also animates CSS transforms. See below for details\r\n * \r\n * CSS3 animation is prioritised, but if the browser lacks support for them, JavaScript animation is used instead.\r\n * \r\n * If the passed DOM element does not have a starting value for a property (eg. width is not set), you're going to have a bad time.\r\n * \r\n * ### Auto-prefixing\r\n * You can now specify a CSS property, and it will be automatically prefixed for you. This will also work in reverse, meaning you can pass in '-webkit-transition' and this will still work in Firefox etc.\r\n * \r\n * ### Animating CSS Transforms:\r\n * This class can animate complex CSS transforms, but there is a restriction to it's use. If you want to animate a transform from a starting position other than 'no transform' or a matrix, you must set the style in your JavaScript before animating. Due to the nature of CSS, JavaScript cannot dynamically get the original transform setting from your CSS file (it is only ever recognised as a matrix in the browser, rather than separate values for rotate, translate etc). So in these cases, before starting an animation, always set the style first, eg. NATION.Utils.setStyle(element, {transform: \"rotate(90deg)\"}) or $(element).css({transform: \"rotate(90deg)\"}), or element.style.transform = \"rotate(90deg)\";\r\n *\r\n * With that in mind, you can now use this class to animate transforms, such as the following:\r\n * <ul>\r\n * <li>transform: \"translateY(50px)\"</li>\r\n * <li>transform: \"rotate(99deg) translateY(50px)\"</li>\r\n * <li>transform: \"translate3d(50px, 400%, 200px) rotate(90deg)\"</li>\r\n * <li>transform: \"rotate(90deg) matrix(1, -0.2, 0, 1, 0, 0)\"</li>\r\n * </ul>\r\n * @class Animation\r\n * @requires NATION.Utils\r\n */\r\nNATION.Animation = (function() {\r\n\t\"use strict\";\r\n\t\r\n\tvar _public = {};\r\n\r\n\t/**\r\n\t* Start a new animation on an element.\r\n\t* \r\n\t* Note that this will automatically stop all current animation on the passed element, you don't need to call stop() beforehand.\r\n\t* \r\n\t* **Example:**\r\n\t*\r\n\t\t// Element that will be animated\r\n\t\tvar myElement = document.querySelector(\".my-element\");\r\n\t\t// Set up a function to call on completion\r\n\t\tvar myCallback = function(e) {\r\n\t\t\t// e.target contains the DOM element that was animated\r\n\t\t}\r\n\t\t// Properties that will be animated\r\n\t\tvar properties = {\r\n\t \t\tleft: 100,\r\n\t \t\twidth: \"50%\"\r\n\t \t}\r\n\r\n\t \tvar options = {\r\n\t \t\tduration: 400,\r\n\t \t\teasing: \"easeInOutQuad\"\r\n\t \t};\r\n\t \t// Start the animation\r\n\t \tNATION.Animation.start(myElement, properties, options, myCallback);\r\n\t* \r\n\t* @function Animation.start\r\n\t* @param {domelement} element The DOM element to start performing an animation on\r\n\t* @param {object} properties The style properties to animate, and their target values\r\n\t* @param {object} options Customisable settings for this animation\r\n\t* @param {int} options.duration (default:1000) The length of the animation, in milliseconds\r\n\t* @param {string} options.easing (default:\"linear\") The easing method to use.\r\n\t* @param {boolean} options.forcejs (default: false) Force the animation to be performed by JS, instead of CSS3\r\n\t* @param {function} callback Callback function to run after the animation has completed\r\n\t*/\r\n\t_public.start = function(element, properties, options, callback) {\r\n\t\toptions = options || {};\r\n\t\telement = NATION.Utils.getDOMElement(element);\r\n\t\t_private.startAnimation(element, properties, options, callback);\r\n\t};\r\n\r\n\t/**\r\n\t\t* Stops all animations currently active on the passed element\r\n\t\t* \r\n\t\t* **Example:**\r\n\t\t*\r\n\t\t\t// Element that will be animated\r\n\t\t\tvar myElement = document.querySelector(\".my-element\");\r\n\t\t\t// Stop all animation on selected element\r\n\t\t\tNATION.Animation.stop(myElement);\r\n\t\t*\r\n\t\t* @function Animation.stop\r\n\t\t* @param {domelement} element - The DOM element on which to stop all animations\r\n\t*/\r\n\t_public.stop = function(element) {\r\n\t\t_private.stopAnimation(element);\r\n\t};\r\n\r\n\t/** Find a colour at a point between two colours\r\n\t*/\r\n\t_public.tweenColour = function(percentage, startColour, endColour) {\r\n\t\treturn _private.tweenColour(percentage, startColour, endColour);\r\n\t};\r\n\r\n\t/**\r\n\t* Private methods\r\n\t* @ignore\r\n\t*/\r\n\tvar _private = {\r\n\t\t//------------------------------------------------\r\n\t\t// Variables\r\n\t\t//------------------------------------------------\r\n\t\tactiveAnimations: [],\r\n\t\tanimationTimer: null,\r\n\t\tCSS3Available: false,\r\n\t\ttestingElement: null,\r\n\t\ttransitionEndString: \"\",\r\n\t\tcssPrefix: \"\",\r\n\t\ttypes: {\r\n\t\t\tPIXELS: \"pixels\",\r\n\t\t\tPERCENT: \"percent\",\r\n\t\t\tCOLOUR: \"colour\",\r\n\t\t\tTRANSFORM: \"transform\",\r\n\t\t\tNONE: \"none\"\r\n\t\t},\r\n\t\teasing: {\r\n\t\t\tlinear: function(percent, elapsed, start, end, duration) {\r\n\t\t\t\treturn start + (end - start) * percent;\r\n\t\t\t},\r\n\t\t\teaseInSine: function (percent, elapsed, start, end, duration) {\r\n\t\t\t\treturn -(end-start) * Math.cos(elapsed/duration * (Math.PI/2)) + (end-start) + start;\r\n\t\t\t},\r\n\t\t\teaseOutSine: function (percent, elapsed, start, end, duration) {\r\n\t\t\t\treturn (end-start) * Math.sin(elapsed/duration * (Math.PI/2)) + start;\r\n\t\t\t},\r\n\t\t\teaseInOutSine: function (percent, elapsed, start, end, duration) {\r\n\t\t\t\treturn -(end-start)/2 * (Math.cos(Math.PI*elapsed/duration) - 1) + start;\r\n\t\t\t},\r\n\t\t\teaseInQuad: function (percent, elapsed, start, end, duration) {\r\n\t\t\t\treturn (end-start)*(elapsed/=duration)*elapsed + start;\r\n\t\t\t},\r\n\t\t\teaseOutQuad: function (percent, elapsed, start, end, duration) {\r\n\t\t\t\treturn -(end-start) *(elapsed/=duration)*(elapsed-2) + start;\r\n\t\t\t},\r\n\t\t\teaseInOutQuad: function(percent, elapsed, start, end, duration) {\r\n\t\t\t\tif ((elapsed/=duration/2) < 1) return (end-start)/2 * elapsed * elapsed + start;\r\n\t\t\t\treturn -(end-start)/2 * ((--elapsed) * (elapsed-2) - 1) + start;\r\n\t\t\t}\r\n\t\t},\r\n\t\tcssEasing: {\r\n\t\t\tlinear: \"linear\",\r\n\t\t\teaseInSine: \"cubic-bezier(0.47, 0, 0.745, 0.715)\",\r\n\t\t\teaseOutSine: \"cubic-bezier(0.39, 0.575, 0.565, 1)\",\r\n\t\t\teaseInOutSine: \"cubic-bezier(0.445, 0.05, 0.55, 0.95)\",\r\n\t\t\teaseInQuad: \"cubic-bezier(0.55, 0.085, 0.68, 0.53)\",\r\n\t\t\teaseOutQuad: \"cubic-bezier(0.25, 0.46, 0.45, 0.94)\",\r\n\t\t\teaseInOutQuad: \"cubic-bezier(0.455, 0.03, 0.515, 0.955)\"\r\n\t\t},\r\n\t\tstartTimers: [],\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Init\r\n\t\t//------------------------------------------------\r\n\t\tinit: function() {\r\n\t\t\tthis.testingElement = document.createElement(\"div\");\r\n\t\t\tthis.checkForCSS3();\r\n\t\t\tthis.getTransitionEndString();\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Check if we can use CSS3 transitions\r\n\t\t//------------------------------------------------\r\n\t\tcheckForCSS3: function() {\r\n\t\t\tthis.CSS3Available = false;\r\n\t\t\tvar availableStyles = this.testingElement.style;\r\n\t\t\tvar prefixes = [\"ms\", \"o\", \"moz\", \"webkit\"], transitionString = \"\";\r\n\t\t\tif (availableStyles[\"transition\"] === \"\") {\r\n\t\t\t\tthis.transitionString = \"transition\";\r\n\t\t\t\tthis.CSS3Available = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\twhile (prefixes.length) {\r\n\t\t\t\ttransitionString = prefixes.pop() + \"Transition\";\r\n\t\t\t\tif (transitionString in availableStyles) {\r\n\t\t\t\t\tthis.transitionString = transitionString;\r\n\t\t\t\t\tthis.CSS3Available = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Can't animate scrollTop or scrollLeft with CSS3\r\n\t\t//------------------------------------------------\r\n\t\tcheckForScrollPosChange: function(properties) {\r\n\t\t\tvar scrollPosFound = false;\r\n\t\t\tvar i = 0, length = properties.length;\r\n\t\t\tfor (var prop in properties) {\r\n\t\t\t\tif (prop === \"scrollLeft\" || prop === \"scrollTop\") {\r\n\t\t\t\t\tscrollPosFound = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn scrollPosFound;\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Create a new animation on an element\r\n\t\t//------------------------------------------------\r\n\t\tstartAnimation: function(element, properties, options, callback) {\r\n\t\t\t// Allows options argument to be missed by user\r\n\t\t\tif (callback && options) {\r\n\t\t\t\toptions.complete = callback;\r\n\t\t\t}\r\n\t\t\tif (typeof options === \"function\") {\r\n\t\t\t\tvar completeMethod = options;\r\n\t\t\t\toptions = {};\r\n\t\t\t\toptions.complete = completeMethod;\r\n\t\t\t}\r\n\t\t\t// Set defaults\r\n\t\t\toptions.easing = options.easing || \"linear\";\r\n\t\t\toptions.duration = options.duration || 1000;\r\n\t\t\tif (this.CSS3Available && !options.forcejs) {\r\n\t\t\t\tif (!this.checkForScrollPosChange(properties)) {\r\n\t\t\t\t\tthis.animateWithCSS3(element, properties, options, callback);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.animateWithJavaScript(element, properties, options, callback);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.animateWithJavaScript(element, properties, options, callback);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Ideally let the browser do the work\r\n\t\t//------------------------------------------------\r\n\t\tanimateWithCSS3: function(element, properties, options) {\r\n\t\t\t// Set start styles on element, if any are currently blank\r\n\t\t\tvar startStyles = (window.getComputedStyle) ? getComputedStyle(element) : element.currentStyle;\r\n\t\t\tvar newStyles = {};\r\n\t\t\tfor (var prop in properties) {\r\n\t\t\t\tif (!startStyles[prop]) {\r\n\t\t\t\t\tif (prop.search(/transform/i) < 0) {\r\n\t\t\t\t\t\tnewStyles[prop] = 0;\r\n\t\t\t\t\t\tif (prop.search(/opacity/i) > -1) {\r\n\t\t\t\t\t\t\tnewStyles[prop] = 1;\r\n\t\t\t\t\t\t} else if (prop.search(/color/i) > -1) {\r\n\t\t\t\t\t\t\tif (prop === \"color\") {\r\n\t\t\t\t\t\t\t\tnewStyles[prop] = \"#000000\";\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tnewStyles[prop] = \"transparent\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tNATION.Utils.setStyle(element, newStyles);\r\n\t\t\t// Apply a transition after a small delay, to allow immediately prior\r\n\t\t\t// css changes to display in a draw cycle first\r\n\t\t\trequestAnimationFrame(function() {\r\n\t\t\t\t_private.startCSSAnim(element, properties, options);\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Start the CSS transition\r\n\t\t//------------------------------------------------\r\n\t\tstartCSSAnim: function(element, properties, options) {\r\n\t\t\tthis.stopAnimation(element);\r\n\t\t\tproperties = this.checkForPrefixes(properties);\r\n\t\t\tvar durationInSeconds = options.duration / 1000 + \"s\",\r\n\t\t\tstyleString = \"\", pixels = false, percentage = false, color = false, value = \"\";\r\n\t\t\tvar organisedProperties = [], startValue;\r\n\t\t\tvar startStyles = (window.getComputedStyle) ? getComputedStyle(element) : element.currentStyle;\r\n\t\t\telement.style[this.transitionString] = \"all \" + durationInSeconds + \" \" + this.cssEasing[options.easing];\r\n\t\t\tvar attributeChanging = false;\r\n\t\t\tfor (var prop in properties) {\r\n\t\t\t\tvalue = properties[prop].toString();\r\n\t\t\t\tvar valueType = this.types.NONE;\r\n\t\t\t\tif (value.search(/px|%|#/gi) < 0 && value !== 0) {\r\n\t\t\t\t\tif (prop.search(/transform/i) < 0 && prop.search(/opacity/i) < 0) {\r\n\t\t\t\t\t\tvalue += \"px\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (value.search(/transform/i) >= 0) {\r\n\t\t\t\t\tvalueType = this.types.TRANSFORM;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (value.search(/px/i) >= 0) valueType = this.types.PIXELS;\r\n\t\t\t\t\tif (value.search(\"%\") >= 0) valueType = this.types.PERCENT;\r\n\t\t\t\t\tif (value.search(/#|rgb/i) >= 0) valueType = this.types.COLOUR;\r\n\t\t\t\t}\r\n\t\t\t\tstartValue = (element.style[prop]) ? element.style[prop] : startStyles[prop];\r\n\t\t\t\tif (startValue === \"0px\") startValue = 0;\r\n\t\t\t\telement.style[prop] = value;\r\n\t\t\t\torganisedProperties.push({\r\n\t\t\t\t\tname: prop,\r\n\t\t\t\t\tstartValue: startValue,\r\n\t\t\t\t\ttargetValue: value,\r\n\t\t\t\t\ttype: valueType\r\n\t\t\t\t});\r\n\t\t\t\tif (startValue !== value) {\r\n\t\t\t\t\tattributeChanging = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.activeAnimations.push({\r\n\t\t\t\telement: element,\r\n\t\t\t\tproperties: organisedProperties,\r\n\t\t\t\toptions: options\r\n\t\t\t});\r\n\t\t\tif (attributeChanging) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\telement.addEventListener(_private.transitionEndString, _private.onTransitionEnd, false);\r\n\t\t\t\t}, 10);\r\n\t\t\t} else {\r\n\t\t\t\t// Fire complete immediately, as nothing changed\r\n\t\t\t\tthis.onTransitionEnd({target: element});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Adds prefixes where needed to all property names\r\n\t\t//------------------------------------------------\r\n\t\tcheckForPrefixes: function(properties) {\r\n\t\t\t// Check properties for any styles that might require prefixes\r\n\t\t\t// Copy the object temporarily\r\n\t\t\tvar props = {}, newPropName, value;\r\n\t\t\tfor (var propName in properties) {\r\n\t\t\t\tnewPropName = propName;\r\n\t\t\t\tvalue = properties[propName];\r\n\t\t\t\tdelete props[propName];\r\n\t\t\t\tnewPropName = NATION.Utils.getPrefixedName(newPropName);\r\n\t\t\t\tprops[newPropName] = value;\r\n\t\t\t}\r\n\t\t\treturn props;\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Returns supported transition end event string\r\n\t\t//------------------------------------------------\r\n\t\tgetTransitionEndString: function() {\r\n\t\t\tvar transitionNames = {\r\n\t\t\t\t'WebkitTransition' : 'webkitTransitionEnd',\r\n                'MozTransition' : 'transitionend',\r\n                'OTransition' : 'oTransitionEnd otransitionend',\r\n                'transition' : 'transitionend'\r\n            };\r\n            this.cssPrefix = \"\";\r\n\t\t\tfor (var i in transitionNames) {\r\n\t\t\t\tif (this.testingElement.style[i] !== undefined) {\r\n\t\t\t\t\tthis.cssPrefix = \"-\" + i.toLowerCase() + \"-\";\r\n\t\t\t\t\tthis.cssPrefix = this.cssPrefix.replace(\"transition\", \"\");\r\n\t\t\t\t\tthis.transitionEndString = transitionNames[i];\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Get percentage from -ms-filter string (0-1 format)\r\n\t\t//------------------------------------------------\r\n\t\tgetPercentageFromFilter: function(filterString) {\r\n\t\t\tvar percentage = filterString.replace(\"progid:DXImageTransform.Microsoft.Alpha(Opacity=\", \"\");\r\n\t\t\tpercentage = percentage.replace(\")\", \"\");\r\n\t\t\treturn parseInt(percentage, 10) / 100;\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Get percentage from filter string (0-1 format)\r\n\t\t//------------------------------------------------\r\n\t\tconvertOpacityToFilterString: function(percentage) {\r\n\t\t\tpercentage = Math.floor(percentage*100);\r\n\t\t\treturn \"progid:DXImageTransform.Microsoft.Alpha(Opacity=\" + percentage + \")\";\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Parse a transform string into an array of values\r\n\t\t//------------------------------------------------\r\n\t\tconvertTransformString: function(transformString) {\r\n\t\t\t// Wipe out spaces around commas, so that we can split array on spaces safely\r\n\t\t\ttransformString = transformString.replace(/, | ,/g, \",\");\r\n\t\t\tvar valueArray = transformString.split(\" \");\r\n\t\t\tvar i = 0, length = valueArray.length, values = {}, attribute, value, startIndex, endIndex;\r\n\t\t\tfor (; i < length; i++) {\r\n\t\t\t\tstartIndex = valueArray[i].indexOf(\"(\") + 1;\r\n\t\t\t\tendIndex = valueArray[i].indexOf(\")\") - startIndex;\r\n\t\t\t\tattribute = valueArray[i].substr(0, startIndex-1);\r\n\t\t\t\tvalue = valueArray[i].substr(startIndex, endIndex);\r\n\t\t\t\tif (value.indexOf(\",\") > -1) {\r\n\t\t\t\t\t// This is a coma separated value, eg. translate(23px, 56px)\r\n\t\t\t\t\tvalue = value.split(\",\");\r\n\t\t\t\t}\r\n\t\t\t\tvalues[attribute] = value;\r\n\t\t\t}\r\n\t\t\treturn values;\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Animate using JavaScript\r\n\t\t//------------------------------------------------\r\n\t\tanimateWithJavaScript: function(element, properties, options) {\r\n\t\t\tthis.stopAnimation(element);\r\n\t\t\tproperties = this.checkForPrefixes(properties);\r\n\t\t\tvar currentTime = Date.now();\r\n\t\t\tvar organisedProperties = [], computedStyle;\r\n\t\t\tfor (var prop in properties) {\r\n\t\t\t\tvar targetValue = properties[prop].toString();\r\n\t\t\t\tvar valueType = this.types.NONE;\r\n\t\t\t\tif (targetValue.search(/px|%|#|rgb/gi) < 0) {\r\n\t\t\t\t\t// Don't add 'px' if this is a transform, or we're just animating opacity\r\n\t\t\t\t\tif (prop.search(\"transform\") < 0 && prop.search(/opacity/i) < 0) {\r\n\t\t\t\t\t\ttargetValue += \"px\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Store the start position\r\n\t\t\t\tvar startValue = \"\";\r\n\t\t\t\tif (prop.search(/transform/i) >= 0) {\r\n\t\t\t\t\tvalueType = this.types.TRANSFORM;\r\n\t\t\t\t\ttargetValue = this.convertTransformString(targetValue);\r\n\t\t\t\t}\r\n\t\t\t\tif (element.style && element.style[prop]) {\r\n\t\t\t\t\tstartValue = element.style[prop];\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Will only work for transforms if the target value is a matrix\r\n\t\t\t\t\tcomputedStyle = (typeof window.getComputedStyle !== \"undefined\") ? window.getComputedStyle(element, null)[prop] : element.currentStyle[prop];\r\n\t\t\t\t\tif (computedStyle && valueType !== this.types.TRANSFORM) {\r\n\t\t\t\t\t\tstartValue = computedStyle;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tstartValue = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (valueType !== this.types.TRANSFORM && (!startValue || startValue === \"none\")) {\r\n\t\t\t\t\t// Nothing in style tag, compute the style if not animating scroll\r\n\t\t\t\t\tif (valueType === this.types.TRANSFORM) {\r\n\t\t\t\t\t\tstartValue = {};\r\n\t\t\t\t\t\tfor (name in targetValue) {\r\n\t\t\t\t\t\t\tthrow new Error(\"NATION.Animation: A transform must be set before one can be animated. Failed to animate element with class names '\" + element.className + \"'\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (prop !== \"scrollLeft\" && prop !== \"scrollTop\") {\r\n\t\t\t\t\t\tstartValue = (window.getComputedStyle) ? getComputedStyle(element)[prop] : element.currentStyle[prop];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Since we're trying to animate scrollTop or scrollLeft, if user wants to animate the whole page\r\n\t\t\t\t\t\t// we need to check whether to animate html or body\r\n\t\t\t\t\t\tif (element === document.documentElement) {\r\n\t\t\t\t\t\t\telement = NATION.Utils.getPageElement();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstartValue = element[prop];\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (valueType === this.types.TRANSFORM) {\r\n\t\t\t\t\tstartValue = this.convertTransformString(startValue);\r\n\t\t\t\t\tvar i = 0, length = targetValue.length;\r\n\t\t\t\t\tfor (var propName in targetValue) {\r\n\t\t\t\t\t\tif (!startValue[propName]) {\r\n\t\t\t\t\t\t\t//if (window.console && console.warn) console.warn(\"NATION.Animation: Existing transform function does not match target function. Setting transform to 0 on the following element: \", element);\r\n\t\t\t\t\t\t\tstartValue[propName] = targetValue[propName];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (valueType !== this.types.TRANSFORM) {\r\n\t\t\t\t\tif (targetValue.search(/px/i) >= 0) {\r\n\t\t\t\t\t\t// IE sometimes adds px to zero values, so check if that's really what we want\r\n\t\t\t\t\t\tif (targetValue === \"0px\") {\r\n\t\t\t\t\t\t\tif (startValue.toString().search(\"%\") >= 0) {\r\n\t\t\t\t\t\t\t\tvalueType = this.types.PERCENT;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvalueType = this.types.PIXELS;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvalueType = this.types.PIXELS;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (targetValue.toString().search(\"%\") >= 0) valueType = this.types.PERCENT;\r\n\t\t\t\t\t\tif (targetValue.toString().search(/#|rgb/i) >= 0) valueType = this.types.COLOUR;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttargetValue = targetValue.toString().replace(/px|%/gi, \"\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (startValue === \"auto\") startValue = 0;\r\n\t\t\t\tif (prop === \"opacity\" && !(\"opacity\" in document.documentElement.style)) {\r\n\t\t\t\t\tprop = \"filter\";\r\n\t\t\t\t\tstartValue = element.currentStyle.filter\r\n\t\t\t\t\tstartValue = startValue || \"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)\";\r\n\t\t\t\t\tstartValue = this.getPercentageFromFilter(startValue);\r\n\t\t\t\t\ttargetValue = parseInt(targetValue, 10);\r\n\t\t\t\t}\r\n\t\t\t\torganisedProperties.push({\r\n\t\t\t\t\tname: prop,\r\n\t\t\t\t\tstartValue: startValue,\r\n\t\t\t\t\ttargetValue: targetValue,\r\n\t\t\t\t\ttype: valueType\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tthis.activeAnimations.push({\r\n\t\t\t\telement: element,\r\n\t\t\t\tproperties: organisedProperties,\r\n\t\t\t\toptions: options,\r\n\t\t\t\tstartTime: currentTime,\r\n\t\t\t\tcurrentTime: currentTime,\r\n\t\t\t\tendTime: currentTime + options.duration\r\n\t\t\t});\r\n\t\t\tthis.startAnimationInterval();\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Stop an existing animation\r\n\t\t//------------------------------------------------\r\n\t\tstopAnimation: function(element) {\r\n\t\t\t// Switch to the page element relevant to the current browser if needed\r\n\t\t\tif (element === document.documentElement) {\r\n\t\t\t\telement = NATION.Utils.getPageElement();\r\n\t\t\t\tthis.stopJSAnimation(element);\r\n\t\t\t}\r\n\t\t\tif (this.CSS3Available) {\r\n\t\t\t\t// Stop CSS transition in progress\r\n\t\t\t\tvar currentStyles = (window.getComputedStyle) ? getComputedStyle(element) : element.currentStyle;\r\n\t\t\t\tvar i = 0, length = this.activeAnimations.length, propName = \"\";\r\n\t\t\t\tfor (; i < length; i++) {\r\n\t\t\t\t\tif (this.activeAnimations[i] && this.activeAnimations[i].element === element) {\r\n\t\t\t\t\t\tvar k = 0, propLength = this.activeAnimations[i].properties.length;\r\n\t\t\t\t\t\tfor (; k < propLength; k++) {\r\n\t\t\t\t\t\t\tpropName = this.activeAnimations[i].properties[k].name;\r\n\t\t\t\t\t\t\telement.style[propName] = currentStyles[propName];\r\n\t\t\t\t\t\t\tif (propName.search(\"scroll\") > -1) {\r\n\t\t\t\t\t\t\t\tthis.stopJSAnimation(element);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Remove transition and listeners\r\n\t\t\t\telement.removeEventListener(this.transitionEndString, _private.onTransitionEnd, false);\r\n\t\t\t\telement.style[this.transitionString] = \"none\";\r\n\t\t\t\tthis.removeAnimation(element);\r\n\t\t\t} else {\r\n\t\t\t\t// Stop JS animation in progress\r\n\t\t\t\tthis.stopJSAnimation(element);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Stops a JavaScript animation in progress\r\n\t\t//------------------------------------------------\r\n\t\tstopJSAnimation: function(element) {\r\n\t\t\tthis.removeAnimation(element);\r\n\t\t\tif (this.activeAnimations.length <= 0) {\r\n\t\t\t\tcancelAnimationFrame(this.animRequest);\r\n\t\t\t\tclearInterval(this.animationTimer);\r\n\t\t\t\tthis.animationTimer = null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Creates timer to loop through all active animations\r\n\t\t//------------------------------------------------\r\n\t\tstartAnimationInterval: function() {\r\n\t\t\tif (this.animationTimer) {\r\n\t\t\t\tclearTimeout(this.animationTimer);\r\n\t\t\t}\r\n\t\t\tthis.animationTimer = setTimeout(function() {\r\n\t\t\t\t_private.animRequest = requestAnimationFrame(_private.updateAnimation);\r\n\t\t\t}, 1000/60);\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Tween from one colour to another based on progress\r\n\t\t//------------------------------------------------\r\n\t\ttweenColour: function(progress, startValue, targetValue) {\r\n\t\t\tif (startValue.search(\"#\") >= 0) {\r\n\t\t\t\tstartValue = this.hexToRGB(startValue);\r\n\t\t\t}\r\n\t\t\tif (targetValue.search(\"#\") >= 0) {\r\n\t\t\t\ttargetValue = this.hexToRGB(targetValue);\r\n\t\t\t}\r\n\t\t\tstartValue = this.RGBToArray(startValue);\r\n\t\t\ttargetValue = this.RGBToArray(targetValue);\r\n\r\n\t\t\tvar red = (targetValue[0] * progress) + (startValue[0] * (1 - progress));\r\n\t\t\tvar green = (targetValue[1] * progress) + (startValue[1] * (1 - progress));\r\n\t\t\tvar blue = (targetValue[2] * progress) + (startValue[2] * (1 - progress));\r\n\t\t\treturn this.RGBToHex(\"(\" + red + \",\" + green + \",\" + blue + \")\");\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Go through each transform property and move\r\n\t\t// them along slightly\r\n\t\t//------------------------------------------------\r\n\t\ttweenTransform: function(easing, progress, elapsed, startValues, targetValues, duration) {\r\n\t\t\tvar newValues = {}, startValue, targetValue, unit, newValue, newNumber;\r\n\t\t\tfor (var propName in targetValues) {\r\n\t\t\t\tif (typeof targetValues[propName] !== \"string\") {\r\n\t\t\t\t\t// Value was comma separated (eg. translate(10px, 20px))\r\n\t\t\t\t\tnewValue = \"\";\r\n\t\t\t\t\tvar i = 0, length = targetValues[propName].length;\r\n\t\t\t\t\tfor (; i < length; i++) {\r\n\t\t\t\t\t\tif (typeof startValues[propName] !== \"string\" && startValues[propName][i]) {\r\n\t\t\t\t\t\t\tstartValue = parseFloat(startValues[propName][i].replace(unit, \"\"));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tstartValue = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (targetValues[propName][i]) {\r\n\t\t\t\t\t\t\ttargetValue = parseFloat(targetValues[propName][i].replace(unit, \"\"));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttargetValue = startValue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tnewNumber = this.easing[easing](progress, elapsed, startValue, targetValue, duration);\r\n\t\t\t\t\t\tunit = targetValues[propName][i].replace(/[0-9|\\-|\\.]/g, \"\");\r\n\t\t\t\t\t\tif (unit === \"\") {\r\n\t\t\t\t\t\t\tunit = startValues[propName][i].replace(/[0-9|\\-|\\.]/g, \"\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//if (unit === \"\") {\r\n\t\t\t\t\t\t//\tunit = \"px\";\r\n\t\t\t\t\t\t//}\r\n\t\t\t\t\t\tnewValue += newNumber + unit;\r\n\t\t\t\t\t\tif (i < length-1) newValue += \",\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnewValues[propName] = newValue;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Standard single value string\r\n\t\t\t\t\tunit = targetValues[propName].replace(/[0-9|\\-|\\.]/g, \"\");\r\n\t\t\t\t\tif (unit === \"\") {\r\n\t\t\t\t\t\tunit = startValues[propName].replace(/[0-9|\\-|\\.]/g, \"\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//if (unit === \"\") {\r\n\t\t\t\t\t\t//unit = \"px\";\r\n\t\t\t\t\t//}\r\n\t\t\t\t\tstartValue = (startValues[propName] === 0) ? 0 : parseFloat(startValues[propName].replace(unit, \"\"));\r\n\t\t\t\t\ttargetValue = parseFloat(targetValues[propName].replace(unit, \"\"));\r\n\t\t\t\t\tnewValues[propName] = this.easing[easing](progress, elapsed, startValue, targetValue, duration);\r\n\t\t\t\t\tnewValues[propName] += unit;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn newValues;\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Build up transform string from passed values\r\n\t\t//------------------------------------------------\r\n\t\tapplyNewTransform: function(element, propertyName, values) {\r\n\t\t\tvar transformString = \"\";\r\n\t\t\tfor (var attribute in values) {\r\n\t\t\t\ttransformString += attribute + \"(\" + values[attribute] + \") \";\r\n\t\t\t}\r\n\t\t\telement.style[propertyName] = transformString;\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// The main animation loop for javascript mode\r\n\t\t//------------------------------------------------\r\n\t\tupdateAnimation: function() {\r\n\t\t\tvar anims = _private.activeAnimations, allAnimsComplete = true;\r\n\t\t\tvar i = 0, length = anims.length, currentValue, newValue, propertyData, optionData, completeAnims;\r\n\t\t\tvar pixels, percentage;\r\n\t\t\tfor (; i < length; i++) {\r\n\t\t\t\tanims[i].currentTime = Date.now();\r\n\t\t\t\tcompleteAnims = 0;\r\n\t\t\t\tfor (var k = 0; k < anims[i].properties.length; k++) {\r\n\t\t\t\t\tpropertyData = anims[i].properties[k];\r\n\t\t\t\t\t// If this property is fully animated, ignore it this time around\r\n\t\t\t\t\tif (!propertyData.complete) {\r\n\t\t\t\t\t\toptionData = anims[i].options;\r\n\t\t\t\t\t\tvar progress = (anims[i].currentTime - anims[i].startTime) / (anims[i].endTime - anims[i].startTime);\r\n\t\t\t\t\t\tif (progress > 1) progress = 1;\r\n\t\t\t\t\t\tvar newValue = 0;\r\n\t\t\t\t\t\tif (propertyData.type === _private.types.TRANSFORM) {\r\n\t\t\t\t\t\t\tnewValue = _private.tweenTransform(optionData.easing, progress, anims[i].currentTime - anims[i].startTime, propertyData.startValue, propertyData.targetValue, anims[i].options.duration);\r\n\t\t\t\t\t\t} else if (propertyData.type === _private.types.COLOUR) {\r\n\t\t\t\t\t\t\tnewValue = _private.tweenColour(progress, propertyData.startValue, propertyData.targetValue);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tnewValue = _private.easing[optionData.easing](progress, anims[i].currentTime - anims[i].startTime, parseInt(propertyData.startValue, 10), propertyData.targetValue, anims[i].options.duration);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar easedProgress = _private.easing[optionData.easing](progress, anims[i].currentTime - anims[i].startTime, 0, 1, anims[i].options.duration);\r\n\t\t\t\t\t\t// This property has reached it's target value\r\n\t\t\t\t\t\tif (progress === 1) {\r\n\t\t\t\t\t\t\t// Handle JavaScript's \"issues\" with floating points\r\n\t\t\t\t\t\t\tnewValue = propertyData.targetValue;\r\n\t\t\t\t\t\t\tanims[i].properties[k].complete = true;\r\n\t\t\t\t\t\t\tcompleteAnims++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (propertyData.name === \"scrollLeft\" || propertyData.name === \"scrollTop\") {\r\n\t\t\t\t\t\t\t// Animate scroll differently\r\n\t\t\t\t\t\t\tanims[i].element[propertyData.name] = newValue;\r\n\t\t\t\t\t\t} else if (propertyData.type === _private.types.TRANSFORM) {\r\n\t\t\t\t\t\t\t// Create the new transform string and apply it to the element\r\n\t\t\t\t\t\t\t_private.applyNewTransform(anims[i].element, propertyData.name, newValue);\r\n\t\t\t\t\t\t} else if (propertyData.type === _private.types.PERCENT) {\r\n\t\t\t\t\t\t\tanims[i].element.style[propertyData.name] = newValue + \"%\";\r\n\t\t\t\t\t\t} else if (propertyData.type === _private.types.PIXELS) {\r\n\t\t\t\t\t\t\tanims[i].element.style[propertyData.name] = newValue + \"px\";\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (propertyData.name === \"filter\") {\r\n\t\t\t\t\t\t\t\t// Change to filters for IE8\r\n\t\t\t\t\t\t\t\tnewValue = _private.convertOpacityToFilterString(newValue);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tanims[i].element.style[propertyData.name] = newValue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (progress < 1) {\r\n\t\t\t\t\t\t\tallAnimsComplete = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (anims[i].options.update) {\r\n\t\t\t\t\t\t\tanims[i].options.update(easedProgress);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (completeAnims === anims[i].properties.length) {\r\n\t\t\t\t\t\tanims[i].allComplete = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!allAnimsComplete) {\r\n\t\t\t\t_private.startAnimationInterval();\r\n\t\t\t} else {\r\n\t\t\t\tcancelAnimationFrame(_private.animRequest);\r\n\t\t\t\tclearInterval(_private.animationTimer);\r\n\t\t\t\t_private.animationTimer = null;\r\n\t\t\t}\r\n\r\n\t\t\ti = 0;\r\n\t\t\tvar clonedAnimArray = _private.activeAnimations.slice(0);\r\n\t\t\tfor (; i < length; i++) {\r\n\t\t\t\tif (clonedAnimArray[i].allComplete) {\r\n\t\t\t\t\t_private.removeAnimation(clonedAnimArray[i].element);\r\n\t\t\t\t\tif (clonedAnimArray[i].options.complete) {\r\n\t\t\t\t\t\tvar e = {};\r\n\t\t\t\t\t\te.target = e.currentTarget = clonedAnimArray[i].element;\r\n\t\t\t\t\t\tclonedAnimArray[i].options.complete(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Clear animation data\r\n\t\t//------------------------------------------------\r\n\t\tremoveAnimation: function(element) {\r\n\t\t\tvar i = 0, length = this.activeAnimations.length;\r\n\t\t\tfor (; i < length; i++) {\r\n\t\t\t\tif (this.activeAnimations[i].element === element) {\r\n\t\t\t\t\tthis.activeAnimations.splice(i, 1);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Check if element has a callback, then call it\r\n\t\t//------------------------------------------------\r\n\t\thandleCallback: function(element) {\r\n\t\t\tvar i = 0, length = this.activeAnimations.length;\r\n\t\t\tfor (; i < length; i++) {\r\n\t\t\t\tif (this.activeAnimations[i].options.complete) {\r\n\t\t\t\t\tthis.activeAnimations[i].options.complete(element);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Convert a hex colour to RGB format\r\n\t\t//------------------------------------------------\r\n\t\thexToRGB: function(hex) {\r\n\t\t\t// Expand shorthand hexes first\r\n\t\t\tvar shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\r\n\t\t\thex = hex.replace(shorthandRegex, function(m, r, g, b) {\r\n\t\t\t\treturn r + r + g + g + b + b;\r\n\t\t\t});\r\n\t\t\t// Convert to RGB values for each colour\r\n\t\t\tvar result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n\t\t\treturn \"(\" + \r\n\t\t\t\tparseInt(result[1], 16) + \",\" + \r\n\t\t\t\tparseInt(result[2], 16) + \",\" + \r\n\t\t\t\tparseInt(result[3], 16) + \")\";\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Convert an individual colour to hex (eg. red=FF)\r\n\t\t//------------------------------------------------\r\n\t\tcolourSectionToHex: function(colour) {\r\n\t\t\tcolour = parseInt(colour, 10);\r\n\t\t\tvar hex = colour.toString(16);\r\n\t\t\treturn (hex.length === 1) ? \"0\" + hex : hex;\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Convert an RGB colour to hex format\r\n\t\t//------------------------------------------------\r\n\t\tRGBToHex: function(rgb) {\r\n\t\t\tvar colours = this.RGBToArray(rgb);\r\n\t\t\treturn \"#\" + this.colourSectionToHex(colours[0]) + this.colourSectionToHex(colours[1]) + this.colourSectionToHex(colours[2]);\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Convert an RGB value into an array with separate colours\r\n\t\t//------------------------------------------------\r\n\t\tRGBToArray: function(rgb) {\r\n\t\t\trgb = rgb.replace(/ /g, \"\");\r\n\t\t\tvar colours = rgb.split(\"(\");\r\n\t\t\tcolours = colours[1].split(\")\");\r\n\t\t\tcolours = colours[0].split(\",\");\r\n\t\t\treturn colours;\r\n\t\t},\r\n\r\n\t\t//------------------------------------------------\r\n\t\t// Fire callback and forget about this animation\r\n\t\t//------------------------------------------------\r\n\t\tonTransitionEnd: function(e) {\r\n\t\t\tvar i = 0, length = _private.activeAnimations.length;\r\n\t\t\tvar clonedAnimArray = _private.activeAnimations.slice(0);\r\n\t\t\tfor (; i < length; i++) {\r\n\t\t\t\tif (clonedAnimArray[i].element === e.target) {\r\n\t\t\t\t\t//_private.stopAnimation(e.target);\r\n\t\t\t\t\tclonedAnimArray[i].element.removeEventListener(\"transitionend\", _private.onTransitionEnd, false);\r\n\t\t\t\t\tif (clonedAnimArray[i].element.style.removeProperty) {\r\n\t\t\t\t\t\tclonedAnimArray[i].element.style.removeProperty(_private.transitionString);\r\n\t\t\t\t\t\t//clonedAnimArray[i].element.style[_private.transitionString] = \"none\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tclonedAnimArray[i].element.style.removeAttribute(_private.transitionString);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_private.removeAnimation(clonedAnimArray[i].element);\r\n\t\t\t\t\tif (clonedAnimArray[i].options.complete) {\r\n\t\t\t\t\t\tvar e = {};\r\n\t\t\t\t\t\te.target = e.currentTarget = clonedAnimArray[i].element;\r\n\t\t\t\t\t\tclonedAnimArray[i].options.complete(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t_private.init();\r\n\treturn _public;\r\n}());\r\n\r\n\r\n(function() {\r\n    var lastTime = 0;\r\n    var vendors = ['webkit', 'moz'];\r\n    for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n        window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];\r\n        window.cancelAnimationFrame =\r\n          window[vendors[x]+'CancelAnimationFrame'] || window[vendors[x]+'CancelRequestAnimationFrame'];\r\n    }\r\n\r\n    if (!window.requestAnimationFrame)\r\n        window.requestAnimationFrame = function(callback, element) {\r\n            var currTime = new Date().getTime();\r\n            var timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n            var id = window.setTimeout(function() { callback(currTime + timeToCall); },\r\n              timeToCall);\r\n            lastTime = currTime + timeToCall;\r\n            return id;\r\n        };\r\n\r\n    if (!window.cancelAnimationFrame)\r\n        window.cancelAnimationFrame = function(id) {\r\n            clearTimeout(id);\r\n        };\r\n}());","//////////////////////////////////////////////////////////////////////////////\r\n// Nation Library\r\n// Event Dispatcher\r\n// Version 2.1.2\r\n//////////////////////////////////////////////////////////////////////////////\r\n\r\n(function(window, document, undefined) {\r\n\r\n\t\"use strict\";\r\n\r\n\tif (typeof window.NATION === \"undefined\") window.NATION = {};\r\n\r\n\t//////////////////////////\r\n\t// Depenency Management\r\n\t//////////////////////////\r\n\t_initClass();\r\n\tvar packageName = \"NATION.EventDispatcher\";\r\n\twindow.waitingDependencies = window.waitingDependencies || {};\r\n\t// Check for any classes waiting on this one\r\n\tfor (var className in window.waitingDependencies) {\r\n\t\tfor (var propName in window.waitingDependencies[className].dependencies) {\r\n\t\t\tif (propName === packageName) {\r\n\t\t\t\t// Re-run the waiting class' dependency check\r\n\t\t\t\twindow.waitingDependencies[className].callback();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t//////////////////////////\r\n\t// Create Class\r\n\t//////////////////////////\r\n\tfunction _initClass() {\r\n\t\t/**\r\n\t\t* ### Dependencies:\r\n\t\t* None\r\n\t\t*\r\n\t\t* ### About:\r\n\t\t* Enables any class to dispatch custom events, and adds addListener and removeListener methods to enable any parent class to listen for those custom events\r\n\t\t*\r\n\t\t* @class EventDispatcher\r\n\t\t*/\r\n\t\tvar EventDispatcher = function() {\r\n\t\t\tthis.wheelEventName = \"\";\r\n\t\t\tthis.eventHandlers = {};\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Add a listener for a custom event, and run a callback when the event fires\r\n\t\t* @param {string} eventNames One or more event names, separated by spaces\r\n\t\t* @param {function} callback The callback method to run when the event fires\r\n\t\t*/\r\n\t\tEventDispatcher.prototype.addListener = function(eventNames, callback) {\r\n\t\t\t// Throw an error for a missing event name\r\n\t\t\tif (!eventNames) throw new Error(this.ERROR_MISSING_EVENT_NAME);\r\n\t\t\teventNames = eventNames.split(\" \");\r\n\t\t\tvar i = 0, length = eventNames.length;\r\n\t\t\tfor (; i < length; i++) {\r\n\t\t\t\t// Throw an error for a missing callback (else nothing would happen when the event fires)\r\n\t\t\t\tif (!callback) throw new Error(this.ERROR_MISSING_CALLBACK.replace(\"{{eventName}}\", eventNames[i]));\r\n\t\t\t\t// Ensure the wheel event is named correctly for the current browser\r\n\t\t\t\teventNames[i] = this.normalizeMouseWheelEvent(eventNames[i]);\r\n\t\t\t\t// If an array hasn't yet been created for this event type, create a blank one\r\n\t\t\t\tif (typeof this.eventHandlers[eventNames[i]] === \"undefined\") this.eventHandlers[eventNames[i]] = [];\r\n\t\t\t\t// Add the new handler to the array\r\n\t\t\t\tthis.eventHandlers[eventNames[i]].push(callback);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Remove a listener for a custom event\r\n\t\t* @param {string} eventNames One or more event names, separated by spaces, to stop listening for\r\n\t\t* @param {function} callback The callback method that was due to run. If this argument is blank, all listeners for the event name will be removed\r\n\t\t*/\r\n\t\tEventDispatcher.prototype.removeListener = function(eventNames, callback) {\r\n\t\t\t// Throw an error for a missing event name\r\n\t\t\tif (!eventNames) throw new Error(this.ERROR_MISSING_EVENT_NAME);\r\n\t\t\teventNames = eventNames.split(\" \");\r\n\t\t\tvar i = 0, length = eventNames.length;\r\n\t\t\tfor (; i < length; i++) {\r\n\t\t\t\t// Ensure the wheel event is named correctly for the current browser\r\n\t\t\t\teventNames[i] = this.normalizeMouseWheelEvent(eventNames[i]);\r\n\t\t\t\tif (this.eventHandlers[eventNames[i]] instanceof Array) {\r\n\t\t\t\t\t// Remove all callbacks for this event if no callback was specified\r\n\t\t\t\t\tif (!callback) {\r\n\t\t\t\t\t\tthis.eventHandlers[eventNames[i]] = [];\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// If a callback was specified, remove the matching handler\r\n\t\t\t\t\tvar i = 0, length = this.eventHandlers[eventNames[i]].length;\r\n\t\t\t\t\tfor (; i < length; i++) {\r\n\t\t\t\t\t\t// If the callback argument matches the callback in the registered handler\r\n\t\t\t\t\t\tif (String(this.eventHandlers[eventNames[i]]) === String(callback)) {\r\n\t\t\t\t\t\t\t// Remove it from the handler array\r\n\t\t\t\t\t\t\tthis.eventHandlers[eventNames[i]].splice(i, 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Fire one or more custom events\r\n\t\t* @param {string} eventName The name of the event to fire. Can be multiple event names separated by spaces\r\n\t\t*/\r\n\t\tEventDispatcher.prototype.trigger = function(eventNames) {\r\n\t\t\t// Throw an error for a missing event name\r\n\t\t\tif (!eventNames) throw new Error(this.ERROR_MISSING_EVENT_NAME);\r\n\t\t\t// Multiple events can be fired at once, so convert arguments to an array\r\n\t\t\tif (arguments.length > 1) {\r\n\t\t\t\t// If the event names were passed as separate arguments, pull them into an array\r\n\t\t\t\teventNames = (Array.prototype.slice.call(arguments, 0));\r\n\t\t\t} else {\r\n\t\t\t\t// Event names were separated by spaces, so convert them to an array by splitting on spaces\r\n\t\t\t\teventNames = eventNames.split(\" \");\r\n\t\t\t}\r\n\t\t\t// Initialise variables used to loop through handlers\r\n\t\t\tvar i = 0, length = eventNames.length;\r\n\t\t\tvar handlers = [], totalHandlers, k = 0, eventObject;\r\n\t\t\t// Cycle through each event name\r\n\t\t\tfor (; i < length; i++) {\r\n\t\t\t\t// Ensure the wheel event is named correctly for the current browser\r\n\t\t\t\teventNames[i] = this.normalizeMouseWheelEvent(eventNames[i]);\r\n\t\t\t\t// Find existing handlers for this event name\r\n\t\t\t\thandlers = this.eventHandlers[eventNames[i]];\r\n\t\t\t\t// If there is one or more handlers for this event, call them\r\n\t\t\t\tif (typeof handlers !== \"undefined\") {\r\n\t\t\t\t\ttotalHandlers = handlers.length;\r\n\t\t\t\t\t// Loop through each registered handler\r\n\t\t\t\t\tfor (k = 0; k < totalHandlers; k++) {\r\n\t\t\t\t\t\t// Make sure the handler's value is non-null\r\n\t\t\t\t\t\tif (handlers[k]) {\r\n\t\t\t\t\t\t\t// Build an object similar to a standard event object\r\n\t\t\t\t\t\t\teventObject = {\r\n\t\t\t\t\t\t\t\ttarget: this,\r\n\t\t\t\t\t\t\t\tcurrentTarget: this,\r\n\t\t\t\t\t\t\t\ttype: eventNames[i],\r\n\t\t\t\t\t\t\t\tbubbles: false,\r\n\t\t\t\t\t\t\t\tcancelable: false,\r\n\t\t\t\t\t\t\t\tdefaultPrevented: false,\r\n\t\t\t\t\t\t\t\ttimestamp: Date.now(),\r\n\t\t\t\t\t\t\t\tisTrusted: false\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t// Call the target function in the current scope, while also passing the event object\r\n\t\t\t\t\t\t\thandlers[k].apply(this, [eventObject]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tEventDispatcher.prototype.ERROR_MISSING_EVENT_NAME = \"NATION.EventDispatcher: The argument 'eventName' is required\";\r\n\t\tEventDispatcher.prototype.ERROR_MISSING_CALLBACK = \"NATION.EventDispatcher: The 'callback' argument is required to listen for event '{{eventName}}'\";\r\n\r\n\t\t/**\r\n\t\t* Check which mousewheel event name is supported in the current browser\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tEventDispatcher.prototype.normalizeMouseWheelEvent = function(eventName) {\r\n\t\t\tif (eventName.search(/mousewheel|wheel|DOMMouseScroll/g) >= 0) {\r\n\t\t\t\t// It is only required to run this once\r\n\t\t\t\tif (!this.wheelEventName) {\r\n\t\t\t\t\t// \"wheel\" is the standards-compliant event name\r\n\t\t\t\t\tif (\"onwheel\" in document.createElement(\"div\")) {\r\n\t\t\t\t\t\tthis.wheelEventName = \"wheel\";\r\n\t\t\t\t\t} else if (document.onmousewheel !== undefined) {\r\n\t\t\t\t\t\tthis.wheelEventName = \"mousewheel\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.wheelEventName = \"DOMMouseScroll\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn this.wheelEventName;\r\n\t\t\t} else {\r\n\t\t\t\t// Remove any spaces from the event name\r\n\t\t\t\treturn eventName.replace(/ /g, \"\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\twindow.NATION.EventDispatcher = EventDispatcher;\r\n\t}\r\n\r\n}(window, document, undefined));","//////////////////////////////////////////////////////////////////////////////\r\n// Nation Library\r\n// Progress Bar\r\n// Version 2.2.3\r\n// Dependencies: NATION.Utils, NATION.EventDispatcher\r\n//////////////////////////////////////////////////////////////////////////////\r\n\r\n(function(window, document, undefined) {\r\n\r\n\t\"use strict\";\r\n\r\n\tif (typeof window.NATION === \"undefined\") window.NATION = {};\r\n\r\n\t//////////////////////////\r\n\t// Depenency Management\r\n\t//////////////////////////\r\n\tfunction checkDependencies() {\r\n\t\tvar packageName = \"NATION.ProgressBar\";\r\n\t\tvar dependencies = {\r\n\t\t\t\"NATION.Utils\": NATION.Utils,\r\n\t\t\t\"NATION.EventDispatcher\": NATION.EventDispatcher\r\n\t\t};\r\n\t\t\r\n\t\twindow.waitingDependencies = window.waitingDependencies || {};\r\n\t\tvar dependenciesLoaded = true;\r\n\t\tfor (var propName in dependencies) {\r\n\t\t\tif (!dependencies[propName]) {\r\n\t\t\t\twindow.waitingDependencies[packageName] = {\r\n\t\t\t\t\tdependencies: dependencies,\r\n\t\t\t\t\tcallback: function() {checkDependencies();}\r\n\t\t\t\t};\r\n\t\t\t\tdependenciesLoaded = false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (dependenciesLoaded) {\r\n\t\t\tdelete window.waitingDependencies[packageName];\r\n\t\t\t_initClass();\r\n\t\t\t// Check for any classes waiting on this one\r\n\t\t\tfor (var className in window.waitingDependencies) {\r\n\t\t\t\tfor (propName in window.waitingDependencies[className].dependencies) {\r\n\t\t\t\t\tif (propName === packageName) {\r\n\t\t\t\t\t\t// Re-run the waiting class' dependency check\r\n\t\t\t\t\t\twindow.waitingDependencies[className].callback();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tcheckDependencies();\r\n\r\n\t//////////////////////////\r\n\t// Create Class\r\n\t//////////////////////////\r\n\tfunction _initClass() {\r\n\t\t/**\r\n\t\t* ### Dependencies:\r\n\t\t* [NATION.Utils](Utils.js.html)\r\n\t\t* [NATION.EventDispatcher](EventDispatcher.js.html)\r\n\t\t*\r\n\t\t* ### About:\r\n\t\t* Progress bar displaying a percentage from 0 to 100\r\n\t\t*\r\n\t\t* Selector is expected to contain an element with class 'js-progress' or 'progress', which is the actual progress bar itself. The width of this element is changed as a percentage to represent the desired percentage to display\r\n\t\t*\r\n\t\t* Selector can contain a clickable hit area. This should be an element with the class 'js-hitarea' or 'hitarea'\r\n\t\t* Selector can also contain a handle, by using class 'js-handle' or 'handle'\r\n\t\t* Selector can also contain a separate load progress bar, marked with class 'js-loaded' or 'loaded'. This can be set to different percentages than the progress bar, via the 'setLoaded' method. This will also resize the hit area element to match\r\n\t\t*\r\n\t\t* @class ProgressBar\r\n\t\t* @param {domelement_or_jqueryobject} selector The element that will behave as a scrollbar\r\n\t\t* @param {object} options Object containing settings for this progress bar<br />\r\n\t\t* <b>handlePositioning</b> <i>{string: \"outside\"}</i> Either \"outside\" (default) or \"inside\". Defines how the handle should be positioned within the bar. \"outside\" sees the cenre of the handle move between 0 and 100% of the bar, thus leading to it poking outside. \"inside\" keeps the handle fully within the bar\r\n\t\t* <b>snapSegments</b> <i>{number: 1}</i> Enable snapping by dividing the bar into segments. More than one segment will trigger snapping\r\n\t\t* @jsFiddle //jsfiddle.net/NationStudio/7thLue5y/embedded/\r\n\t\t*/\r\n\t\tvar ProgressBar = function(selector, handlePositioning, options) {\r\n\t\t\tNATION.EventDispatcher.call(this);\r\n\t\t\tthis.options = {\r\n\t\t\t\thandlePositioning: \"outside\",\r\n\t\t\t\tsnapSegments: 1\r\n\t\t\t};\r\n\t\t\t// Keeps older projects working\r\n\t\t\tif (handlePositioning && typeof handlePositioning === \"string\") {\r\n\t\t\t\tthis.options.handlePositioning = handlePositioning;\r\n\t\t\t} else if (handlePositioning && !options) {\r\n\t\t\t\toptions = handlePositioning;\r\n\t\t\t}\r\n\t\t\tif (options) {\r\n\t\t\t\tfor (var optionName in options) {\r\n\t\t\t\t\tthis.options[optionName] = options[optionName];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Store reference to the main selector\r\n\t\t\tthis.__DOMElement = NATION.Utils.getDOMElement(selector);\r\n\t\t\t// Store references to the child elements\r\n\t\t\tthis.__hitArea = this.__DOMElement.querySelector(\".js-hitarea, .hitarea\");\r\n\t\t\tthis.__handle = this.__DOMElement.querySelector(\".js-handle, .handle\");\r\n\t\t\tthis.__progressElement = this.__DOMElement.querySelector(\".js-progress, .progress\");\r\n\t\t\tthis.__loadedElement = this.__DOMElement.querySelector(\".js-loaded, .loaded\");\r\n\t\t\tif (this.__handle) {\r\n\t\t\t\tthis.__handle.setAttribute(\"draggable\", \"false\");\r\n\t\t\t}\r\n\t\t\t// Variable definitions\r\n\t\t\tthis.requestedPercentage = 0;\r\n\t\t\tthis.displayedPercentage = 0;\r\n\t\t\tthis.displayedLoadedPercentage = 0;\r\n\t\t\tthis.handleDragging = false;\r\n\t\t\t// Setup\r\n\t\t\tthis.createListeners();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Inherits from NATION.EventDispatcher\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tProgressBar.prototype = Object.create(NATION.EventDispatcher.prototype);\r\n\t\tProgressBar.prototype.constructor = ProgressBar;\r\n\r\n\t\t/**\r\n\t\t* Event that fires when the progress bar has been clicked\r\n\t\t*/\r\n\t\tProgressBar.prototype.CLICKED = \"clicked\";\r\n\t\t/**\r\n\t\t* Event that fires when a handle drag has started\r\n\t\t*/\r\n\t\tProgressBar.prototype.HANDLE_MOUSE_DOWN = \"HandleMouseDown\";\r\n\t\t/**\r\n\t\t* Event that fires each time the user moves the handle during a drag\r\n\t\t*/\r\n\t\tProgressBar.prototype.HANDLE_DRAGGED = \"HandleDragged\";\r\n\t\t/**\r\n\t\t* Event that fires when the user releases the handle\r\n\t\t*/\r\n\t\tProgressBar.prototype.HANDLE_RELEASED = \"HandleReleased\";\r\n\t\t/**\r\n\t\t* Event that fires when the value of the progress bar changes\r\n\t\t*/\r\n\t\tProgressBar.prototype.VALUE_CHANGED = \"ValueChanged\";\r\n\r\n\t\t/**\r\n\t\t* Returns true if the user is currently dragging the handle\r\n\t\t* @return {boolean} Whether the user is currently dragging the handle or not\r\n\t\t*/\r\n\t\tProgressBar.prototype.getHandleDragInProgress = function() {\r\n\t\t\treturn this.handleDragging;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Returns the currently displayed percentage\r\n\t\t* @return {number} Percentage between 0 and 1\r\n\t\t*/\r\n\t\tProgressBar.prototype.getPercentage = function() {\r\n\t\t\treturn this.displayedPercentage;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Returns the percentage corresponding to where the user last clicked\r\n\t\t* @return {number} Percentage between 0 and 1\r\n\t\t*/\r\n\t\tProgressBar.prototype.getRequestedPercentage = function() {\r\n\t\t\treturn this.requestedPercentage;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Display a passed percentage\r\n\t\t* @param {number} percentage The percentage to show, between 0 and 1\r\n\t\t*/\r\n\t\tProgressBar.prototype.setProgress = function(percentage) {\r\n\t\t\t// Ensure percentage isn't out of bounds\r\n\t\t\tif (percentage > 1) {\r\n\t\t\t\tpercentage = 1;\r\n\t\t\t} else if (percentage < 0) {\r\n\t\t\t\tpercentage = 0;\r\n\t\t\t}\r\n\t\t\tif (percentage !== this.displayedPercentage) {\r\n\t\t\t\tvalueChanged = true;\r\n\t\t\t}\r\n\t\t\tthis.displayedPercentage = percentage;\r\n\t\t\tif (valueChanged) {\r\n\t\t\t\tthis.trigger(this.VALUE_CHANGED);\r\n\t\t\t}\r\n\t\t\tif (this.options.handlePositioning === \"inside\") {\r\n\t\t\t\tpercentage = ((this.__DOMElement.offsetWidth - this.__handle.offsetWidth) * percentage) / this.__DOMElement.offsetWidth;\r\n\t\t\t}\r\n\t\t\t// Convert percentage to correct value for CSS\r\n\t\t\tvar newWidth = percentage * 100;\r\n\t\t\tif (newWidth > 0) {\r\n\t\t\t\tnewWidth += \"%\";\r\n\t\t\t}\r\n\t\t\t// Apply new width to the progress element\r\n\t\t\tif (this.__progressElement) {\r\n\t\t\t\tthis.__progressElement.style.width = newWidth;\r\n\t\t\t}\r\n\t\t\tvar valueChanged = false;\r\n\t\t\t// Update the currently displayed percentage\r\n\t\t\t\r\n\t\t\tthis.setNewHandlePosition(percentage);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Set the load bar position via a percentage\r\n\t\t* @param {number} percentage Percentage between 0 and 1\r\n\t\t* @param {boolean} adjustHitArea Whether to match hitarea width to progress bar width\r\n\t\t*/\r\n\t\tProgressBar.prototype.setLoaded = function(percentage, adjustHitArea) {\r\n\t\t\t// Ensure percentage isn't out of bounds\r\n\t\t\tif (percentage > 1) {\r\n\t\t\t\tpercentage = 1;\r\n\t\t\t} else if (percentage < 0) {\r\n\t\t\t\tpercentage = 0;\r\n\t\t\t}\r\n\t\t\t// Convert percentage to correct value for CSS\r\n\t\t\tvar newWidth = (percentage * 100) + \"%\";\r\n\t\t\t// Apply new width to the loaded element, if one exists\r\n\t\t\tif (this.__loadedElement) {\r\n\t\t\t\tthis.__loadedElement.style.width = newWidth;\r\n\t\t\t}\r\n\t\t\t// Apply new width to the hit area element, if one exists\r\n\t\t\tif (adjustHitArea && this.__hitArea) {\r\n\t\t\t\tthis.__hitArea.style.width = newWidth;\r\n\t\t\t}\r\n\t\t\t// Store this percentage as the currently displayed one\r\n\t\t\tthis.displayedLoadedPercentage = percentage;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Set the handle to a percentage along the bar\r\n\t\t* @param {number} percentage Percentage to position the handle at, between 0 and 1\r\n\t\t*/\r\n\t\tProgressBar.prototype.setNewHandlePosition = function(percentage) {\r\n\t\t\tif (this.__handle) {\r\n\t\t\t\tvar progressBarWidth = this.__progressElement.offsetWidth;\r\n\t\t\t\tvar newPosition = percentage;\r\n\t\t\t\tif (newPosition < 0) newPosition = 0;\r\n\t\t\t\tvar hitAreaWidthPercent = 0;\r\n\t\t\t\tif (this.__hitArea) {\r\n\t\t\t\t\thitAreaWidthPercent = this.__hitArea.offsetWidth / progressBarWidth;\r\n\t\t\t\t} else {\r\n\t\t\t\t\thitAreaWidthPercent = this.__DOMElement.offsetWidth / progressBarWidth;\r\n\t\t\t\t}\r\n\t\t\t\tif (newPosition > hitAreaWidthPercent) newPosition = hitAreaWidthPercent;\r\n\t\t\t\tthis.__handle.style.left = (100 * newPosition) + \"%\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Listen for clicks on the hit area, if one exists\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tProgressBar.prototype.createListeners = function() {\r\n\t\t\tif (this.__hitArea) {\r\n\t\t\t\tthis.__hitArea.addEventListener(\"click\", this.onHitAreaClicked.bind(this));\r\n\t\t\t}\r\n\t\t\tif (this.__handle) {\r\n\t\t\t\tthis.__handle.addEventListener(\"mousedown\", this.onHandleMouseDown.bind(this));\r\n\t\t\t\tthis.__handle.addEventListener(\"click\", this.onHandleClicked.bind(this));\r\n\t\t\t\tthis.__handle.addEventListener(\"touchstart\", this.onHandleTouchStart.bind(this));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Store the last clicked percentage, and signal that the hit area was clicked\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tProgressBar.prototype.onHitAreaClicked = function(e) {\r\n\t\t\t// Get the click position, relative to the progress bar, rather than the browser window\r\n\t\t\tvar clickedX = e.pageX - NATION.Utils.getOffset(e.currentTarget).left;\r\n\t\t\t// Convert it to a percentage and store it for later outside access\r\n\t\t\tthis.requestedPercentage = clickedX / this.__DOMElement.offsetWidth;\r\n\t\t\t// Signal that the progress bar was clicked\r\n\t\t\tthis.trigger(this.CLICKED);\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Start dragging handle\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tProgressBar.prototype.onHandleMouseDown = function(e) {\r\n\t\t\tthis.handleDragging = true;\r\n\t\t\tthis.handler_MouseMove = this.onHandleDragged.bind(this);\r\n\t\t\tthis.handler_MouseUp = this.onHandleReleased.bind(this);\r\n\t\t\tdocument.addEventListener(\"mousemove\", this.handler_MouseMove);\r\n\t\t\tdocument.addEventListener(\"mouseup\", this.handler_MouseUp);\r\n\t\t\tthis.trigger(this.HANDLE_MOUSE_DOWN);\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Move handle to match touch movement\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tProgressBar.prototype.onHandleDragged = function(e) {\r\n\t\t\tvar xPos = e.pageX - NATION.Utils.getOffset(this.__DOMElement).left;\r\n\t\t\tthis.updateHandleOnDrag(xPos);\r\n\t\t\tthis.trigger(this.HANDLE_DRAGGED);\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Position the handle correctly in response to a drag\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tProgressBar.prototype.updateHandleOnDrag = function(xPos) {\r\n\t\t\tvar progressBarWidth = this.__DOMElement.offsetWidth;\r\n\t\t\t// Don't allow handlePositioning to break the requested percentage\r\n\t\t\tif (this.__hitArea && xPos > this.__hitArea.offsetWidth) {\r\n\t\t\t\txPos = this.__hitArea.offsetWidth;\r\n\t\t\t}\r\n\r\n\t\t\tthis.requestedPercentage = xPos / progressBarWidth;\r\n\t\t\tif (this.options.snapSegments > 1) {\r\n\t\t\t\tvar newPercentage = 0;\r\n\t\t\t\tvar visibleSegments = this.options.snapSegments ;\r\n\t\t\t\tvar segmentPercentage = (100 / visibleSegments) / 100;\r\n\t\t\t\tfor (var i = 0, length = visibleSegments; i < length; i++) {\r\n\t\t\t\t\tif (this.requestedPercentage >= ((segmentPercentage/2) + (i * segmentPercentage))) {\r\n\t\t\t\t\t\tnewPercentage = segmentPercentage * (i+1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.requestedPercentage = newPercentage;\r\n\t\t\t}\r\n\t\t\t// Make sure the percentage stays within bounds\r\n\t\t\tif (this.requestedPercentage > 1) this.requestedPercentage = 1;\r\n\t\t\tif (this.requestedPercentage < 0) this.requestedPercentage = 0;\r\n\t\t\tthis.setProgress(this.requestedPercentage);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Stop tracking mouse move events\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tProgressBar.prototype.onHandleReleased = function(e) {\r\n\t\t\tthis.handleDragging = false;\r\n\t\t\tdocument.removeEventListener(\"mousemove\", this.handler_MouseMove);\r\n\t\t\tdocument.removeEventListener(\"mouseup\", this.handler_MouseUp);\r\n\t\t\t\r\n\t\t\tthis.trigger(this.HANDLE_RELEASED);\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Start tracking touch move events\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tProgressBar.prototype.onHandleTouchStart = function(e) {\r\n\t\t\tthis.handleDragging = true;\r\n\t\t\tthis.handler_TouchMove = this.onHandleTouchMove.bind(this);\r\n\t\t\tthis.handler_TouchEnd = this.onHandleTouchEnd.bind(this);\r\n\t\t\tdocument.addEventListener(\"touchmove\", this.handler_TouchMove);\r\n\t\t\tdocument.addEventListener(\"touchend\", this.handler_TouchEnd);\r\n\t\t\tdocument.addEventListener(\"pointermove\", this.handler_TouchMove);\r\n\t\t\tdocument.addEventListener(\"pointerup\", this.handler_TouchEnd);\r\n\t\t\tthis.trigger(this.HANDLE_MOUSE_DOWN);\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Move handle to match touch movement\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tProgressBar.prototype.onHandleTouchMove = function(e) {\r\n\t\t\tvar touches = (typeof e.changedTouches != 'undefined') ? e.changedTouches : [e];\r\n\t\t\tvar xPos = touches[0].pageX - NATION.Utils.getOffset(this.__DOMElement).left;\r\n\t\t\tthis.updateHandleOnDrag(xPos);\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Stop tracking touch move events\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tProgressBar.prototype.onHandleTouchEnd = function(e) {\r\n\t\t\tthis.handleDragging = false;\r\n\t\t\tdocument.removeEventListener(\"touchmove\", this.handler_TouchMove);\r\n\t\t\tdocument.removeEventListener(\"touchend\", this.handler_TouchEnd);\r\n\t\t\tdocument.removeEventListener(\"pointermove\", this.handler_TouchMove);\r\n\t\t\tdocument.removeEventListener(\"pointerup\", this.handler_TouchEnd);\r\n\t\t\tthis.trigger(this.HANDLE_RELEASED);\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Prevent default action\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tProgressBar.prototype.onHandleClicked = function(e) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\r\n\t\twindow.NATION.ProgressBar = ProgressBar;\r\n\t}\r\n\r\n}(window, document, undefined));","//////////////////////////////////////////////////////////////////////////////\r\n// Nation Library\r\n// Core utilities\r\n// Version 2.1.2\r\n//////////////////////////////////////////////////////////////////////////////\r\n\r\n(function(window, document, undefined) {\r\n\r\n\t\"use strict\";\r\n\r\n\tif (typeof window.NATION === \"undefined\") window.NATION = {};\r\n\r\n\t//////////////////////////\r\n\t// Depenency Management\r\n\t//////////////////////////\r\n\t_initClass();\r\n\tvar packageName = \"NATION.Utils\";\r\n\twindow.waitingDependencies = window.waitingDependencies || {};\r\n\t// Check for any classes waiting on this one\r\n\tfor (var className in window.waitingDependencies) {\r\n\t\tfor (var propName in window.waitingDependencies[className].dependencies) {\r\n\t\t\tif (propName === packageName) {\r\n\t\t\t\t// Re-run the waiting class' dependency check\r\n\t\t\t\twindow.waitingDependencies[className].callback();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t//////////////////////////\r\n\t// Create Class\r\n\t//////////////////////////\r\n\tfunction _initClass() {\r\n\t\t/**\r\n\t\t* ### Dependencies:\r\n\t\t* None\r\n\t\t*\r\n\t\t* ### About:\r\n\t\t* This class features a number of useful utility methods for use around your site\r\n\t\t*\r\n\t\t* @class Utils\r\n\t\t*/\r\n\t\tvar Utils = function() {\r\n\t\t\t/**\r\n\t\t\t* Instance variables\r\n\t\t\t* @ignore\r\n\t\t\t*/\r\n\t\t\tthis.requestID = 0;\r\n\t\t\tthis.testElement = document.createElement(\"div\");\r\n\t\t\tthis.pageElement = null;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Load a URL\r\n\t\t* Note: If loading binary data, a handy reference: http://www.html5rocks.com/en/tutorials/file/xhr2/\r\n\t\t* @param {object} options Object containing required settings. The only required option is 'url' <br />\r\n\t\t* <b>url</b> <i>{string}</i> (Required) The URL to load\r\n\t\t* <b>method</b> <i>{string: \"get\"}</i> Load the URL via either get or post\r\n\t\t* <b>success</b> <i>{function}</i> A method to call when the URL has been successfully loaded\r\n\t\t* <b>error</b> <i>{function}</i>  A method to call when an error occurs after attempting to load the URL\r\n\t\t* <b>dataType</b> <i>{string}</i> The type of data that will be loaded: \"text\", json\", \"jsonp\", \"script\", \"arraybuffer\", \"blob\", or \"document\"\r\n\t\t* <b>data</b> <i>{string/object}</i> Data to send to the server as part of the request. Either a query string or an object of key/value pairs\r\n\t\t* <b>id</b> <i>{string}</i> A unique ID to attach to script loads. Allows author to check document if a script has already loaded before loading it.\r\n\t\t* <b>contentType</b> <i>{string} Override the content type sent to the server in the request's header\r\n\t\t* <b>progress</b> <i>{function}</i> A method to call when load progress occurs. The method will receive a percentage between 0 and 1 representing progress. Only called in IE10+ and modren browsers\r\n\t\t*/\r\n\t\tUtils.prototype.ajax = function(options) {\r\n\t\t\t// First make sure the options argument is a valid object.\r\n\t\t\tif (!options || options !== Object(options)) {\r\n\t\t\t\tthrow new Error(this.ERROR_INVALID_OPTIONS);\r\n\t\t\t}\r\n\t\t\t// The URL option is mandatory, so throw an error if this is missing\r\n\t\t\tif (!options.url) {\r\n\t\t\t\tthrow new Error(this.ERROR_UNDEFINED_URL);\r\n\t\t\t}\r\n\t\t\t// Set default values if options are passed in\r\n\t\t\toptions.method = options.method || \"GET\";\r\n\t\t\toptions.dataType = options.dataType || \"text\";\r\n\t\t\t// Decide which load method is required based on the type of data expected back\r\n\t\t\tif (options.dataType === \"jsonp\" || options.dataType === \"script\") {\r\n\t\t\t\t// Load via the script tag\r\n\t\t\t\tthis.loadScript(options);\r\n\t\t\t} else {\r\n\t\t\t\t// Load via XMLHttpRequest\r\n\t\t\t\tthis.createRequest(options);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Dynamically generate a namespace from a string\r\n\t\t* @param {string} namespace A namespace string separated by periods\r\n\t\t*/\r\n\t\tUtils.prototype.createNamespace = function(namespace) {\r\n\t\t\t// Split the passed string into an array separated by periods\r\n\t\t\tvar parts = namespace.split(\".\"), currentPart = \"\", i = 0, length = parts.length;\r\n\t\t\t// Created objects are nested, starting with the window object\r\n\t\t\tvar parentObject = window;\r\n\t\t\tfor (; i < length; i++) {\r\n\t\t\t\t// Reference to the current string in the array\r\n\t\t\t\tcurrentPart = parts[i];\r\n\t\t\t\t// Create a new object for this part if one didn't already exist\r\n\t\t\t\tparentObject[currentPart] = parentObject[currentPart] || {};\r\n\t\t\t\t// The next object will be a decendant of this one\r\n\t\t\t\tparentObject = parentObject[currentPart];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Returns the position of an element relative to the top left of the whole page\r\n\t\t* @param {domelement} element The element to find the position of, relative to the document root\r\n\t\t*/\r\n\t\tUtils.prototype.getOffset = function(element) {\r\n\t\t\tvar bounds = element.getBoundingClientRect();\r\n\t\t\treturn {\r\n\t\t\t\ttop: bounds.top + window.pageYOffset - (document.documentElement.clientTop || 0),\r\n\t\t\t\tleft: bounds.left + window.pageXOffset - (document.documentElement.clientLeft || 0)\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Returns the position of an element relative to it's nearest positioned parent\r\n\t\t* @param {domelement} element The element to find the position of, relative to it's nearest positioned parent\r\n\t\t*/\r\n\t\tUtils.prototype.getPosition = function(element) {\r\n\t\t\treturn {\r\n\t\t\t\ttop: element.offsetTop,\r\n\t\t\t\tleft: element.offsetLeft\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Get the value of a style currently on an element\r\n\t\t* @param {domelement} element The element that has the style in question\r\n\t\t* @param {string} property The name of the property style who's value is returned\r\n\t\t* @param {boolean} preventCompute Set to true to return the style as originally defined in the stylesheet. Note that as this temporarily hides the element, it is more than a little abusive, so leave false if you can manage with the computed value\r\n\t\t*/\r\n\t\tUtils.prototype.getStyle = function(element, property, preventCompute) {\r\n\t\t\tvar value = 0;\r\n\t\t\tif (property === \"float\") property = \"cssFloat\";\r\n\t\t\tproperty = this.getPrefixedName(property);\r\n\t\t\tif (!preventCompute) {\r\n\t\t\t\tvalue = window.getComputedStyle(element, null)[property];\r\n\t\t\t\tif (value.search(/px|%|em|rem|vh|vw|vmin|vmax|ex|ch/g) > -1) {\r\n\t\t\t\t\tvalue = parseInt(value, 10);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tvar originalDisplay = window.getComputedStyle(element, null)[\"display\"];\r\n\t\t\t\tvar hadStyleApplied = (element.style.display != false);\r\n\t\t\t\telement.style.display = \"none\";\r\n\t\t\t\tvalue = window.getComputedStyle(element, null)[property];\r\n\t\t\t\tif (hadStyleApplied) {\r\n\t\t\t\t\telement.style.display = originalDisplay;\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.style.removeProperty(\"display\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn value || \"\";\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Set one or more styles on an element\r\n\t\t* @param {domelement} element The DOM element to apply the new styles to\r\n\t\t* @param {object} styles An object of key-value pairs stating each new style's name and it's new value\r\n\t\t*/\r\n\t\tUtils.prototype.setStyle = function(element, styles) {\r\n\t\t\tvar parsedProp = \"\";\r\n\t\t\tfor (var prop in styles) {\r\n\t\t\t\tparsedProp = this.getPrefixedName(prop);\r\n\t\t\t\t// If the value after being converted to an int matches the passed value, and this isn't a unitless CSS attribute\r\n\t\t\t\tif (parseInt(styles[prop], 10) == styles[prop] && prop.search(/opacity|margin|z-index|zIndex|font-weight|fontWeight|line-height|lineHeight|counter-reset|counterReset|counter-increment|counterIncrement|volume|stress|pitch-range|pitchRange|richness/g) < 0) {\r\n\t\t\t\t\t// This was a pure number, and should be converted to pixels\r\n\t\t\t\t\tstyles[prop] += \"px\";\r\n\t\t\t\t}\r\n\t\t\t\tif (element.length) {\r\n\t\t\t\t\tfor (var i = 0, length = element.length; i < length; i++) {\r\n\t\t\t\t\t\telement[i].style[parsedProp] = styles[prop];\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.style[parsedProp] = styles[prop];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Get a cookie value by name\r\n\t\t* @param {string} cookieName The name of the cookie to find a value for\r\n\t\t*/\r\n\t\tUtils.prototype.getCookie = function(cookieName) {\r\n\t\t\tvar cookieArray = document.cookie.split(\"; \");\r\n\t\t\tvar cookies = {}, i = cookieArray.length-1, cookieValue = \"\";\r\n\t\t\tfor (; i >= 0; i--) {\r\n\t\t\t\tcookieValue = cookieArray[i].split(\"=\");\r\n\t\t\t\tcookies[cookieValue[0]] = cookieValue[1];\r\n\t\t\t}\r\n\t\t\treturn cookies[cookieName];\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Set a new cookie for the current domain\r\n\t\t* @param {string} cookieName The name of the new cookie\r\n\t\t* @param {string} cookieValue The value the new cookie should contain\r\n\t\t* @param {string} days Optional cookie duration, in days. If left blank, the cookie will act as a session cookie\r\n\t\t*/\r\n\t\tUtils.prototype.setCookie = function(cookieName, cookieValue, days) {\r\n\t\t\tvar expires = \"\";\r\n\t\t\tif (days) {\r\n\t\t\t\t// Create a new date object\r\n\t\t\t\tvar date = new Date();\r\n\t\t\t\t// Set the time to X days ahead of the current time\r\n\t\t\t\tdate.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\r\n\t\t\t\t// Store the new expirey string for later\r\n\t\t\t\texpires = \"; expires=\" + date.toGMTString();\r\n\t\t\t}\r\n\t\t\t// Create the new cookie string and set it as a cookie\r\n\t\t\tdocument.cookie = cookieName + \"=\" + cookieValue + expires + \";path=/\";\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Get the main element that can scroll the whole page\r\n\t\t* @return {domelement} The element that can control the scroll position of the whole page\r\n\t\t*/\r\n\t\tUtils.prototype.getPageElement = function() {\r\n\t\t\tif (!this.pageElement) {\r\n\t\t\t\t// Get the current scroll position\r\n\t\t\t\tvar startY = window.pageYOffset || document.body.scrollTop;\r\n\t\t\t\t// Calculate a test scroll (1px lower than current)\r\n\t\t\t\tvar testY = startY + 1;\r\n\t\t\t\t// Scroll the page to that test value\r\n\t\t\t\twindow.scrollTo(0, testY);\r\n\t\t\t\t// Work out which element changed position - that's the scrollable element\r\n\t\t\t\tthis.pageElement = (document.documentElement.scrollTop === testY) ? document.documentElement : document.body;\r\n\t\t\t\t// Reset the scroll position back to where it was\r\n\t\t\t\twindow.scrollTo(0, startY);\r\n\t\t\t\t// Return the scrollable element\r\n\t\t\t}\r\n\t\t\treturn this.pageElement;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Check if an element supports a particular event\r\n\t\t* Via Modernizer and http://perfectionkills.com/detecting-event-support-without-browser-sniffing/\r\n\t\t* @param {string} eventName The name of the event to check exists\r\n\t\t* @param {domelement_or_string} element The element that may contain the event. If set as a string, eg. \"span\", the element matching the string will be created. Leave out to just test a standard div\r\n\t\t*/\r\n\t\tUtils.prototype.isEventSupported = function(eventName, element) {\r\n\t\t\tvar supported = false;\r\n\t\t\tvar fallbackRequired = !(\"onblur\" in document.documentElement);\r\n\t\t\t// If no event name was passed in, the result will always be false\r\n\t\t\tif (!eventName) return false;\r\n\t\t\tif (eventName === \"hover\") eventName = \"mouseover\";\r\n\t\t\t// Ensure there is a valid element to test\r\n\t\t\tif (!element) {\r\n\t\t\t\telement = this.testElement;\r\n\t\t\t} else if (typeof element === \"string\") {\r\n\t\t\t\telement = document.createElement(element);\r\n\t\t\t}\r\n\t\t\t// Append \"on\" as the method on the element will be named in this style\r\n\t\t\teventName = \"on\" + eventName.toLowerCase();\r\n\t\t\tsupported = eventName in element;\r\n\t\t\t// If user is using an old version of Firefox, we need a different approach\r\n\t\t\tif (!supported && fallbackRequired) {\r\n\t\t\t\t// Ensure the element in play actually has the setAttribute method\r\n\t\t\t\tif (!element.setAttribute) element = document.createElement(\"div\");\r\n\t\t\t\t// Set the event name on the element. This will coax old FF into creating a function for a known event\r\n\t\t\t\telement.setAttribute(eventName, \"\");\r\n\t\t\t\t// Check if the funciton was created. If it was, the event is known and supported\r\n\t\t\t\tsupported = typeof element[eventName] === \"function\";\r\n\t\t\t\t// Cleanup the dummy function\r\n\t\t\t\tif (element[eventName] !== undefined) element[eventName] = undefined;\r\n\t\t\t\telement.removeAttribute(eventName);\r\n\t\t\t}\r\n\t\t\treturn supported;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Serialise form data\r\n\t\t* @param {domelement} formElement The form element containing fields to serialise\r\n\t\t*/\r\n\t\tUtils.prototype.serializeForm = function(formElement) {\r\n\t\t\tvar field, values = [];\r\n\t\t\t// Ensure passed element is actually a form\r\n\t\t\tif (typeof formElement === \"object\" && formElement.nodeName === \"FORM\") {\r\n\t\t\t\t// Loop through child elements for the form element\r\n\t\t\t\tvar length = formElement.elements.length, i = 0, j = 0;\r\n\t\t\t\tfor (; i < length; i++) {\r\n\t\t\t\t\t// Store reference to this field\r\n\t\t\t\t\tfield = formElement.elements[i];\r\n\t\t\t\t\t// Only process the field if it is a parsable type, and isn't disabled\r\n\t\t\t\t\tif (field.name && !field.disabled && field.type.toString().indexOf(/file|reset|submit|button/i) < 0) {\r\n\t\t\t\t\t\t// If the field can have multiple values, we need to step through them\r\n\t\t\t\t\t\tif (field.type === \"select-multiple\") {\r\n\t\t\t\t\t\t\t// For each value in the field\r\n\t\t\t\t\t\t\tfor (j = field.length-1; j >= 0; j--) {\r\n\t\t\t\t\t\t\t\t// If this value has been selected\r\n\t\t\t\t\t\t\t\tif (fieldElement.options[j].selected) {\r\n\t\t\t\t\t\t\t\t\t// Add the new value to the array\r\n\t\t\t\t\t\t\t\t\tvalues[values.length] = encodeURIComponent(field.name) + \"=\" + encodeURIComponentfield.options[j].value;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (field.type.toString().indexOf(/checkbox|radio/i) < 0 || field.checked) {\r\n\t\t\t\t\t\t\t// If this isn't a checkbox/radio button, or if it is and it has been checked, add this value to the array\r\n\t\t\t\t\t\t\tvalues[values.length] = encodeURIComponent(field.name) + \"=\" + encodeURIComponent(field.value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Convert the array to a string separated by ampersands\r\n\t\t\treturn values.join(\"&\").replace(/%20/g, \"+\");\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Get actual DOM element from a selector\r\n\t\t* @param {domelement_or_string_or_jQuery object} selector A selector string, DOM element, or jQuery object from which to return a matching DOM element\r\n\t\t*/\r\n\t\tUtils.prototype.getDOMElement = function(selector) {\r\n\t\t\t// If a selector string was passed in, find it in the DOM and return the result\r\n\t\t\tif (typeof selector === \"string\") return document.querySelector(selector);\r\n\t\t\t// If jQuery is present and the selector was a jQuery object, return the native DOM element from that\r\n\t\t\tif (typeof jQuery !== \"undefined\" && selector instanceof jQuery) {\r\n\t\t\t\treturn jQuery(selector)[0];\r\n\t\t\t} else {\r\n\t\t\t\t// Otherwise, just return the selector directly as the DOM element\r\n\t\t\t\treturn selector;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Return a version of the passed property name that is supported by the current browser\r\n\t\t* This will either be the one passed in, or a prefixed version of it\r\n\t\t* @param {string} propertyName The name of the style that may require a prefix before it works\r\n\t\t*/\r\n\t\tUtils.prototype.getPrefixedName = function(propertyName) {\r\n\t\t\tvar prefixes = [\"webkit\", \"Moz\", \"ms\", \"moz\"];\r\n\t\t\tvar i = 0, length = prefixes.length, jsName = propertyName;\r\n\t\t\t// First, get rid of any pre-existing prefix on the passed property name\r\n\t\t\tfor (; i < length; i++) {\r\n\t\t\t\tif (jsName.search(\"-\" + prefixes[i] + \"-\") > -1) {\r\n\t\t\t\t\t// If there was a match for this prefix, remove it so we can generate the right prefix for the current browser\r\n\t\t\t\t\tjsName = jsName.replace(\"-\" + prefixes[i] + \"-\", \"\");\r\n\t\t\t\t\t// Now it is known there's no prefix in the passed propertyName, so no need to continue here\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Check if the existing property name works in this browser\r\n\t\t\tif (this.testElement.style[jsName] !== undefined || (jsName === \"scrollLeft\" || jsName === \"scrollTop\")) {\r\n\t\t\t\t// If so, return it straight back\r\n\t\t\t\treturn jsName;\r\n\t\t\t}\r\n\t\t\t// propertyName isn't natively supported raw, so try adding prefixes\r\n\t\t\t// First convert the first character to uppercase, as this will come after a prefix\r\n\t\t\tjsName = (jsName.charAt(0).toUpperCase() + jsName.slice(1));\r\n\t\t\t// Also replace any dashes followed by a letter with just the uppercased letter\r\n\t\t\tjsName = this.camelcaseString(jsName, true, true);\r\n\t\t\tfor (i = 0; i < length; i++) {\r\n\t\t\t\t// If this prefixed name was found on the style object, it's supported\r\n\t\t\t\tif (this.testElement.style[prefixes[i] + jsName] !== undefined) {\r\n\t\t\t\t\t// Return the prefixed property name as it appears on the style object\r\n\t\t\t\t\treturn prefixes[i] + jsName;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Throw an error here, as otherwise the author will get all sorts of mysterious errors otherwise\r\n\t\t\tif (propertyName != \"transition\") throw new Error(this.ERROR_UNSUPPORTED_STYLE.replace(\"{{property}}\", propertyName));\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Convert a passed string to camelcase format\r\n\t\t* @param {string} value The string to camelcase\r\n\t\t* @param {boolean} jsProperty True if value should be treated as a code property (remove dashes and uppercase the letter that follows one)\r\n\t\t* @param {boolean} upperFirstChat True if the first character should always be uppercase (overrides jsProperty, when true, so that the first character is uppercase)\r\n\t\t*/\r\n\t\tUtils.prototype.camelcaseString = function(value, jsProperty, upperFirstChar) {\r\n\t\t\tif (!jsProperty) {\r\n\t\t\t\t// Standard camelcasing\r\n\t\t\t\treturn value.replace(/(?:^\\w|[A-Z]|\\b\\w|)/g, function(match, index) {\r\n\t\t\t\t\tif (+match === 0) return \"\";\r\n\t\t\t\t\treturn match.toUpperCase();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t// Replace a dash followed by a letter with just an uppercase letter\r\n\t\t\t\tvalue = value.replace(/\\-[a-zA-Z]|\\s[a-zA-Z]|\\s+/g, function(match, index) {\r\n\t\t\t\t\treturn match.replace(/-|\\s/g, \"\").toUpperCase();\r\n\t\t\t\t});\r\n\t\t\t\tif (!upperFirstChar) {\r\n\t\t\t\t\tvalue = value.charAt(0).toLowerCase() + value.substring(1);\r\n\t\t\t\t}\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Error strings\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tUtils.prototype.ERROR_INVALID_OPTIONS = \"NATION.Utils: ajax argument 'options' is not a valid object\";\r\n\t\tUtils.prototype.ERROR_UNDEFINED_URL = \"NATION.Utils: ajax argument 'options.url' is undefined\";\r\n\t\tUtils.prototype.ERROR_INVALID_DATA = \"Nation.Utils: ajax argument 'options.data' must be either a querystring or an object consisting of key/value pairs\";\r\n\t\tUtils.prototype.ERROR_REQUEST_FAILED = \"NATION.Utils: ajax load failed wth error code '{{status}}' and response '{{response}}'\";\r\n\t\tUtils.prototype.ERROR_UNSUPPORTED_STYLE = \"NATION.Utils: This browser does not support the CSS property '{{property}}'\";\r\n\r\n\t\t/**\r\n\t\t* Ensures data is in query string format\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tUtils.prototype.prepareRequestData = function(data) {\r\n\t\t\tif (typeof data !== \"string\") {\r\n\t\t\t\t// If options.data wasn't a string, and isn't an object, throw an error\r\n\t\t\t\tif (data !== Object(data)) {\r\n\t\t\t\t\tthrow new Error(this.ERROR_INVALID_DATA);\r\n\t\t\t\t}\r\n\t\t\t\t// Convert the object to a valid query string\r\n\t\t\t\tdata = this.objectToQueryString(data);\r\n\t\t\t}\r\n\t\t\treturn data;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Load data via the script tag\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tUtils.prototype.loadScript = function(options) {\r\n\t\t\t// Create script element used to load this URL\r\n\t\t\tvar scriptTag = document.createElement(\"script\");\r\n\t\t\t// If the id option was populated, apply it to the script tag\r\n\t\t\tif (options.id) {\r\n\t\t\t\tscriptTag.setAttribute(\"id\", options.id);\r\n\t\t\t}\r\n\t\t\t// Create a new request ID for this script\r\n\t\t\tif (options.dataType === \"jsonp\") options.id = this.requestID = this.requestID + 1;\r\n\t\t\t// If a query string doesn't already exist, start one\r\n\t\t\tif (options.url.indexOf(\"?\") < 0) options.url += \"?\";\r\n\t\t\t// If the ? isn't right at the end of the string, that means there is already a query string there\r\n\t\t\t// So an ampersand is needed to continue the chain\r\n\t\t\tif (options.url.indexOf(\"?\") !== options.url.length-1) options.url += \"&\";\r\n\t\t\tif (options.data) {\r\n\t\t\t\t// Make sure the passed data is a query string\r\n\t\t\t\toptions.data = this.prepareRequestData(options.data);\r\n\t\t\t\t// Add the data to the url in query string format\r\n\t\t\t\toptions.url += options.data;\r\n\t\t\t\t// Add an extra ampersand to prepare for the callback argument\r\n\t\t\t\tif (options.dataType === \"jsonp\") options.url += \"&\";\r\n\t\t\t}\r\n\t\t\tif (options.success && options.dataType !== \"jsonp\") {\r\n\t\t\t\tscriptTag.addEventListener(\"load\", options.success);\r\n\t\t\t}\r\n\t\t\t// Add the callback name to the query string\r\n\t\t\tif (options.dataType === \"jsonp\") options.url += \"callback=NATION.jsonpCallback\" + options.id;\r\n\t\t\t\r\n\t\t\t// Create a callback if request is a JSONP request\r\n\t\t\tif (options.dataType === \"jsonp\") {\r\n\t\t\t\t// Create a dynamically named method to keep the callback reference unique\r\n\t\t\t\tNATION[\"jsonpCallback\" + options.id] = function(response) {\r\n\t\t\t\t\t// Make sure the response was actually a JSON object, then parse it\r\n\t\t\t\t\tif (response[0] === \"{\") response = JSON.parse(response); \r\n\t\t\t\t\t// Call the success method, assuming one exists\r\n\t\t\t\t\tif (options.success) options.success(response);\r\n\t\t\t\t\t// Remove the original script tag from the DOM, since it's no longer required\r\n\t\t\t\t\t// This is only done as this is a JSONP load - normal script tags remain in place\r\n\t\t\t\t\tdocument.getElementsByTagName(\"body\")[0].removeChild(scriptTag);\r\n\t\t\t\t\t// Delete the callback method, as it's no longer needed\r\n\t\t\t\t\tdelete NATION[\"jsonpCallback\" + options.id];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Set the script tag source with the final url\r\n\t\t\tscriptTag.setAttribute(\"src\", options.url);\r\n\t\t\t// Add the completed tag to the page\r\n\t\t\tdocument.getElementsByTagName(\"body\")[0].appendChild(scriptTag);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Handle potential errors in XMLHttpRequest calls\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tUtils.prototype.handleRequestError = function(request, options) {\r\n\t\t\tif (!request.status || (request.status !== 200 && request.status !== 304)) {\r\n\t\t\t\tif (options.error) {\r\n\t\t\t\t\toptions.error(request.status, request.statusText);\r\n\t\t\t\t} else if (console && console.warn) {\r\n\t\t\t\t\t// Otherwise if console.warn is available, show the error information there\r\n\t\t\t\t\tconsole.warn(this.ERROR_REQUEST_FAILED.replace(\"{{status}}\", request.status).replace(\"{{response}}\", request.response));\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Load data using XMLHttpRequest\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tUtils.prototype.createRequest = function(options) {\r\n\t\t\t// Instantiate XMLHttpRequest object\r\n\t\t\tvar request = new XMLHttpRequest();\r\n\t\t\trequest.open(options.method, options.url, true);\r\n\t\t\t// Convert the passed data to a query string if required\r\n\t\t\tif (options.data) {\r\n\t\t\t\toptions.data = this.prepareRequestData(options.data);\r\n\t\t\t\t// Set the content type header, since this request is sending data\r\n\t\t\t\tif (!options.contentType) options.contentType = \"application/x-www-form-urlencoded; charset=UTF-8\";\r\n\t\t\t\trequest.setRequestHeader(\"Content-type\", options.contentType);\r\n\t\t\t}\r\n\t\t\tvar binaryRequested = (options.dataType.indexOf(/text|arraybuffer|blob|document/i) > -1);\r\n\t\t\tvar scope = this;\r\n\t\t\t// Handle request state changes\r\n\t\t\tif (request.upload) {\r\n\t\t\t\t// XMLHttpRequest level 2 supported\r\n\t\t\t\tif (binaryRequested) {\r\n\t\t\t\t\t// Set the response type of the request to a binary format if required\r\n\t\t\t\t\trequest.responseType = options.dataType;\r\n\t\t\t\t}\r\n\t\t\t\trequest.addEventListener(\"load\", function(e) {\r\n\t\t\t\t\t// If the result was something other than a success, handle the error\r\n\t\t\t\t\tif (scope.handleRequestError(request, options)) {\r\n\t\t\t\t\t\t// Stop executing this method\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar response = request.responseText;\r\n\t\t\t\t\t// Check the loaded data and handle it appropriately\r\n\t\t\t\t\tif (binaryRequested) {\r\n\t\t\t\t\t\t// Don't touch the response, since some form of binary data was requested\r\n\t\t\t\t\t\tresponse = request.response;\r\n\t\t\t\t\t} else if (options.dataType === \"json\" && response[0] === \"{\") {\r\n\t\t\t\t\t\t// Parse the response as json if required\r\n\t\t\t\t\t\tresponse = JSON.parse(response);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Call the success method with the response\r\n\t\t\t\t\tif (options.success) options.success(response);\r\n\t\t\t\t});\r\n\t\t\t\trequest.addEventListener(\"error\", function(e) {\r\n\t\t\t\t\t// If the URL couldn't be loaded, handle the error\r\n\t\t\t\t\tscope.handleRequestError(request, options);\r\n\t\t\t\t});\r\n\t\t\t\tif (options.progress) {\r\n\t\t\t\t\t// If a progress callback was in options, listen for progress events\r\n\t\t\t\t\trequest.addEventListener(\"progress\", function(e) {\r\n\t\t\t\t\t\t// If a percentage can be calculated\r\n\t\t\t\t\t\tif (e.lengthComputable) {\r\n\t\t\t\t\t\t\t// call the progress callback with the updated load percentage\r\n\t\t\t\t\t\t\toptions.progress(e.loaded/e.total);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// XMLHttpRequest level 1 supported. This will be depreciated when IE9 support drops out.\r\n\t\t\t\tif (binaryRequested) {\r\n\t\t\t\t\t// Hack to pass byte data through unprocessed\r\n\t\t\t\t\trequest.overrideMimeType('text/plain; charset=x-user-defined');\r\n\t\t\t\t}\r\n\t\t\t\trequest.onreadystatechange = function() {\r\n\t\t\t\t\t// Do nothing if the request has not yet completed\r\n\t\t\t\t\tif (request.readyState !== 4) return;\r\n\t\t\t\t\t// If the result was something other than a success, handle the error\r\n\t\t\t\t\tif (scope.handleRequestError(request, options)) {\r\n\t\t\t\t\t\t// Stop executing this method\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Parse the response as json if required\r\n\t\t\t\t\tvar response = request.responseText;\r\n\t\t\t\t\tif (options.dataType === \"json\" && response[0] === \"{\") response = JSON.parse(response); \r\n\t\t\t\t\t// Call the success method with the response\r\n\t\t\t\t\tif (options.success) options.success(response);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Send the request to the server\r\n\t\t\trequest.send(options.data);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* Converts an object to a valid query string\r\n\t\t* @ignore\r\n\t\t*/\r\n\t\tUtils.prototype.objectToQueryString = function(data) {\r\n\t\t\t// Loop through each value in the data object\r\n\t\t\treturn Object.keys(data).map(function(key) {\r\n\t\t\t\t// This value was an array, so join those values together\r\n\t\t\t\tif (typeof data[key] === \"Array\") {\r\n\t\t\t\t\tdata[key] = data[key].join(\"&\");\r\n\t\t\t\t}\r\n\t\t\t\t// Return the new key/value as part of the string\r\n\t\t\t\treturn encodeURIComponent(key) + \"=\" + encodeURIComponent(data[key]);\r\n\t\t\t}).join(\"&\");\r\n\t\t}\r\n\r\n\t\twindow.NATION.Utils = new Utils();\r\n\t}\r\n\r\n\t// requestAnimationFrame polyfill\r\n\t// Will be removed when IE9 support is dropped\r\n\tif (!window.requestAnimationFrame) {\r\n\t\tvar lastTime = 0;\r\n\t\twindow.requestAnimationFrame = function(callback, element) {\r\n\t\t\tvar currentTime = Date.now();\r\n\t\t\tvar timeToCall = Math.max(0, 16 - Math.abs(currentTime - lastTime));\r\n\t\t\tvar id = window.setTimeout(function() {callback(currentTime + timeToCall); }, timeToCall);\r\n\t\t\tlastTime = currentTime + timeToCall;\r\n\t\t\treturn id;\r\n\t\t}\r\n\t}\r\n\tif (!window.cancelAnimationFrame) {\r\n\t\twindow.cancelAnimationFrame = function(id) {\r\n\t\t\tclearTimeout(id);\r\n\t\t}\r\n\t}\r\n\r\n}(window, document, undefined));","////////////////////////////////////////////////////////////////////////////////\r\n// Syrup Sounds Website\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nclass Application {\r\n\r\n\t//------------------------------------------------\r\n\t// Constructor \r\n\t//------------------------------------------------\r\n\tconstructor() {\r\n\t\t// Variables\r\n\t\tthis.DOMElement = document.documentElement;\r\n\t\tthis.siteBackground = null;\r\n\t\t// Initialisation\r\n\t\tthis.prepareDOM();\r\n\t\tthis.createSiteOptions();\r\n\t\tthis.createBackground();\r\n\t\tthis.createListeners();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tcreateSiteOptions() {\r\n\t\tthis.siteOptions = new SiteOptions(this.DOMElement.querySelector(\".options\"));\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Add a class to the main DOM element if the user\r\n\t// is using Firefox\r\n\t//------------------------------------------------\r\n\tprepareDOM() {\r\n\t\tif (navigator.userAgent.toLowerCase().indexOf('firefox') > -1) {\r\n\t\t\tthis.DOMElement.className += \" firefox\";\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Create the background that contains the main horizontal\r\n\t// lines, and all of the shape systems (1 per section)\r\n\t//------------------------------------------------\r\n\tcreateBackground() {\r\n\t\tthis.siteBackground = new SiteBackground(this.DOMElement.querySelector(\".site-background\"));\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Listen for state changes in the application\r\n\t//------------------------------------------------\r\n\tcreateListeners() {\r\n\t\t// Debug modes\r\n\t\tthis.siteOptions.addListener(Events.ENABLE_DEBUG_MODE, (e) => this.enableDebugMode(e));\r\n\t\tthis.siteOptions.addListener(Events.DISABLE_DEBUG_MODE, (e) => this.disableDebugMode(e));\r\n\t\tthis.siteOptions.addListener(Events.RANDOMISE_BACKGROUND_LINES, (e) => this.randomiseBackgroundLines(e));\r\n\t\tthis.siteOptions.addListener(Events.RANDOMISE_SHAPES, (e) => this.randomiseShapes(e));\r\n\t\tthis.siteOptions.addListener(Events.RANDOMISE_ALL, (e) => this.randomiseAllShapes(e));\r\n\t\tthis.siteOptions.addListener(Events.SHOW_ONLY_CORNERS, (e) => this.showOnlyCorners(e));\r\n\t\tthis.siteOptions.addListener(Events.SHOW_ONLY_ARCS, (e) => this.showOnlyArcs(e));\r\n\t\tthis.siteOptions.addListener(Events.SHOW_ONLY_TRIANGLES, (e) => this.showOnlyTriangles(e));\r\n\t\tthis.siteOptions.addListener(Events.SHOW_ONLY_LINES, (e) => this.showOnlyLines(e));\r\n\t\tthis.siteOptions.addListener(Events.SHOW_ONLY_CIRCLES, (e) => this.showOnlyCircles(e));\r\n\t\tthis.siteOptions.addListener(Events.SHOW_ALL_SHAPES, (e) => this.showAllShapes(e));\r\n\t\tthis.siteOptions.addListener(Events.UPDATE_SHAPE_SPEEDS, (e) => this.updateShapeSpeeds(e));\r\n\t\tthis.siteOptions.addListener(Events.SCALE_CHANGE_REQUESTED, (e) => this.changeScale(e));\r\n\t}\r\n\r\n\tchangeScale(e) {\r\n\t\tthis.siteBackground.overrideScale(this.siteOptions.requestedScale);\r\n\t}\r\n\r\n\tupdateShapeSpeeds(e) {\r\n\t\tthis.siteBackground.updateShapeSpeeds();\r\n\t}\r\n\r\n\tshowOnlyCorners(e) {\r\n\t\tthis.siteBackground.showOnlyCorners();\r\n\t}\r\n\r\n\tshowOnlyArcs(e) {\r\n\t\tthis.siteBackground.showOnlyArcs();\r\n\t}\r\n\r\n\tshowOnlyTriangles(e) {\r\n\t\tthis.siteBackground.showOnlyTriangles();\r\n\t}\r\n\r\n\tshowOnlyLines(e) {\r\n\t\tthis.siteBackground.showOnlyLines();\r\n\t}\r\n\r\n\tshowOnlyCircles(e) {\r\n\t\tthis.siteBackground.showOnlyCircles();\r\n\t}\r\n\r\n\tshowAllShapes(e) {\r\n\t\tthis.siteBackground.showAllShapes();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tenableDebugMode(e) {\r\n\t\tif (!this.debugEnabled) {\r\n\t\t\tthis.debugEnabled = true;\r\n\t\t\tMediator.publish(Events.ENABLE_DEBUG_MODE);\r\n\t\t} \r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tdisableDebugMode(e) {\r\n\t\tif (this.debugEnabled) {\r\n\t\t\tthis.debugEnabled = false;\r\n\t\t\tMediator.publish(Events.DISABLE_DEBUG_MODE);\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\trandomiseBackgroundLines(e) {\r\n\t\tthis.siteBackground.randomiseBackgroundLines();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\trandomiseShapes(e) {\r\n\t\tthis.siteBackground.randomiseShapes();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\trandomiseAllShapes(e) {\r\n\t\tthis.siteBackground.randomiseAll();\r\n\t}\r\n}\r\n\r\n\r\nwindow.onload = function() {\r\n\t// Yeah it's a global, come at me\r\n\twindow.Settings = new SiteSettings();\r\n\twindow.Mediator = new SiteMediator();\r\n\tlet app = new Application();\r\n}","////////////////////////////////////////////////////////////////////////////////\r\n// Syrup Sounds Website\r\n// \r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nclass SiteMediator {\r\n\r\n\t//------------------------------------------------\r\n\t// Constructor\r\n\t//------------------------------------------------\r\n\tconstructor() {\r\n\t\t// Variables\r\n\t\tthis.channels = {};\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Add a new listener to a global event\r\n\t//------------------------------------------------\r\n\tsubscribe(eventName, callback) {\r\n\t\tif (!this.channels[eventName]) this.channels[eventName] = [];\r\n\t\tthis.channels[eventName].push({callback: callback});\r\n\t\treturn this;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Notify all listeners of the new event\r\n\t//------------------------------------------------\r\n\tpublish(eventName, data) {\r\n\t\tif (!this.channels[eventName]) return false;\r\n\t\tlet i = 0, length = this.channels[eventName].length, subscription;\r\n\t\tfor (; i < length; i++) {\r\n\t\t\tsubscription = this.channels[eventName][i];\r\n\t\t\tsubscription.callback(data);\r\n\t\t}\r\n\t}\r\n}","////////////////////////////////////////////////////////////////////////////////\r\n// Syrup Sounds Website\r\n// Main Site Background Lines\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nclass BackgroundLines {\r\n\r\n\t//------------------------------------------------\r\n\t// Constructor\r\n\t//------------------------------------------------\r\n\tconstructor(DOMElement, totalSections, strokeWidth) {\r\n\t\t// Variables\r\n\t\tthis.DOMElement = DOMElement;\r\n\t\tthis.totalSections = totalSections;\r\n\t\tthis.currentScale = 1;\r\n\t\tthis.lineData = [];\r\n\t\tthis.lineStyles = [\"straight\", \"curve\"];\r\n\t\tthis.lineElements = [];\r\n\t\tthis.strokeWidth = strokeWidth;\r\n\t\tthis.totalLines = 5;\r\n\t\tthis.pathStrings = [];\r\n\t\tthis.collisionPoints = [];\r\n\t\tthis.lineSegments = [];\r\n\t\tthis.collisionGuide = null;\r\n\t\tthis.COLOR = \"#00eac4\";\r\n\t\tthis.MIN_LINE_WIDTH = 400;\r\n\t\tthis.guideLines = [];\r\n\t\tthis.guideCircles = [];\r\n\t\tthis.fadedLines = 0;\r\n\t\tthis.collisionLineVisible = false;\r\n\t\tthis.createLineElement();\r\n\t\tthis.decideLineTypes();\r\n\t\tthis.createCollisionGuide();\r\n\t\tthis.draw();\r\n\t\tthis.createListeners();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\trandomise() {\r\n\t\t// First remove old elements\r\n\t\tif (this.collisionLineVisible) {\r\n\t\t\t//this.DOMElement.removeChild(this.collisionGuide);\r\n\t\t\t//this.hideCollisionModel();\r\n\t\t} else {\r\n\t\t\t\r\n\t\t}\r\n\t\t// Then create new elements\r\n\t\tthis.decideLineTypes();\r\n\t\t//this.createCollisionGuide();\r\n\t\tthis.draw();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Listen for requests for the debug menu\r\n\t//------------------------------------------------\r\n\tcreateListeners() {\r\n\t\tMediator.subscribe(Events.ENABLE_DEBUG_MODE, (data) => this.showCollisionModel(data));\r\n\t\tMediator.subscribe(Events.DISABLE_DEBUG_MODE, (data) => this.hideCollisionModel(data));\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Start rendering the collision model\r\n\t//------------------------------------------------\r\n\tshowCollisionModel(data) {\r\n\t\tthis.collisionLineVisible = true;\r\n\t\tthis.DOMElement.appendChild(this.collisionGuide);\r\n\t\tfor (let i = 0, length = this.lineElements.length; i < length; i++) {\r\n\t\t\tthis.lineElements[i].setAttribute(\"stroke-opacity\", 0);\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Stop rendering the collision model\r\n\t//------------------------------------------------\r\n\thideCollisionModel(data) {\r\n\t\tthis.collisionLineVisible = false;\r\n\t\tthis.DOMElement.removeChild(this.collisionGuide);\r\n\t\tfor (let i = 0, length = this.lineElements.length; i < length; i++) {\r\n\t\t\tthis.lineElements[i].setAttribute(\"stroke-opacity\", 1);\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Returns the collision data for the full background shape\r\n\t//------------------------------------------------\r\n\tgetLineSegments() {\r\n\t\treturn this.lineSegments;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Element that will show the collision data when required\r\n\t//------------------------------------------------\r\n\tcreateCollisionGuide() {\r\n\t\tthis.collisionGuide = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\r\n\t\tthis.collisionGuide.setAttribute(\"fill\", \"transparent\");\r\n\t\tthis.collisionGuide.setAttribute(\"stroke\", \"#000\");\r\n\t\tthis.collisionGuide.setAttribute(\"stroke-width\", 2);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// This creates the element required for each of\r\n\t// the 5 lines, used in the draw() method\r\n\t//------------------------------------------------\r\n\tcreateLineElement() {\r\n\t\tlet lineElement = null;\r\n\t\tfor (let i = 0; i < this.totalLines; i++) {\r\n\t\t\tlineElement = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\r\n\t\t\tlineElement.setAttribute(\"fill\", \"transparent\");\r\n\t\t\tlineElement.setAttribute(\"stroke\", this.COLOR);\r\n\t\t\tlineElement.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\r\n\t\t\tthis.DOMElement.appendChild(lineElement);\r\n\t\t\tthis.lineElements.push(lineElement);\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// This decides the types of line sections across\r\n\t// the whole site, but doesn't actually draw them\r\n\t// Use the draw() method for that\r\n\t//------------------------------------------------\r\n\tdecideLineTypes() {\r\n\t\tthis.calculateWidthOptions();\r\n\t\tthis.calculateYPosOptions();\r\n\t\tlet availableWidth = window.innerWidth;\r\n\t\tthis.lineData = [];\r\n\t\tthis.targetWidth = availableWidth * this.totalSections;\r\n\t\tlet currentWidth = 0, line = {};\r\n\t\tlet consecutiveStraights = 0;\r\n\t\twhile (currentWidth < this.targetWidth) {\r\n\t\t\tline = {};\r\n\t\t\tlet previousLine = this.lineData[this.lineData.length-1];\r\n\t\t\t// Decide on line properties\r\n\t\t\tline.type = this.lineStyles[Math.round(Math.random() * (this.lineStyles.length-1))];\r\n\t\t\tif (line.type === \"curve\") {\r\n\t\t\t\t// Curves should only follow straight lines or other curves\r\n\t\t\t\tif (previousLine && previousLine.type !== \"curve\" && consecutiveStraights <= 0) {\r\n\t\t\t\t\tline.type = \"straight\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tline.widthOption = Math.round(Math.random() * (this.widthOptions.length-1));\r\n\t\t\tline.width =  this.widthOptions[line.widthOption];\r\n\t\t\tif (line.type === \"curve\" && line.width === availableWidth/3) {\r\n\t\t\t\tline.widthOption = 0;\r\n\t\t\t\tline.width = availableWidth/2;\r\n\t\t\t}\r\n\r\n\t\t\tline.x1 = (this.lineData.length === 0) ? 0 : this.lineData[this.lineData.length-1].x2;\r\n\t\t\tline.x2 = (this.lineData.length === 0) ? line.width : line.x1 + line.width;\r\n\t\t\tline.y1Option = (this.lineData.length === 0) ? Math.round(Math.random() * (this.yPositions.length-1)) : this.lineData[this.lineData.length-1].y2Option;\r\n\t\t\tline.y1 = this.yPositions[line.y1Option];\r\n\t\t\tif (previousLine && previousLine.type === \"curve\" && line.type === \"straight\") {\r\n\t\t\t\t// A straight must follow a curve, not a line at an angle\r\n\t\t\t\tline.y2Option = line.y1Option;\r\n\t\t\t\tline.y2 = this.yPositions[line.y2Option];\r\n\t\t\t} else if (consecutiveStraights >= 2) {\r\n\t\t\t\t// We need to force a different Y position, to prevent a constant straight line\r\n\t\t\t\t// First, build an array with positions other than the last one\r\n\t\t\t\tlet differentYPositions = [];\r\n\t\t\t\tfor (let i = 0; i < this.yPositions.length; i++) {\r\n\t\t\t\t\tif (this.yPositions[i] !== line.y1) {\r\n\t\t\t\t\t\tdifferentYPositions.push(this.yPositions[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Then choose one from that new array\r\n\t\t\t\tline.y2Option = Math.round(Math.random() * (differentYPositions.length-1));\r\n\t\t\t\tline.y2 = differentYPositions[line.y2Option];\r\n\t\t\t\t// Reset the straight count\r\n\t\t\t\tconsecutiveStraights = 0;\r\n\t\t\t} else {\r\n\t\t\t\tline.y2Option = Math.round(Math.random() * (this.yPositions.length-1));\r\n\t\t\t\tline.y2 = this.yPositions[line.y2Option];\r\n\t\t\t}\r\n\t\t\tif (line.type === \"straight\" && line.y1 === line.y2) {\r\n\t\t\t\tconsecutiveStraights++;\r\n\t\t\t} else {\r\n\t\t\t\tconsecutiveStraights = 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (line.type === \"curve\" && line.y1 === line.y2) {\r\n\t\t\t\tlet differentYPositions = [];\r\n\t\t\t\tfor (let i = 0; i < this.yPositions.length; i++) {\r\n\t\t\t\t\tif (this.yPositions[i] !== line.y1) {\r\n\t\t\t\t\t\tdifferentYPositions.push(this.yPositions[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Then choose one from that new array\r\n\t\t\t\tline.y2 = differentYPositions[Math.round(Math.random() * (differentYPositions.length-1))];\r\n\t\t\t\t// Figure out which option ID that is\r\n\t\t\t\tfor (let i = 0; i < this.yPositions.length; i++) {\r\n\t\t\t\t\tif (this.yPositions[i] === line.y2) {\r\n\t\t\t\t\t\tline.y2Option = i;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Add this line to the array and update the currently used width\r\n\t\t\tthis.lineData.push(line);\r\n\t\t\tcurrentWidth += line.width;\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Updates the possible y co-ordinates for line\r\n\t// points based on the current browser height\r\n\t//------------------------------------------------\r\n\tcalculateYPosOptions() {\r\n\t\tthis.yPositions = [];\r\n\t\t// Work out y pos options based on current browser dimensions\r\n\t\tlet windowHeight = window.innerHeight;\r\n\t\tthis.yPositions.push(windowHeight);\r\n\t\tthis.yPositions.push(windowHeight*0.75);\r\n\t\tthis.yPositions.push(windowHeight*0.5);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Just creates an array of possible widths for lines\r\n\t// Note that it's expected that window.innerWidth/2\r\n\t// should be the first option, as curves default to\r\n\t// that one if the randomly chosen width was less than that\r\n\t//------------------------------------------------\r\n\tcalculateWidthOptions() {\r\n\t\tlet availableWidth = window.innerWidth;\r\n\t\tthis.widthOptions = [\r\n\t\t\tavailableWidth/2, \r\n\t\t\tavailableWidth/3,\r\n\t\t\tavailableWidth/1.5\r\n\t\t];\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Updates the line widths and y positions respective\r\n\t// to the current browser dimensions. Should be run\r\n\t// whenever the browser is resized, and the lines\r\n\t// should be redrawn afterwards\r\n\t//------------------------------------------------\r\n\tcalculateLineCoordinates() {\r\n\t\tthis.calculateWidthOptions();\r\n\t\tthis.calculateYPosOptions();\r\n\t\tfor (let i = 0, length = this.lineData.length; i < length; i++) {\r\n\t\t\tlet line = this.lineData[i];\r\n\t\t\tline.width =  this.widthOptions[line.widthOption];\r\n\t\t\tlet lineWidth = (line.width < this.MIN_LINE_WIDTH) ? window.innerWidth : line.width;\r\n\t\t\tline.x1 = (i === 0) ? 0 : this.lineData[i-1].x2;\r\n\t\t\tline.x2 = (i === 0) ?lineWidth : line.x1 + lineWidth;\r\n\r\n\t\t\tline.y1 = this.yPositions[line.y1Option];\r\n\t\t\tline.y2 = this.yPositions[line.y2Option];\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Works out where two lines overlap, or returns\r\n\t// false if they don't (or are parallel)\r\n\t// Formula taken from here: https://en.wikipedia.org/wiki/Line%E2%80%93line_intersection#Given_two_points_on_each_line\r\n\t//------------------------------------------------\r\n\tgetLineOverlap(line1, line2) {\r\n\t\tlet denominator = (line1.x1 - line1.x2) * (line2.y1 - line2.y2) - (line1.y1 - line1.y2) * (line2.x1 - line2.x2);\r\n\t\tlet slope1 = (line1.y2 - line1.y1) / (line1.x2 - line1.x1);\r\n\t\tlet slope2 = (line2.y2 - line2.y1) / (line2.x2 - line2.x1);\r\n\r\n\t\t// If the deniminator is zero, of the slopes are the same, we've got parallel lines\r\n\t\tif (denominator === 0 || (slope1.toFixed(5) === slope2.toFixed(5))) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tlet bezierY = line1.y1 - line2.y1;\r\n\t\tlet bezierX = line1.x1 - line2.x1;\r\n\r\n\t\t// How to find the actual co-ordinates where the contact took place (screen-relative)\r\n\t\tlet numeratorX = ((line1.x1 * line1.y2) - (line1.y1 * line1.x2)) * (line2.x1 - line2.x2) - (line1.x1 - line1.x2) * ((line2.x1 * line2.y2) - (line2.y1 * line2.x2));\r\n\t\tlet numeratorY = ((line1.x1 * line1.y2) - (line1.y1 * line1.x2)) * (line2.y1 - line2.y2) - (line1.y1 - line1.y2) * ((line2.x1 * line2.y2) - (line2.y1 * line2.x2));\r\n\t\tlet numeratorLine2 = ((line2.x2 - line2.x1) * bezierY) - ((line2.y2 - line2.y1) * bezierX);\r\n\t\tlet numeratorLine1 = ((line1.x2 - line1.x1) * bezierY) - ((line1.y2 - line1.y1) * bezierX);\r\n\t\tlet bezierLine2 = (numeratorLine2 / denominator);\r\n\t\tlet bezierLine1 = (numeratorLine1 / denominator);\r\n\r\n\t\tlet pointX = numeratorX / denominator;\r\n\t\tlet pointY = numeratorY / denominator;\r\n\r\n\t\tif ((bezierLine2 > 0 && bezierLine2 < 1) && (bezierLine1 > 0 && bezierLine1 < 1)) {\r\n\t\t\treturn {\r\n\t\t\t\tx: pointX,\r\n\t\t\t\ty: pointY\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Takes two points, and works out the y co-ordinate\r\n\t// on the line between them, given an x co-ordinate\r\n\t//------------------------------------------------\r\n\tgetPointAtXpos(point1, point2, xPos) {\r\n\t\tlet slope = (point2.y - point1.y) / (point2.x - point1.x);\r\n\t\tlet yPos = point1.y + (xPos - point1.x) * slope;\r\n\t\treturn {\r\n\t\t\tx: xPos,\r\n\t\t\ty: yPos\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Draws a line parallel to the passed lineData.\r\n\t// The new line will be a distance away from the\r\n\t// existing line by 'offset' pixels. The new line\r\n\t// can also be made longer by specifying an addedWidth.\r\n\t// This added width will be split into two and added\r\n\t// onto each end of the new line.\r\n\t// Example here: http://stackoverflow.com/questions/2825412/draw-a-parallel-line\r\n\t//------------------------------------------------\r\n\tgetParallelLine(lineData, offset, addedWidth, color, thickness) {\r\n\t\t// Store start and end points in objects to pass to the getPointAtXPos function\r\n\t\tlet point1 = {\r\n\t\t\tx: lineData.x1,\r\n\t\t\ty: lineData.y1\r\n\t\t};\r\n\t\tlet point2 = {\r\n\t\t\tx: lineData.x2,\r\n\t\t\ty: lineData.y2\r\n\t\t};\r\n\r\n\t\t// Bump the desired x co-ordinates on the line\r\n\t\tlet extendedX1 = (!addedWidth || addedWidth === 0) ? lineData.x1 : lineData.x1 - (addedWidth/2);\r\n\t\tlet extendedX2 = (!addedWidth || addedWidth === 0) ? lineData.x2 : lineData.x2 + (addedWidth/2);\r\n\t\t// Get the y position required for the given X position\r\n\t\tlet extendedPos1 = this.getPointAtXpos(point1, point2, extendedX1);\r\n\t\tlet extendedPos2 = this.getPointAtXpos(point1, point2, extendedX2);\r\n\r\n\t\tlet extendedPos = {\r\n\t\t\tx1: extendedPos1.x,\r\n\t\t\ty1: extendedPos1.y,\r\n\t\t\tx2: extendedPos2.x,\r\n\t\t\ty2: extendedPos2.y\r\n\t\t};\r\n\r\n\t\tlet gap = (offset) ? offset : 0;\r\n\r\n\t\tlet denominator = Math.sqrt((extendedPos.x1 - extendedPos.x2) * (extendedPos.x1 - extendedPos.x2) + (extendedPos.y1 - extendedPos.y2) * (extendedPos.y1 - extendedPos.y2));\r\n\r\n\t\tlet line1X1 = extendedPos.x1 - gap * (extendedPos.y2 - extendedPos.y1) / denominator;\r\n\t\tlet line1X2 = extendedPos.x2 - gap * (extendedPos.y2 - extendedPos.y1) / denominator;\r\n\t\tlet line1Y1 = extendedPos.y1 - gap * (extendedPos.x1 - extendedPos.x2) / denominator;\r\n\t\tlet line1Y2 = extendedPos.y2 - gap * (extendedPos.x1 - extendedPos.x2) / denominator;\r\n\t\r\n\t\tif (color) {\r\n\t\t\tthis.createGuideLine(line1X1, line1Y1, line1X2, line1Y2, color, 2);\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tx1: line1X1,\r\n\t\t\ty1: line1Y1,\r\n\t\t\tx2: line1X2,\r\n\t\t\ty2: line1Y2\r\n\t\t};\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// This extends out a line beyond it's original\r\n\t// start and end points, but maintains the same angle\r\n\t// and position. We need to do this to ensure that\r\n\t// the two lines overlap, to work out where a line\r\n\t// should end\r\n\t//------------------------------------------------\r\n\tgetExtendedLine(lineData, lineNumber, addedWidth, color) {\r\n\t\tlet offset = lineNumber * (this.strokeWidth*2);\r\n\t\treturn this.getParallelLine(lineData, offset, addedWidth, color);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Figures out the collision mode via the top line\r\n\t//------------------------------------------------\r\n\tgetBoundingLine(lineData, color, thickness) {\r\n\t\t// We just need to take the top line, and move it up by half of the stroke width\r\n\t\t// So the offet will just be minus that\r\n\t\tlet offset = -this.strokeWidth/2;\r\n\t\treturn this.getParallelLine(lineData, offset, 100, color, thickness);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Uses the data established in decideLineTypes()\r\n\t// to draw the lines required\r\n\t//------------------------------------------------\r\n\tdraw() {\r\n\t\t// Before doing anything, we need to re-calculate each line's co-ordinates\r\n\t\tthis.calculateLineCoordinates();\r\n\t\tlet lineData = null;\r\n\t\tlet pathStrings = [];\r\n\t\tlet lastXPos = [0, 0, 0, 0, 0];\r\n\t\tlet lastYPos = [0, 0, 0, 0, 0];\r\n\t\tlet lastExtendedLines = [];\r\n\t\tlet firstExtendedLine = null;\r\n\t\tlet parallel = false;\r\n\t\tthis.collisionPoints = [];\r\n\t\tthis.lineSegments = [];\r\n\t\tlet previousPoint = {};\r\n\t\tlet lastEndX = 0, lastEndY = 0;\r\n\t\tlet startX = 0, startY = 0, endX = 0, endY = 0;\r\n\r\n\t\tfor (let i = 0, length = this.lineData.length; i < length; i++) {\r\n\t\t\tparallel = false;\r\n\t\t\t// Calculate where the two lines meet\r\n\t\t\t// This result is the X2/Y2 for the current line\r\n\t\t\tlineData = this.lineData[i];\r\n\t\t\tlet xPos = 0, yPos = 0;\r\n\t\t\tlet lineOffset = this.strokeWidth;\r\n\t\t\tlet secondCP = 0;\r\n\t\t\tlet firstCP = 0;\r\n\t\t\tlet firstYPos = 0;\r\n\t\t\tlet chosenPointX = 0, chosenPointY = 0, chosenPointX2 = 0, chosenPointY2 = 0;\r\n\r\n\t\t\tfor (let k = 0; k < this.totalLines; k++) {\r\n\t\t\t\tlet line1 = this.getExtendedLine(lineData, k, 400);\r\n\t\t\t\tif (i === 0) {\r\n\t\t\t\t\t// Start the line by moving to the correct position\r\n\t\t\t\t\tlastXPos[k] = line1.x1;\r\n\t\t\t\t\tlastYPos[k] = line1.y1;\r\n\t\t\t\t\tif (!this.pathStrings[k]) {\r\n\t\t\t\t\t\tthis.pathStrings.push( \"M \" + line1.x1 + \" \" + line1.y1);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.pathStrings[k] = \"M \" + line1.x1 + \" \" + line1.y1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tlet line2 = null;\r\n\t\t\t\tlet secondLineData = this.lineData[i+1];\r\n\t\t\t\t// Second line\r\n\t\t\t\tif (secondLineData) {\r\n\t\t\t\t\tline2 = this.getExtendedLine(secondLineData, k, 400);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Find the overlap between the two lines if there is a next line\r\n\t\t\t\tif (secondLineData) {\r\n\t\t\t\t\tlet overlap = this.getLineOverlap(line1, line2);\r\n\t\t\t\t\tif (!overlap) {\r\n\t\t\t\t\t\t// Lines were parallel\r\n\t\t\t\t\t\tparallel = true;\r\n\t\t\t\t\t\txPos = line1.x2 - ((line1.x2 - line2.x1)/2);\r\n\t\t\t\t\t\tyPos = this.getPointAtXpos({x: line2.x1, y: line2.y1}, {x: line2.x2, y: line2.y2}, xPos).y;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Use the overlap point as the x2/y2\r\n\t\t\t\t\t\txPos = (overlap.x === 0) ? line2.x1 + ((line2.x1 - line1.x2)/2) : overlap.x;\r\n\t\t\t\t\t\tyPos = (overlap.y === 0) ? line1.y2 : overlap.y;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// We're on the last line, so just use the points defined by the line 1 guide\r\n\t\t\t\t\txPos = line1.x2;\r\n\t\t\t\t\tyPos = line1.y2;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlet extendedLine = this.getExtendedLine(lineData, k, 0);\r\n\r\n\t\t\t\tif (lineData.type === \"straight\") {\r\n\t\t\t\t\tthis.pathStrings[k] += \" L \" + xPos + \" \" + yPos;\r\n\t\t\t\t} else if (lineData.type === \"curve\") {\r\n\t\t\t\t\tlet firstLine = (lastExtendedLines[k]) ? lastExtendedLines[k] : extendedLine;\r\n\t\t\t\t\tlet secondLine = (secondLineData) ? this.getExtendedLine(secondLineData, k, 0) : extendedLine;\r\n\r\n\t\t\t\t\tlet tempPoint = this.getPointAtXpos({x: firstLine.x1, y: firstLine.y1}, {x: firstLine.x2, y: firstLine.y2}, extendedLine.x1 + ((extendedLine.x2 - extendedLine.x1)/3));\r\n\t\t\t\t\tlet tempPoint2 = this.getPointAtXpos({x: secondLine.x1, y: secondLine.y1}, {x: secondLine.x2, y: secondLine.y2}, extendedLine.x2 - (((extendedLine.x2 - extendedLine.x1)/3)));\r\n\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (k === 0) {\r\n\t\t\t\t\t\tfirstCP = tempPoint.y;\r\n\t\t\t\t\t\tsecondCP = tempPoint2.y;\r\n\t\t\t\t\t\tfirstYPos = yPos;\r\n\t\t\t\t\t\tif (secondLineData && lineData.type === \"curve\" && secondLineData.type === \"curve\") {\r\n\t\t\t\t\t\t\tsecondCP = yPos;\r\n\t\t\t\t\t\t} else if (lineData.type === \"curve\" && !secondLineData) {\r\n\t\t\t\t\t\t\tsecondCP = yPos;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (this.lineData[i-1] && lineData.type === \"curve\" && this.lineData[i-1].type === \"curve\") {\r\n\t\t\t\t\t\t\tfirstCP = lastYPos[0];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tchosenPointX = tempPoint.x;\r\n\t\t\t\t\tchosenPointX2 = tempPoint2.x;\r\n\t\t\t\t\tchosenPointY = 0;\r\n\t\t\t\t\tchosenPointY2 = 0;\r\n\t\t\t\t\tlet newY = (firstCP + ((this.strokeWidth*2)*k));\r\n\t\t\t\t\tchosenPointY = newY;\r\n\t\t\t\t\tif (k === 0) this.pathStrings[k] += \" C \" + tempPoint.x + \" \" + chosenPointY;\r\n\r\n\t\t\t\t\tlet newY2 = (secondCP + ((this.strokeWidth*2)*k));\r\n\r\n\t\t\t\t\tif (secondLineData && secondLineData.type === \"curve\" && lineData.type === \"curve\") {\r\n\t\t\t\t\t\tyPos = newY2;\r\n\t\t\t\t\t} else if (this.lineData[i].type === \"curve\") {\r\n\t\t\t\t\t\tnewY2 = yPos;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tchosenPointY2 = newY2;\r\n\t\t\t\t\tif (k === 0) this.pathStrings[k] += \" \" + tempPoint2.x + \" \" + chosenPointY2 + \" \" + xPos + \" \" + yPos;\r\n\r\n\t\t\t\t\t// It is mathematically impossible to create a bezier curve parallel to another,\r\n\t\t\t\t\t// so here we split the curves up into straight line segments, and then create\r\n\t\t\t\t\t// parallel lines of those. While this is a bit intense, it is only run once during\r\n\t\t\t\t\t// page load, and during resizes, so it should be ok.\r\n\t\t\t\t\tlet point1 = {\r\n\t\t\t\t\t\tx: lastXPos[k],\r\n\t\t\t\t\t\ty: lastYPos[k]\r\n\t\t\t\t\t};\r\n\t\t\t\t\tlet point2 = {\r\n\t\t\t\t\t\tx: xPos,\r\n\t\t\t\t\t\ty: yPos\r\n\t\t\t\t\t};\r\n\t\t\t\t\tlet cp1 = {\r\n\t\t\t\t\t\tx: chosenPointX,\r\n\t\t\t\t\t\ty: chosenPointY\r\n\t\t\t\t\t};\r\n\t\t\t\t\tlet cp2 = {\r\n\t\t\t\t\t\tx: chosenPointX2,\r\n\t\t\t\t\t\ty: chosenPointY2\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tlet newPoint = 0;\r\n\t\t\t\t\tlet totalPoints = 30; // Number of additional points along the curve (between start pos and end pos, not including them)\r\n\t\t\t\t\tfor (let j = 1; j < totalPoints; j++) {\r\n\t\t\t\t\t\tlet percentage = (1 / (totalPoints+1)) * j;\r\n\t\t\t\t\t\tnewPoint = this.getPointOnBezierCurve(point1, cp1, cp2, point2, percentage);\r\n\t\t\t\t\t\tif (newPoint.x > xPos) {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (k > 0) {\r\n\t\t\t\t\t\t\tthis.pathStrings[k] += \" L \" + newPoint.x + \" \" + newPoint.y;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tpreviousPoint = newPoint;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// End pos of the line\r\n\t\t\t\t\tif (k > 0) {\r\n\t\t\t\t\t\tthis.pathStrings[k] += \" L \" + xPos + \" \" + yPos;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//this.createGuideCircle(chosenPointX, chosenPointY, \"#0000FF\");\r\n\t\t\t\t\t//this.createGuideCircle(chosenPointX2, chosenPointY2, \"#0000FF\");\r\n\t\t\t\t}\r\n\t\t\t\t//this.createGuideCircle(xPos, yPos, \"#000\");\r\n\t\t\t\t//this.createGuideCircle(lastXPos[k], lastYPos[k], \"#000\");\r\n\r\n\r\n\t\t\t\t// Add new points to the collision point array, but only for the top line (hence k=0)\r\n\t\t\t\t// We're doing this here because we need the control point positions for curves, which\r\n\t\t\t\t// are decided above\r\n\t\t\t\tif (k === 0) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet firstBoundingLine = this.getBoundingLine(lineData);\r\n\t\t\t\t\tif (i === 0) {\r\n\t\t\t\t\t\tstartX = firstBoundingLine.x1;\r\n\t\t\t\t\t\tstartY = firstBoundingLine.y1;\r\n\t\t\t\t\t\tthis.collisionPoints.push({\r\n\t\t\t\t\t\t\tx: startX,\r\n\t\t\t\t\t\t\ty: startY\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// Store 'previous point' as the first point here\r\n\t\t\t\t\t\tpreviousPoint = this.collisionPoints[0];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tstartX = lastEndX;\r\n\t\t\t\t\t\tstartY = lastEndY;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (secondLineData) {\r\n\t\t\t\t\t\tlet secondBoundingLine = this.getBoundingLine(secondLineData);\r\n\t\t\t\t\t\tlet overlap = this.getLineOverlap(firstBoundingLine, secondBoundingLine);\r\n\t\t\t\t\t\tif (!overlap) {\r\n\t\t\t\t\t\t\t// This means the lines were parallel\r\n\t\t\t\t\t\t\tlet newPoint = this.getPointAtXpos({x: secondBoundingLine.x1, y: secondBoundingLine.y1}, {x: secondBoundingLine.x2, y: secondBoundingLine.y2}, firstBoundingLine.x2 - ((firstBoundingLine.x2 - secondBoundingLine.x1)/2));\r\n\t\t\t\t\t\t\tendX = newPoint.x;\r\n\t\t\t\t\t\t\tendY = newPoint.y;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tendX = (overlap.x === 0) ? secondBoundingLine.x1 + ((secondBoundingLine.x1 - firstBoundingLine.x2)/2) : overlap.x;\r\n\t\t\t\t\t\t\tendY = (overlap.y === 0) ? firstBoundingLine.y2 : overlap.y;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tendX = firstBoundingLine.x2;\r\n\t\t\t\t\t\tendY = firstBoundingLine.y2;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlastEndX = endX;\r\n\t\t\t\t\tlastEndY = endY;\r\n\r\n\t\t\t\t\tif (lineData.type === \"straight\") {\r\n\t\t\t\t\t\t// Straights\r\n\t\t\t\t\t\tthis.collisionPoints.push({\r\n\t\t\t\t\t\t\tx: endX,\r\n\t\t\t\t\t\t\ty: endY\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.lineSegments.push({\r\n\t\t\t\t\t\t\tx1: startX,\r\n\t\t\t\t\t\t\ty1: startY,\r\n\t\t\t\t\t\t\tx2: endX,\r\n\t\t\t\t\t\t\ty2: endY\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tpreviousPoint = {\r\n\t\t\t\t\t\t\tx: endX,\r\n\t\t\t\t\t\t\ty: endY\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Curves\r\n\t\t\t\t\t\t// Work out some points along the line\r\n\t\t\t\t\t\t// We actually use the points that are in the center of the top line here\r\n\t\t\t\t\t\t// as these have already been calculated above. To nudge the bounding lines\r\n\t\t\t\t\t\t// to the top of the green line, we just subtract (this.strokeWidth/2) from\r\n\t\t\t\t\t\t// the resulting y co-ordinates\r\n\t\t\t\t\t\tlet point1 = {\r\n\t\t\t\t\t\t\tx: lastXPos[0],\r\n\t\t\t\t\t\t\ty: lastYPos[0]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tlet point2 = {\r\n\t\t\t\t\t\t\tx: xPos,\r\n\t\t\t\t\t\t\ty: yPos\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tlet cp1 = {\r\n\t\t\t\t\t\t\tx: chosenPointX,\r\n\t\t\t\t\t\t\ty: chosenPointY\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tlet cp2 = {\r\n\t\t\t\t\t\t\tx: chosenPointX2,\r\n\t\t\t\t\t\t\ty: chosenPointY2\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tlet newPoint = 0;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet totalPoints = 9; // Number of additional points along the curve (between start pos and end pos, not including them)\r\n\t\t\t\t\t\tfor (let j = 1; j < totalPoints; j++) {\r\n\t\t\t\t\t\t\tlet percentage = (1 / (totalPoints+1)) * j;\r\n\t\t\t\t\t\t\tnewPoint = this.getPointOnBezierCurve(point1, cp1, cp2, point2, percentage);\r\n\t\t\t\t\t\t\t// Subtract half the stroke width here, to nudge the bounding line up to the top\r\n\t\t\t\t\t\t\t// of the green line, rather than in the middle\r\n\t\t\t\t\t\t\tnewPoint.y -= this.strokeWidth/2;\r\n\t\t\t\t\t\t\tthis.collisionPoints.push(newPoint);\r\n\t\t\t\t\t\t\tthis.lineSegments.push({\r\n\t\t\t\t\t\t\t\tx1: previousPoint.x,\r\n\t\t\t\t\t\t\t\ty1: previousPoint.y,\r\n\t\t\t\t\t\t\t\tx2: newPoint.x,\r\n\t\t\t\t\t\t\t\ty2: newPoint.y\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tpreviousPoint = newPoint;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Add the last point\r\n\t\t\t\t\t\tthis.collisionPoints.push({\r\n\t\t\t\t\t\t\tx: endX,\r\n\t\t\t\t\t\t\ty: endY\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.lineSegments.push({\r\n\t\t\t\t\t\t\tx1: previousPoint.x,\r\n\t\t\t\t\t\t\ty1: previousPoint.y,\r\n\t\t\t\t\t\t\tx2: endX,\r\n\t\t\t\t\t\t\ty2: endY\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// End of collision point calculations\r\n\t\t\t\tlastXPos[k] = xPos;\r\n\t\t\t\tlastYPos[k] = yPos;\r\n\t\t\t\tlastExtendedLines[k] = extendedLine;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let i = 0, length = this.totalLines; i < length; i++) {\r\n\t\t\tthis.lineElements[i].setAttribute(\"d\", this.pathStrings[i]);\r\n\t\t}\r\n\r\n\t\tthis.drawCollisionBoundary();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Returns a point a percentage distance along a bezier curve\r\n\t// Helpfully explained further here:\r\n\t// http://stackoverflow.com/questions/14174252/how-to-find-out-y-coordinate-of-specific-point-in-bezier-curve-in-canvas\r\n\t//------------------------------------------------\r\n\tgetPointOnBezierCurve(point1, cp1, cp2, point2, percentage) {\r\n\t\t// Work out the points on the triangle sitting within all 4 points\r\n\t\t// This also factors in the percentage for P1 and P3, as these points\r\n\t\t// need to be a percentage along the lines connecting point1 and cp1,\r\n\t\t// and cp2 and point2\r\n\t\tlet p1X = ((1 - percentage) * point1.x) + (percentage * cp1.x);\r\n\t\tlet p1Y = ((1 - percentage) * point1.y) + (percentage * cp1.y);\r\n\t\tlet p2X = ((1 - percentage) * cp1.x) + (percentage * cp2.x);\r\n\t\tlet p2Y = ((1 - percentage) * cp1.y) + (percentage * cp2.y);\r\n\t\tlet p3X = ((1 - percentage) * cp2.x) + (percentage * point2.x);\r\n\t\tlet p3Y = ((1 - percentage) * cp2.y) + (percentage * point2.y);\r\n\t\t// Now we find the points a percentage along the newly found lines\r\n\t\t// This is to figure out the point on the curve we need, as the curve\r\n\t\t// will intersect this new line at some point\r\n\t\tlet lineX1 = ((1 - percentage) * p1X) + (percentage * p2X);\r\n\t\tlet lineY1 = ((1 - percentage) * p1Y) + (percentage * p2Y);\r\n\t\tlet lineX2 = ((1 - percentage) * p2X) + (percentage * p3X);\r\n\t\tlet lineY2 = ((1 - percentage) * p2Y) + (percentage * p3Y);\r\n\t\t// Now with that line figured out we can calculate where it hits the curve\r\n\t\treturn {\r\n\t\t\tx: ((1 - percentage) * lineX1) + (percentage * lineX2),\r\n\t\t\ty: ((1 - percentage) * lineY1) + (percentage * lineY2)\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Draws the collision model segments\r\n\t// This will only be rendered if debug mode is active\r\n\t//------------------------------------------------\r\n\tdrawCollisionBoundary() {\r\n\t\tlet path = \"\";\r\n\t\tfor (let i = 0, length = this.collisionPoints.length; i < length; i++) {\r\n\t\t\tif (i === 0) {\r\n\t\t\t\tpath = \"M \" + this.collisionPoints[i].x + \" \" + this.collisionPoints[i].y;\r\n\t\t\t} else {\r\n\t\t\t\tpath += \" L \" + this.collisionPoints[i].x + \" \" + this.collisionPoints[i].y;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.collisionGuide.setAttribute(\"d\", path);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Guides used for development to show curve control\r\n\t// points, among other things\r\n\t//------------------------------------------------\r\n\tcreateGuideCircle(x, y, color) {\r\n\t\tlet circle = document.createElementNS(\"http://www.w3.org/2000/svg\", \"circle\");\r\n\t\tcircle.setAttribute(\"fill\", color);\r\n\t\tcircle.setAttribute(\"cx\", x);\r\n\t\tcircle.setAttribute(\"cy\", y);\r\n\t\tcircle.setAttribute(\"r\", 10);\r\n\t\tthis.guideCircles.push(circle);\r\n\t\t//this.DOMElement.appendChild(circle);\r\n\t} \r\n\r\n\t//------------------------------------------------\r\n\t// Shows where actual lines were drawn at 2px width\r\n\t//------------------------------------------------\r\n\tcreateGuideLine(x1, y1, x2, y2, color, thickness) {\r\n\t\t// Create a test line\r\n\t\tif (!thickness) thickness = 2;\r\n\t\tlet testLine = document.createElementNS(\"http://www.w3.org/2000/svg\", \"line\");\r\n\t\ttestLine.setAttribute(\"stroke-width\", thickness);\r\n\t\ttestLine.setAttribute(\"fill\", \"transparent\");\r\n\t\ttestLine.setAttribute(\"stroke\", color);\r\n\t\ttestLine.setAttribute(\"x1\", x1);\r\n\t\ttestLine.setAttribute(\"x2\", x2);\r\n\t\ttestLine.setAttribute(\"y1\", y1);\r\n\t\ttestLine.setAttribute(\"y2\", y2);\r\n\t\tthis.guideLines.push(testLine);\r\n\t\t//this.DOMElement.appendChild(testLine);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Resize with new dimensions and line thickness\r\n\t//------------------------------------------------\r\n\tresize(strokeWidth, scale) {\r\n\t\tthis.strokeWidth = strokeWidth;\r\n\t\tfor (let i = 0, length = this.totalLines; i < length; i++) {\r\n\t\t\tthis.lineElements[i].setAttribute(\"stroke-width\", this.strokeWidth);\r\n\t\t}\r\n\t\tthis.draw();\r\n\t}\r\n}","////////////////////////////////////////////////////////////////////////////////\r\n// Syrup Sounds Website\r\n// Standard EventDispatcher\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nclass EventDispatcher {\r\n\r\n\t//------------------------------------------------\r\n\t// Constructor\r\n\t//------------------------------------------------\r\n\tconstructor() {\r\n\t\tthis.eventHandlers = [];\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Add a listener to this class (or, rather, it's \r\n\t// subclass), for a passed event, and run a passed \r\n\t// callback when it's heard\r\n\t//------------------------------------------------\r\n\taddListener(type, handler) {\r\n\t\tif (typeof this.eventHandlers[type] === \"undefined\") {\r\n\t\t\tthis.eventHandlers[type] = [];\r\n\t\t}\r\n\t\tthis.eventHandlers[type].push(handler);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Remove an existing listener from this class\r\n\t//------------------------------------------------\r\n\tremoveListener(type, handler) {\r\n\t\tif (this.eventHandlers[type] instanceof Array) {\r\n\t\t\tlet handlers = this.eventHandlers[type];\r\n\t\t\t// Remove all handlers for this type\r\n\t\t\tif (!handler) {\r\n\t\t\t\tthis.eventHandlers[type] = [];\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// Remove a specific handler\r\n\t\t\tfor (let i = 0, length = handlers.length; i < length; i++) {\r\n\t\t\t\tif (String(handlers[i]) === String(handler)) {\r\n\t\t\t\t\thandlers.splice(i, 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Fire an event of the passed type, from this class\r\n\t//------------------------------------------------\r\n\ttrigger(type) {\r\n\t\tlet i = 0, length, listeners, listener, event,\r\n\t\targs = Array.prototype.slice.call(arguments).splice(2);\r\n\t\tif (typeof type === \"string\") {\r\n\t\t\tevent = {type: type};\r\n\t\t} else {\r\n\t\t\tevent = type;\r\n\t\t}\r\n\t\tif (!event) {\r\n\t\t\tthrow new Error(\"Type is undefined\");\r\n\t\t}\r\n\t\tif (!event.target) {\r\n\t\t\tevent.target = this;\r\n\t\t}\r\n\t\tif (!event.type) {\r\n\t\t\tthrow new Error(\"Object missing 'type' property\");\r\n\t\t}\r\n\t\tif (this.eventHandlers[event.type] instanceof Array) {\r\n\t\t\tlisteners = this.eventHandlers[event.type];\r\n\t\t\tlength = listeners.length;\r\n\t\t\targs.unshift(event);\r\n\t\t\tfor (; i < length; i++) {\r\n\t\t\t\tlistener = listeners[i];\r\n\t\t\t\tif (listener) {\r\n\t\t\t\t\tlistener.apply(this, args);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","////////////////////////////////////////////////////////////////////////////////\r\n// Syrup Sounds Website\r\n// Website Events\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nclass Events {\r\n\r\n\t//------------------------------------------------\r\n\t// Constructor \r\n\t//------------------------------------------------\r\n\tconstructor() {\r\n\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Event names \r\n\t//------------------------------------------------\r\n\tstatic get ENABLE_DEBUG_MODE() {\r\n\t\treturn \"EnableDebugMode\";\r\n\t}\r\n\r\n\tstatic get DISABLE_DEBUG_MODE() {\r\n\t\treturn \"DisableDebugMode\";\r\n\t}\r\n\r\n\tstatic get ENABLE_FLIGHT_CONTROL() {\r\n\t\treturn \"EnableFlightControl\";\r\n\t}\r\n\r\n\tstatic get DISABLE_FLIGHT_CONTROL() {\r\n\t\treturn \"DisableFlightControl\";\r\n\t}\r\n\r\n\tstatic get RANDOMISE_SHAPES() {\r\n\t\treturn \"RandomiseShapes\";\r\n\t}\r\n\r\n\tstatic get RANDOMISE_BACKGROUND_LINES() {\r\n\t\treturn \"RandomiseBackgroundLines\";\r\n\t}\r\n\r\n\tstatic get RANDOMISE_ALL() {\r\n\t\treturn \"RandomiseAll\";\r\n\t}\r\n\r\n\tstatic get SHOW_ONLY_ARCS() {\r\n\t\treturn \"ShowOnlyArcs\";\r\n\t}\r\n\tstatic get SHOW_ONLY_CORNERS() {\r\n\t\treturn \"ShowOnlyCorners\";\r\n\t}\r\n\tstatic get SHOW_ONLY_TRIANGLES() {\r\n\t\treturn \"ShowOnlyTriangles\";\r\n\t}\r\n\tstatic get SHOW_ONLY_LINES() {\r\n\t\treturn \"ShowOnlyLines\";\r\n\t}\r\n\tstatic get SHOW_ONLY_CIRCLES() {\r\n\t\treturn \"ShowOnlyCircles\";\r\n\t}\r\n\tstatic get SHOW_ALL_SHAPES() {\r\n\t\treturn \"ShowAllShapes\";\r\n\t}\r\n\r\n\tstatic get UPDATE_SHAPE_SPEEDS() {\r\n\t\treturn \"UpdateShapeSpeeds\";\r\n\t}\r\n\r\n\tstatic get SCALE_CHANGE_REQUESTED() {\r\n\t\treturn \"ScaleChangeRequested\";\r\n\t}\r\n}","////////////////////////////////////////////////////////////////////////////////\r\n// Syrup Sounds Website\r\n// Shape Physics\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nclass ShapeSystem extends EventDispatcher {\r\n\r\n\t//------------------------------------------------\r\n\t// Constructor\r\n\t//------------------------------------------------\r\n\tconstructor(DOMElement, backgroundLines, stage, strokeWidth, scale) {\r\n\t\tsuper();\r\n\t\t// Variables\r\n\t\tthis.DOMElement = DOMElement;\r\n\t\tthis.backgroundLines = backgroundLines;\r\n\t\tthis.stage = stage;\r\n\t\tthis.totalShapes = 0;\r\n\t\tthis.maxShapes = 5;\r\n\t\tthis.paused = true;\r\n\t\tthis.debugMode = false;\r\n\t\tthis.flightControlEnabled = false\r\n\t\tthis.strokeWidth = strokeWidth;\r\n\t\tthis.scale = scale;\r\n\t\tthis.shapes = [];\r\n\t\tthis.flightControlShapes = [];\r\n\t\tthis.flightControlCopy = [];\r\n\t\tthis.fadedShapes = 0;\r\n\t\tthis.shapeOptions = [ArcShape, CircleShape, LineShape, LShape, TriangleShape];\r\n\t\t//this.shapeOptions = [LineShape];\r\n\t\tthis.createStartingShapes();\r\n\t\tthis.createListeners();\r\n\t\tthis.requestFrameID = requestAnimationFrame(() => this.updateSimulation());\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\trandomise() {\r\n\t\t// Remove old shapes\r\n\t\twhile (this.shapes.length > 0) {\r\n\t\t\tthis.shapes[0].destroy(true);\r\n\t\t\tthis.shapes.shift();\r\n\t\t}\r\n\t\t// Recreate shapes\r\n\t\tthis.createStartingShapes();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tupdateSpeeds() {\r\n\t\t// Remove old shapes\r\n\t\tvar i = 0, length = this.shapes.length;\r\n\t\tfor (; i < length; i++) {\r\n\t\t\tthis.shapes[i].selectSpeed();\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tshowArcs() {\r\n\t\tthis.shapeOptions = [ArcShape];\r\n\t\tthis.randomise();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tshowCircles() {\r\n\t\tthis.shapeOptions = [CircleShape];\r\n\t\tthis.randomise();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tshowLines() {\r\n\t\tthis.shapeOptions = [LineShape];\r\n\t\tthis.randomise();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tshowCorners() {\r\n\t\tthis.shapeOptions = [LShape];\r\n\t\tthis.randomise();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tshowTriangles() {\r\n\t\tthis.shapeOptions = [TriangleShape];\r\n\t\tthis.randomise();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tshowAllShapes() {\r\n\t\tthis.shapeOptions = [ArcShape, CircleShape, LineShape, LShape, TriangleShape];\r\n\t\tthis.randomise();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Listen to debug mode requests\r\n\t//------------------------------------------------\r\n\tcreateListeners() {\r\n\t\tMediator.subscribe(Events.ENABLE_DEBUG_MODE, (data) => this.enableDebugMode(data));\r\n\t\tMediator.subscribe(Events.DISABLE_DEBUG_MODE, (data) => this.disableDebugMode(data));\r\n\t\tMediator.subscribe(Events.ENABLE_FLIGHT_CONTROL, (data) => this.enableFlightControl(data));\r\n\t\tMediator.subscribe(Events.DISABLE_FLIGHT_CONTROL, (data) => this.disableFlightControl(data));\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Start rendering the collision models for all shapes\r\n\t//------------------------------------------------\r\n\tenableDebugMode() {\r\n\t\tthis.debugMode = true;\r\n\t\tfor (let i = 0, length = this.shapes.length; i < length; i++) {\r\n\t\t\tthis.shapes[i].showCollisionModel();\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Stop rendering the collision models for all shapes\r\n\t//------------------------------------------------\r\n\tdisableDebugMode() {\r\n\t\tthis.debugMode = false;\r\n\t\tfor (let i = 0, length = this.shapes.length; i < length; i++) {\r\n\t\t\tthis.shapes[i].hideCollisionModel();\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Start rendering the collision lines and line angle\r\n\t//------------------------------------------------\r\n\tenableFlightControl(data) {\r\n\t\tthis.flightControlEnabled = true;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Remove any currently rendered collision line data\r\n\t//------------------------------------------------\r\n\tdisableFlightControl(data) {\r\n\t\tthis.flightControlEnabled = false;\r\n\t\tif (this.flightControlShapes.length > 0) {\r\n\t\t\tfor (let i = 0, length = this.flightControlShapes.length; i < length; i++) {\r\n\t\t\t\tthis.DOMElement.removeChild(this.flightControlShapes[i]);\r\n\t\t\t}\r\n\t\t\tthis.flightControlShapes = [];\r\n\t\t}\r\n\t\tif (this.flightControlCopy.length) {\r\n\t\t\tfor (let i =0, length = this.flightControlCopy.length; i < length; i++) {\r\n\t\t\t\tdocument.body.removeChild(this.flightControlCopy[i]);\r\n\t\t\t}\r\n\t\t\tthis.flightControlCopy = [];\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Stop updating shape positions\r\n\t//------------------------------------------------\r\n\tpause() {\r\n\t\tthis.paused = true;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Resume updating shape positions\r\n\t//------------------------------------------------\r\n\tresume() {\r\n\t\tthis.paused = false;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Create a random selection of shapes\r\n\t//------------------------------------------------\r\n\tcreateStartingShapes() {\r\n\t\tlet color = \"#00eac4\";\r\n\t\tfor (let i = 0, length = this.maxShapes; i < length; i++) {\r\n\t\t\t// Colour changing for testing purposes\r\n\t\t\t/*if (i === 0) {\r\n\t\t\t\tcolor = \"#000000\";\r\n\t\t\t} else {\r\n\t\t\t\tcolor = \"#00eac4\";\r\n\t\t\t}*/\r\n\t\t\tthis.createNewShape(false, color);\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Create a new shape\r\n\t//------------------------------------------------\r\n\tcreateNewShape(triggerSound, color=\"#00eac4\") {\r\n\t\tlet randomNumber = Math.floor(Math.random() * this.shapeOptions.length);\r\n\t\tlet shape = new this.shapeOptions[randomNumber](this.DOMElement, color, this.strokeWidth, this.scale, triggerSound);\r\n\t\tthis.setRandomPosition(shape);\r\n\t\tlet segmentWidth = 50;\r\n\t\tlet segmentHeight = 50;\r\n\t\tlet xPos = this.stage.x, yPos = this.stage.y;\r\n\t\tlet shapeCreated = true;\r\n\t\tif (this.shapes.length >= this.maxShapes) {\r\n\t\t\tthis.shapes[0].destroy();\r\n\t\t\tthis.shapes.shift();\r\n\t\t}\r\n\r\n\t\t// Split the screen up into segments, and try placing the shape in each\r\n\t\t// until it isn't colliding with another shape\r\n\t\twhile ((this.checkBoundingBoxes(shape) || this.checkScreenEdges(shape) || this.checkBackgroundLine(shape))) {\r\n\t\t\tshape.setPosition(xPos, yPos);\r\n\t\t\txPos += segmentWidth;\r\n\t\t\tif (xPos > (this.stage.x + this.stage.width)) {\r\n\t\t\t\txPos = this.stage.x;\r\n\t\t\t\tyPos += segmentHeight;\r\n\t\t\t}\r\n\t\t\tif (yPos > this.stage.y + ((this.stage.height/2) - 150)) {\r\n\t\t\t\tshapeCreated = false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (shapeCreated) {\r\n\t\t\tthis.shapes.push(shape);\r\n\t\t\tshape.addToStage();\r\n\t\t\tif (triggerSound && !this.debugMode) {\r\n\t\t\t\tlet stagePosition = ((shape.getBoundingBox().x + (shape.getBoundingBox().width/2)) - this.stage.x) / this.stage.width;\r\n\t\t\t\t//shape.collide(stagePosition);\r\n\t\t\t\tshape.playCollisionSound(stagePosition);\r\n\t\t\t}\r\n\t\t\tif (this.debugMode) {\r\n\t\t\t\tshape.showCollisionModel();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tshape.destroy();\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Check if a shape is colliding with the main background lines\r\n\t//------------------------------------------------\r\n\tcheckBackgroundLine(shape) {\r\n\t\tlet result = this.checkLineCollisions(shape, this.backgroundLines);\r\n\t\treturn result.collision;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Make sure a shape isn't outside it's target area\r\n\t//------------------------------------------------\r\n\tcheckScreenEdges(shape) {\r\n\t\tvar box = shape.getBoundingBox();\r\n\t\tif (box.x < this.stage.x || box.x + box.width > (this.stage.x + this.stage.width) || box.y < this.stage.y || box.y + box.height > (this.stage.y + this.stage.height)) {\r\n\t\t\treturn true;\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Choose a random position on the screen\r\n\t//------------------------------------------------\r\n\tsetRandomPosition(shape) {\r\n\t\tlet x = this.stage.x + (100 + (Math.random() * (this.stage.width-200)));\r\n\t\tlet y = 100 + (Math.random() * ((this.stage.height/2)-200));\r\n\t\tshape.setPosition(x, y);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Check a shape isn't overlapping another's box\r\n\t//------------------------------------------------\r\n\tcheckBoundingBoxes(shape) {\r\n\t\tlet collision = false;\r\n\t\tfor (let i = 0, length = this.shapes.length; i < length; i++) {\r\n\t\t\t// Don't check for collisions with yourself\r\n\t\t\tif (this.shapes[i] !== shape) {\r\n\t\t\t\tif (this.checkBoundingBox(shape, this.shapes[i])) {\r\n\t\t\t\t\tcollision = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn collision;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Compare the bounding boxes of two shapes\r\n\t//------------------------------------------------\r\n\tcheckBoundingBox(shape1, shape2) {\r\n\t\tlet collision = false;\r\n\t\tlet shape1Box = shape1.getBoundingBox();\r\n\t\tlet shape2Box = shape2.getBoundingBox();\r\n\r\n\t\tif (shape1Box.x < shape2Box.x + shape2Box.width &&\r\n\t\t\tshape1Box.x + shape1Box.width > shape2Box.x &&\r\n\t\t\tshape1Box.y < shape2Box.y + shape2Box.height &&\r\n\t\t\tshape1Box.height + shape1Box.y > shape2Box.y) {\r\n\t\t\tcollision = true;\r\n\t\t}\r\n\r\n\t\treturn collision;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// A shape should flip it's xSpeed if it hits a \r\n\t// steep enough slope, and should always be moving\r\n\t// upwards, since the lines are always at the bottom\r\n\t// of the screen\r\n\t//------------------------------------------------\r\n\tcreateBackgroundCollision(shape, result) {\r\n\t\t// Get away from the lines\r\n\t\tlet shapePos = shape.getPosition();\r\n\t\t// Work out new speed and direction\r\n\t\t// We know line2 is the background's line because it's always the second argument to that method\r\n\t\tlet bgLine = result.line2;\r\n\t\t// Get the slope of the background line the shape hit\r\n\t\tlet slope = 0;\r\n\t\tif (bgLine.x2 === bgLine.x1) {\r\n\t\t\tslope = 1;\r\n\t\t} else if (bgLine.y2 !== bgLine.y1) {\r\n\t\t\tslope = (bgLine.y2 - bgLine.y1) / (bgLine.x2 - bgLine.x1);\r\n\t\t}\r\n\t\tif (slope > 0.4 && shape.xSpeed < 0) {\r\n\t\t\tshape.xSpeed *= -1;\r\n\t\t}\r\n\t\tif (slope < -0.4 && shape.xSpeed > 0) {\r\n\t\t\tshape.xSpeed *= -1;\r\n\t\t}\r\n\r\n\t\t// Shape should always move up as lines are below them at all times in impacts\r\n\t\tshape.ySpeed = -Math.abs(shape.ySpeed);\r\n\t\tif (Math.abs(shape.ySpeed) < 1) {\r\n\t\t\tvar position = shape.getPosition();\r\n\t\t\tshape.setPosition(position.x, position.y - 2);\r\n\t\t}\r\n\r\n\t\t// Work out rotation\r\n\t\tshape.rotationSpeed *= -1;\r\n\t\tlet stagePosition = ((shape.getBoundingBox().x + (shape.getBoundingBox().width/2)) - this.stage.x) / this.stage.width;\r\n\t\tshape.collide(stagePosition, true);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Move shapes, then check for collisions\r\n\t//------------------------------------------------\r\n\tupdateSimulation() {\r\n\t\tif (!this.paused) {\r\n\t\t\tfor (let i = 0, length = this.shapes.length; i < length; i++) {\r\n\t\t\t\tthis.shapes[i].update();\r\n\t\t\t}\r\n\r\n\t\t\tlet result = false;\r\n\t\t\t\r\n\t\t\t// Compare each shape to the sweeping background lines, and see if they hit it\r\n\t\t\tlet bgCollisionModel = this.backgroundLines.getLineSegments();\r\n\t\t\tfor (let i = 0, length = this.shapes.length; i < length; i++) {\r\n\t\t\t\tlet shape = this.shapes[i];\r\n\t\t\t\t// BackgroundLines also has a getLineSegments method, so can also be fed in here directly\r\n\t\t\t\tresult = this.checkLineCollisions(shape, this.backgroundLines);\r\n\t\t\t\tif (result.collision) {\r\n\t\t\t\t\tthis.createBackgroundCollision(shape, result);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Compare each shape to the stage bounds\r\n\t\t\tfor (let i = 0, length = this.shapes.length; i < length; i++) {\r\n\t\t\t\tlet shape = this.shapes[i];\r\n\t\t\t\tlet boundingBox = this.shapes[i].getBoundingBox();\r\n\t\t\t\tif (boundingBox.x < this.stage.x) {\r\n\t\t\t\t\tshape.xSpeed = Math.abs(shape.xSpeed);\r\n\t\t\t\t\tshape.rotationSpeed *= -1;\r\n\t\t\t\t} else if (boundingBox.x + boundingBox.width > (this.stage.x + this.stage.width)) {\r\n\t\t\t\t\tshape.xSpeed = -Math.abs(shape.xSpeed);\r\n\t\t\t\t\tshape.rotationSpeed *= -1;\r\n\t\t\t\t} else if (boundingBox.y < this.stage.y) {\r\n\t\t\t\t\tshape.ySpeed = Math.abs(shape.ySpeed);\r\n\t\t\t\t\tshape.rotationSpeed *= -1;\r\n\t\t\t\t} else if (boundingBox.y + boundingBox.height > (this.stage.y + this.stage.height)) {\r\n\t\t\t\t\tshape.ySpeed = -Math.abs(shape.ySpeed);\r\n\t\t\t\t\tshape.rotationSpeed *= -1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Compare each shape to every other shape, and see if they collide\r\n\t\t\tfor (let i = 0, length = this.shapes.length; i < length; i++) {\r\n\t\t\t\tfor (let k = i+1, kLength = this.shapes.length; k < length; k++) {\r\n\t\t\t\t\tif (this.checkBoundingBox(this.shapes[i], this.shapes[k])) {\r\n\t\t\t\t\t\t// If bounding box is overlapping, do more complicated stuff\r\n\t\t\t\t\t\tresult = this.checkLineCollisions(this.shapes[i], this.shapes[k], true);\r\n\t\t\t\t\t\tif (result.length > 0) {\r\n\t\t\t\t\t\t\t//if (this.shapes[i].colliders.indexOf(this.shapes[k]) < 0 || this.shapes[k].colliders.indexOf(this.shapes[i]) < 0) {\r\n\t\t\t\t\t\t\t\tresult.shape1 = this.shapes[i];\r\n\t\t\t\t\t\t\t\tresult.shape2 = this.shapes[k];\r\n\r\n\t\t\t\t\t\t\t\tthis.createCollision(this.shapes[i], this.shapes[k], result);\r\n\t\t\t\t\t\t\t\tthis.shapes[i].addCollider(this.shapes[k]);\r\n\t\t\t\t\t\t\t\tthis.shapes[k].addCollider(this.shapes[i]);\r\n\t\t\t\t\t\t\t//}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.shapes[i].removeCollider(this.shapes[k]);\r\n\t\t\t\t\t\t\tthis.shapes[k].removeCollider(this.shapes[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.shapes[i].removeCollider(this.shapes[k]);\r\n\t\t\t\t\t\tthis.shapes[k].removeCollider(this.shapes[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.requestFrameID = requestAnimationFrame(() => this.updateSimulation());\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Check line segemnts between two shapes\r\n\t// @allMatches: Return an array of matching collisions\r\n\t// This is since a line on shape1 can cross more than one\r\n\t// line on shape2 at once (ie. a corner hit will match\r\n\t// two lines at once)\r\n\t//------------------------------------------------\r\n\tcheckLineCollisions(shape1, shape2, allMatches) {\r\n\t\tlet shape1Segments = shape1.getLineSegments();\r\n\t\tlet shape2Segments = shape2.getLineSegments();\r\n\t\tlet result = {\r\n\t\t\tline1Impact: 0,\r\n\t\t\tline2Impact: 0,\r\n\t\t\tcollision: false\r\n\t\t};\r\n\t\tlet collisions = [];\r\n\t\tfor (let i = 0, length = shape1Segments.length; i < length; i++) {\r\n\t\t\tfor (let k = 0, kLength = shape2Segments.length; k < kLength; k++) {\r\n\t\t\t\tresult = this.testLines(shape1Segments[i], shape2Segments[k]);\r\n\t\t\t\tif (result.collision) {\r\n\t\t\t\t\tresult.line1ID = i;\r\n\t\t\t\t\tresult.line2ID = k;\r\n\t\t\t\t\tif (allMatches) {\r\n\t\t\t\t\t\tcollisions.push(result);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (allMatches) {\r\n\t\t\treturn collisions;\r\n\t\t} else {\r\n\t\t\treturn result;\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Check if two lines overlap\r\n\t//------------------------------------------------\r\n\ttestLines(line1, line2) {\r\n\t\t// This link helped a lot: https://en.wikipedia.org/wiki/Line%E2%80%93line_intersection#Intersection_of_two_lines\r\n\t\tlet denominator = (line1.x1 - line1.x2) * (line2.y1 - line2.y2) - (line1.y1 - line1.y2) * (line2.x1 - line2.x2);\r\n\t\tlet slope1 = (line1.y2 - line1.y1) / (line1.x2 - line1.x1);\r\n\t\tlet slope2 = (line2.y2 - line2.y1) / (line2.x2 - line2.x1);\r\n\t\t\r\n\t\t// How to find the actual co-ordinates where the contact took place (screen-relative)\r\n\t\tlet numeratorX = ((line1.x1 * line1.y2) - (line1.y1 * line1.x2)) * (line2.x1 - line2.x2) - (line1.x1 - line1.x2) * ((line2.x1 * line2.y2) - (line2.y1 * line2.x2));\r\n\t\tlet numeratorY = ((line1.x1 * line1.y2) - (line1.y1 * line1.x2)) * (line2.y1 - line2.y2) - (line1.y1 - line1.y2) * ((line2.x1 * line2.y2) - (line2.y1 * line2.x2));\r\n\r\n\t\tlet pointX = numeratorX / denominator;\r\n\t\tlet pointY = numeratorY / denominator;\r\n\t\t// If the denominator is 0, that means both lines are parallel\r\n\t\t// Return true, since we already know the bounding boxes are overlapping\r\n\t\tif (denominator === 0 || (slope1.toFixed(5) === slope2.toFixed(5))) {\r\n\t\t\treturn {\r\n\t\t\t\tline1: line1,\r\n\t\t\t\tline2: line2,\r\n\t\t\t\tline1Impact: 0.5,\r\n\t\t\t\tline2Impact: 0.5,\r\n\t\t\t\tx: pointX,\r\n\t\t\t\ty: pointY,\r\n\t\t\t\tcollision: false\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// First see how far along the connecting point is between the two lines\r\n\t\t// Between 0 and 1 means it's somewhere on the lines, otherwise it's further off the actual lines\r\n\t\t// https://en.wikipedia.org/wiki/B%C3%A9zier_curve#Linear_curves\r\n\t\tlet bezierY = line1.y1 - line2.y1;\r\n\t\tlet bezierX = line1.x1 - line2.x1;\r\n\t\tlet numeratorLine2 = ((line2.x2 - line2.x1) * bezierY) - ((line2.y2 - line2.y1) * bezierX);\r\n\t\tlet numeratorLine1 = ((line1.x2 - line1.x1) * bezierY) - ((line1.y2 - line1.y1) * bezierX);\r\n\r\n\t\t// This is how far along the lines the overlapping point is, from 0 to 1\r\n\t\tlet bezierLine2 = numeratorLine2 / denominator;\r\n\t\tlet bezierLine1 = numeratorLine1 / denominator;\r\n\r\n\t\t// If line1 is a segment, and line2 is infinite, they intersect if bezierLine2 is between 0 and 1\r\n\t\tif ((bezierLine2 > 0 && bezierLine2 < 1) && (bezierLine1 > 0 && bezierLine1 < 1)) {\r\n\t\t\treturn {\r\n\t\t\t\tline1: line1,\r\n\t\t\t\tline2: line2,\r\n\t\t\t\tline1Angle: Math.atan2(line1.y2 - line1.y1, line1.x1 - line1.x2) * (180/Math.PI),\r\n\t\t\t\tline2Angle: Math.atan2(line2.y2 - line2.y1, line2.x1 - line2.x2) * (180/Math.PI),\r\n\t\t\t\tline1Impact: bezierLine2,\r\n\t\t\t\tline2Impact: bezierLine1,\r\n\t\t\t\tx: pointX,\r\n\t\t\t\ty: pointY,\r\n\t\t\t\tcollision: true\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tline1: line1,\r\n\t\t\tline2: line2,\r\n\t\t\tline1Impact: 0.5,\r\n\t\t\tline2Impact: 0.5,\r\n\t\t\tx: pointX,\r\n\t\t\ty: pointY,\r\n\t\t\tcollision: false\r\n\t\t};\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// incomingShape = Shape with more than one collision\r\n\t// impactedShape = Shape with one collision\r\n\t// collisions = Array of collisions for the incomingShape\r\n\t//------------------------------------------------\r\n\tselectCollidingLine(incomingShape, impactedShape, collisions, angleName) {\r\n\t\tlet collisionData = {};\r\n\t\tif (Math.abs(impactedShape.xSpeed) > Math.abs(impactedShape.ySpeed)) {\r\n\t\t\tif (impactedShape.xSpeed > 0 || (impactedShape.xSpeed < 0 && incomingShape.xSpeed < 0 && incomingShape.xSpeed < impactedShape.xSpeed)) {\r\n\t\t\t\tif (collisions[0].y > incomingShape.center.y) {\r\n\t\t\t\t\tcollisionData = (collisions[0][angleName] > collisions[1][angleName]) ? collisions[0] : collisions[1];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcollisionData = (collisions[0][angleName] < collisions[1][angleName]) ? collisions[0] : collisions[1];\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (collisions[0].y > incomingShape.center.y) {\r\n\t\t\t\t\tcollisionData = (collisions[0][angleName] < collisions[1][angleName]) ? collisions[0] : collisions[1];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcollisionData = (collisions[0][angleName] > collisions[1][angleName]) ? collisions[0] : collisions[1];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (impactedShape.ySpeed > 0 || (impactedShape.ySpeed < 0 && incomingShape.ySpeed < 0 && incomingShape.ySpeed < impactedShape.ySpeed)) {\r\n\t\t\t\tif (impactedShape.xSpeed > 0) {\r\n\t\t\t\t\tcollisionData = (collisions[0][angleName] > collisions[1][angleName]) ? collisions[0] : collisions[1];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcollisionData = (collisions[0][angleName] < collisions[1][angleName]) ? collisions[0] : collisions[1];\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (impactedShape.xSpeed > 0) {\r\n\t\t\t\t\tcollisionData = (collisions[0][angleName] < collisions[1][angleName]) ? collisions[0] : collisions[1];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcollisionData = (collisions[0][angleName] > collisions[1][angleName]) ? collisions[0] : collisions[1];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn collisionData;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Get the point of collision on an impacted line,\r\n\t// and get where it was in the previous frame,\r\n\t// then work out the overall speed. This approach\r\n\t// factors in rotation when calculating overall speed\r\n\t//------------------------------------------------\r\n\tgetCollisionSpeeds(shape, lineID, lineImpact) {\r\n\t\tlet segmentData = shape.getLineSegments()[lineID];\r\n\t\tlet previousSegmentData = shape.getPreviousLineSegments()[lineID];\r\n\t\tlet prevPoint = {\r\n\t\t\tx: previousSegmentData.x1 + ((previousSegmentData.x2 - previousSegmentData.x1) * lineImpact),\r\n\t\t\ty: previousSegmentData.y1 + ((previousSegmentData.y2 - previousSegmentData.y1) * lineImpact)\r\n\t\t};\r\n\t\tlet thisPoint = {\r\n\t\t\tx: segmentData.x1 + ((segmentData.x2 - segmentData.x1) * lineImpact),\r\n\t\t\ty: segmentData.y1 + ((segmentData.y2 - segmentData.y1) * lineImpact)\r\n\t\t};\r\n\t\t// Shape's point's position difference (AKA speed)\r\n\t\tlet shapeXSpeed = thisPoint.x - prevPoint.x;\r\n\t\tlet shapeYSpeed = thisPoint.y - prevPoint.y;\r\n\t\treturn {\r\n\t\t\tx: shapeXSpeed,\r\n\t\t\ty: shapeYSpeed\r\n\t\t};\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Move a shape back in the direction it came. This\r\n\t// is required immediately after a collision to make\r\n\t// sure the two shapes stop colliding\r\n\t//------------------------------------------------\r\n\treverseShape(shape, collisionSpeeds) {\r\n\t\tlet reverseX = 0;\r\n\t\tif (Math.abs(shape.xSpeed) > Math.abs(collisionSpeeds.x)) {\r\n\t\t\treverseX = shape.xSpeed;\r\n\t\t} else {\r\n\t\t\tif (shape.xSpeed > 0) {\r\n\t\t\t\treverseX = Math.abs(collisionSpeeds.x);\r\n\t\t\t} else {\r\n\t\t\t\treverseX = -Math.abs(collisionSpeeds.x);\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet reverseY = 0;\r\n\t\tif (Math.abs(shape.ySpeed) > Math.abs(collisionSpeeds.y)) {\r\n\t\t\treverseY = shape.ySpeed;\r\n\t\t} else {\r\n\t\t\tif (shape.ySpeed > 0) {\r\n\t\t\t\treverseY = Math.abs(collisionSpeeds.y);\r\n\t\t\t} else {\r\n\t\t\t\treverseY = -Math.abs(collisionSpeeds.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet shapePosition = shape.getPosition();\r\n\t\tshape.setPosition(shapePosition.x + (reverseX*-3), shapePosition.y + (reverseY*-3));\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Work out how the shape should turn after a collision\r\n\t// The further away the impact is from the center \r\n\t// of mass, the stronger the resulting rotation\r\n\t//------------------------------------------------\r\n\tcalculateNewRotation(shape, collisionData, collisionSpeeds, incomingSpeeds) {\r\n\t\t// Keep the angle between 0 - 180 degrees, as that's all we really need\r\n\t\tlet lineAngle = collisionData.line2Angle;\r\n\t\tif (lineAngle < 0) {\r\n\t\t\tlineAngle = Math.abs(lineAngle);\r\n\t\t} else {\r\n\t\t\tlineAngle = (360 - lineAngle) - 180;\r\n\t\t}\r\n\t\t// Get distance between impact point and object's center of mass (origin)\r\n\t\tlet distance = Math.sqrt((collisionData.x - shape.origin.x) * (collisionData.x - shape.origin.x) + (collisionData.y - shape.origin.y) * (collisionData.y - shape.origin.y));\r\n\t\tlet rotationStrength = (distance / (shape.width)) * Settings.MAX_ROTATION;\r\n\r\n\t\tif (lineAngle < 60 || lineAngle > 145) {\r\n\t\t\t// Line is more horizontal\r\n\t\t\tif (incomingSpeeds.y < 0 || (incomingSpeeds.y > 0 && collisionSpeeds.y > 0)) {\r\n\t\t\t\t// Other shape was moving up\r\n\t\t\t\tif (collisionData.x > shape.center.x) {\r\n\t\t\t\t\t// Impact point is on the right of the shape\r\n\t\t\t\t\tshape.rotationSpeed = -rotationStrength\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Impact point is on the left of the shape\r\n\t\t\t\t\tshape.rotationSpeed = rotationStrength;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// Other shape was moving down\r\n\t\t\t\tif (collisionData.x > shape.center.x) {\r\n\t\t\t\t\t// Impact point is on the right of the shape\r\n\t\t\t\t\tshape.rotationSpeed = rotationStrength;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Impact point is on the left of the shape\r\n\t\t\t\t\tshape.rotationSpeed = -rotationStrength;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// Line is more vertical\r\n\t\t\tif (incomingSpeeds.x < 0 || (collisionSpeeds.x > 0 && incomingSpeeds.x > 0)) {\r\n\t\t\t\t// Other shape was moving left\r\n\t\t\t\tif (collisionData.y > shape.center.y) {\r\n\t\t\t\t\t// Impact point is below center of shape\r\n\t\t\t\t\tshape.rotationSpeed = rotationStrength;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Impact point is above center of shape\r\n\t\t\t\t\tshape.rotationSpeed = -rotationStrength;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// Other shape was moving right\r\n\t\t\t\tif (collisionData.y > shape.center.y) {\r\n\t\t\t\t\t// Impact point is below center of shape\r\n\t\t\t\t\tshape.rotationSpeed = -rotationStrength;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Impact point is above center of shape\r\n\t\t\t\t\tshape.rotationSpeed = rotationStrength;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Work out how each shape should respond to the collision\r\n\t//------------------------------------------------\r\n\tcreateCollision(shape1, shape2, collisionData) {\r\n\t\tlet shape1LineIDs = [];\r\n\t\tlet shape2LineIDs = [];\r\n\t\tlet shape1Collisions = [];\r\n\t\tlet shape2Collisions = [];\r\n\t\t// Loop through collisions and find number of collisions per shape\r\n\t\tfor (let i = 0, length = collisionData.length; i < length; i++) {\r\n\t\t\tif (shape1LineIDs.indexOf(collisionData[i].line1ID) < 0) {\r\n\t\t\t\tshape1LineIDs.push(collisionData[i].line1ID);\r\n\t\t\t\tshape1Collisions.push(collisionData[i]);\r\n\t\t\t}\r\n\t\t\tif (shape2LineIDs.indexOf(collisionData[i].line2ID) < 0) {\r\n\t\t\t\tshape2LineIDs.push(collisionData[i].line2ID);\r\n\t\t\t\tshape2Collisions.push(collisionData[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (shape1LineIDs.length === 1 && shape2LineIDs.length === 1) {\r\n\t\t\t// Only one line crossed, so use that directly\r\n\t\t\tcollisionData = collisionData[0];\r\n\t\t} else {\r\n\t\t\t// Choose which line collision we care about\r\n\t\t\tif (shape1LineIDs.length > 1) {\r\n\t\t\t\t// 2 points of impact on shape 1\r\n\t\t\t\tcollisionData = this.selectCollidingLine(shape1, shape2, shape1Collisions, \"line1Angle\");\r\n\t\t\t} else {\r\n\t\t\t\t// 2 points of impact on shape 2\r\n\t\t\t\tcollisionData = this.selectCollidingLine(shape2, shape1, shape2Collisions, \"line2Angle\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet previousShape1XSpeed = shape1.xSpeed;\r\n\t\tlet previousShape1YSpeed = shape1.ySpeed;\r\n\t\tlet previousShape2XSpeed = shape2.xSpeed;\r\n\t\tlet previousShape2YSpeed = shape2.ySpeed;\r\n\r\n\t\t// We need to work out the exact point of impact on each shape\r\n\t\t// and how far that point travelled in the previous frame\r\n\t\t// So first we calculate the point of impact in the current frame,\r\n\t\t// and that same point as it was in the previous frame\r\n\t\t// Shape 1's point:\r\n\t\tlet shape1CollisionSpeeds = this.getCollisionSpeeds(shape1, collisionData.line1ID, collisionData.line1Impact);\r\n\t\tlet shape2CollisionSpeeds = this.getCollisionSpeeds(shape2, collisionData.line2ID, collisionData.line2Impact);\r\n\r\n\t\t// Store the previous rotation value for each shape\r\n\t\tlet previousShape1Rotation = shape1.rotationSpeed;\r\n\t\tlet previousShape2Rotation = shape2.rotationSpeed;\r\n\r\n\t\t\r\n\r\n\t\t// Conservation of momentum, learned from the book Apress Foundation HTML5 Animation\r\n\t\tlet speedTotal = shape1.xSpeed - shape2.xSpeed;\r\n\t\tlet newXSpeed1 = (((shape1.mass - shape2.mass) * shape1.xSpeed + 2 * shape2.mass * shape2.xSpeed) / (shape1.mass + shape2.mass));\r\n\t\tlet newXSpeed2 = (speedTotal + newXSpeed1);\r\n\r\n\t\tspeedTotal = shape1.ySpeed - shape2.ySpeed;\r\n\t\tlet newYSpeed1 = (((shape1.mass - shape2.mass) * shape1.ySpeed + 2 * shape2.mass * shape2.ySpeed) / (shape1.mass + shape2.mass));\r\n\t\tlet newYSpeed2 = (speedTotal + newYSpeed1);\r\n\r\n\t\t// TODO: We need to add a portion of randomness to the resulting speeds\r\n\t\t// This is to avoid shapes repeatedly bouncing off each other back and forth\r\n\t\t\r\n\t\t\r\n\t\t// Make sure shapes don't continue moving into each other\r\n\t\tlet shape1Position = shape1.getPosition();\r\n\t\tlet shape2Position = shape2.getPosition();\r\n\r\n\t\tif (newYSpeed1 > 0 && newYSpeed2 > 0) {\r\n\t\t\tif (newYSpeed1 >= newYSpeed2 && shape1Position.y < shape2Position.y) {\r\n\t\t\t\tnewYSpeed1 *= -1;\r\n\t\t\t} else if (newYSpeed2 >= newYSpeed1 && shape1Position.y > shape2Position.y) {\r\n\t\t\t\tnewYSpeed2 *= -1;\r\n\t\t\t}\r\n\t\t} else if (newYSpeed1 < 0 && newYSpeed2 < 0) {\r\n\t\t\tif (newYSpeed1 <= newYSpeed2 && shape1Position.y > shape2Position.y) {\r\n\t\t\t\tnewYSpeed1 *= -1;\r\n\t\t\t} else if (newYSpeed2 <= newYSpeed1 && shape2Position.y > shape1Position.y) {\r\n\t\t\t\tnewYSpeed2 *= -1;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (newXSpeed1 > 0 && newXSpeed2 > 0) {\r\n\t\t\tif (newXSpeed1 >= newXSpeed2 && shape1Position.x < shape2Position.x) {\r\n\t\t\t\tnewXSpeed1 *= -1;\r\n\t\t\t} else if (newXSpeed2 >= newXSpeed1 && shape2Position.x > shape1Position.x) {\r\n\t\t\t\tnewXSpeed2 *= -1;\r\n\t\t\t}\r\n\t\t} else if (newXSpeed1 < 0 && newXSpeed2 < 0) {\r\n\t\t\tif (newXSpeed1 <= newXSpeed2 && shape1Position.x > shape2Position.x) {\r\n\t\t\t\tnewXSpeed1 *= -1;\r\n\t\t\t} else if (newXSpeed2 <= newXSpeed1 && shape2Position.x > shape1Position.x) {\r\n\t\t\t\tnewXSpeed2 *= -1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Draw collision data (debug mode)\r\n\t\tif (this.flightControlEnabled) {\r\n\t\t\tlet segmentData = shape1.getLineSegments()[collisionData.line1ID];\r\n\t\t\tlet thisPoint = {\r\n\t\t\t\tx: segmentData.x1 + ((segmentData.x2 - segmentData.x1) * collisionData.line1Impact),\r\n\t\t\t\ty: segmentData.y1 + ((segmentData.y2 - segmentData.y1) * collisionData.line1Impact)\r\n\t\t\t};\r\n\r\n\t\t\tlet tempShape = document.createElementNS(\"http://www.w3.org/2000/svg\", \"circle\");\r\n\t\t\ttempShape.setAttribute(\"fill\", \"#FF0066\");\r\n\t\t\ttempShape.setAttribute(\"cx\", thisPoint.x);\r\n\t\t\ttempShape.setAttribute(\"cy\", thisPoint.y);\r\n\t\t\ttempShape.setAttribute(\"r\", 5);\r\n\t\t\tthis.DOMElement.appendChild(tempShape);\r\n\t\t\tthis.flightControlShapes.push(tempShape);\r\n\r\n\t\t\tlet lineAngle = collisionData.line1Angle;\r\n\t\t\tlet color = \"#0000ff\";\r\n\t\t\tif (lineAngle < 0) {\r\n\t\t\t\tlineAngle = Math.abs(lineAngle);\r\n\t\t\t} else {\r\n\t\t\t\tcolor = \"#ff0066\";\r\n\t\t\t\tlineAngle = (360 - lineAngle) - 180;\r\n\t\t\t}\r\n\r\n\t\t\tlet line = collisionData.line1;\r\n\t\t\ttempShape = document.createElementNS(\"http://www.w3.org/2000/svg\", \"line\");\r\n\t\t\ttempShape.setAttribute(\"stroke-width\", 2);\r\n\t\t\ttempShape.setAttribute(\"stroke\", color);\r\n\t\t\ttempShape.setAttribute(\"fill\", \"transparent\");\r\n\t\t\ttempShape.setAttribute(\"x1\", line.x1);\r\n\t\t\ttempShape.setAttribute(\"x2\", line.x2);\r\n\t\t\ttempShape.setAttribute(\"y1\", line.y1);\r\n\t\t\ttempShape.setAttribute(\"y2\", line.y2);\r\n\t\t\tthis.DOMElement.appendChild(tempShape);\r\n\t\t\tthis.flightControlShapes.push(tempShape);\r\n\r\n\t\t\ttempShape = document.createElement(\"p\");\r\n\t\t\ttempShape.setAttribute(\"style\", \"position: absolute; color: \" + color + \"; top: \" + (line.y1-20) + \"px; left: \" + (line.x1+20) + \"px\");\r\n\t\t\ttempShape.innerHTML = lineAngle;\r\n\t\t\tdocument.body.appendChild(tempShape);\r\n\t\t\tthis.flightControlCopy.push(tempShape);\r\n\t\t}\r\n\r\n\t\tthis.calculateNewRotation(shape1, collisionData, shape1CollisionSpeeds, shape2CollisionSpeeds);\r\n\t\tthis.calculateNewRotation(shape2, collisionData, shape2CollisionSpeeds, shape1CollisionSpeeds);\r\n\r\n\t\tlet angleIncrement1 = 0;\r\n\t\tlet angleIncrement2 = 0;\r\n\r\n\t\t// Un-rotate by the biggest quantity\r\n\t\tif (Math.abs(previousShape1Rotation) > Math.abs(shape1.rotationSpeed)) {\r\n\t\t\tangleIncrement1 = (previousShape1Rotation*-3);\r\n\t\t} else {\r\n\t\t\tif (previousShape1Rotation > 0) {\r\n\t\t\t\tangleIncrement1 = (Math.abs(shape1.rotationSpeed)*-3);\r\n\t\t\t} else {\r\n\t\t\t\tangleIncrement1 = (Math.abs(shape1.rotationSpeed)*3);\r\n\t\t\t}\r\n\t\t}\r\n\t\tshape1.angle = shape1.angle + angleIncrement1;\r\n\r\n\t\tif (Math.abs(previousShape2Rotation) > Math.abs(shape2.rotationSpeed)) {\r\n\t\t\tangleIncrement2 = (previousShape2Rotation*-3);\r\n\t\t} else {\r\n\t\t\tif (previousShape2Rotation > 0) {\r\n\t\t\t\tangleIncrement2 = (Math.abs(shape2.rotationSpeed)*-3);\r\n\t\t\t} else {\r\n\t\t\t\tangleIncrement2 = (Math.abs(shape2.rotationSpeed)*3);\r\n\t\t\t}\r\n\t\t}\r\n\t\tshape2.angle = shape2.angle + angleIncrement2;\r\n\r\n\t\t// Reverse the shapes away from each other\r\n\t\tthis.reverseShape(shape1, shape1CollisionSpeeds);\r\n\t\tthis.reverseShape(shape2, shape2CollisionSpeeds);\r\n\r\n\t\t// Now switch to the new direction speeds\r\n\t\tshape1.xSpeed = newXSpeed1;\r\n\t\tshape1.ySpeed = newYSpeed1;\r\n\t\tshape2.xSpeed = newXSpeed2;\r\n\t\tshape2.ySpeed = newYSpeed2;\r\n\r\n\t\tlet stagePosition = 0;\r\n\t\tif (Math.random() > 0.5) {\r\n\t\t\tstagePosition = ((shape1.getBoundingBox().x + (shape1.getBoundingBox().width/2)) - this.stage.x) / this.stage.width;\r\n\t\t\tshape1.collide(stagePosition);\r\n\t\t} else {\r\n\t\t\tstagePosition = ((shape2.getBoundingBox().x + (shape2.getBoundingBox().width/2)) - this.stage.x) / this.stage.width;\r\n\t\t\tshape2.collide(stagePosition);\r\n\t\t}\r\n\r\n\t\tlet collisions = this.checkLineCollisions(shape1, shape2, true);\r\n\t\tif (collisions.length) {\r\n\t\t\t// Fail-safe: If the shapes are stuck together, just re-position one of them\r\n\t\t\t// somewhere on the screen\r\n\t\t\t// Should never get here, but better to be safe than sorry.\r\n\t\t\t// First try getting further away\r\n\t\t\tlet attempts = 0;\r\n\t\t\tlet startPos1 = shape1.getPosition();\r\n\t\t\tlet startPos2 = shape2.getPosition();\r\n\t\t\tlet attemptX = 0;\r\n\t\t\tlet attemptY = 0;\r\n\t\t\twhile (collisions.length && attempts < 50) {\r\n\t\t\t\tif (window.console) console.log(\"Shape adjusted 1\");\r\n\t\t\t\t//shape1.angle = shape1.angle - (angleIncrement1*3);\r\n\t\t\t\t//shape2.angle = shape2.angle - (angleIncrement2*3);\r\n\r\n\t\t\t\t// Make sure the shapes are moving in different directions\r\n\t\t\t\tif ((previousShape1XSpeed > 0 && previousShape2XSpeed > 0) || (previousShape1XSpeed < 0 && previousShape2XSpeed < 0)) {\r\n\t\t\t\t\tattemptX = -previousShape1XSpeed;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tattemptX = previousShape1XSpeed;\r\n\t\t\t\t}\r\n\t\t\t\tif ((previousShape1YSpeed > 0 && previousShape2YSpeed > 0) || (previousShape1YSpeed < 0 && previousShape2YSpeed < 0)) {\r\n\t\t\t\t\tattemptY = -previousShape1YSpeed;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tattemptY = previousShape1YSpeed;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tshape1.setPosition(shape1.getPosition().x - attemptX, shape1.getPosition().y - attemptY);\r\n\t\t\t\tshape2.setPosition(shape2.getPosition().x - previousShape2XSpeed, shape2.getPosition().y - previousShape2YSpeed);\r\n\t\t\t\t\r\n\t\t\t\tcollisions = this.checkLineCollisions(shape1, shape2, true);\r\n\t\t\t\tattempts++;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// If that didn't work, reset and try the opposite direction\r\n\t\t\tif (collisions.length) {\r\n\t\t\t\tattempts = 0;\r\n\t\t\t\tshape1.setPosition(startPos1.x, startPos1.y);\r\n\t\t\t\tshape2.setPosition(startPos2.x, startPos2.y);\r\n\t\t\t\twhile (collisions.length && attempts < 50) {\r\n\t\t\t\t\tif (window.console) console.log(\"Shape adjusted 2\");\r\n\r\n\t\t\t\t\tshape1.setPosition(shape1.getPosition().x + attemptX, shape1.getPosition().y + attemptY);\r\n\t\t\t\t\tshape2.setPosition(shape2.getPosition().x + previousShape2XSpeed, shape2.getPosition().y + previousShape2YSpeed);\r\n\t\t\t\t\t\r\n\t\t\t\t\tcollisions = this.checkLineCollisions(shape1, shape2, true);\r\n\t\t\t\t\tattempts++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Still have a problem? Seriously? Fine, reposition the shape altogether\r\n\t\t\tif (collisions.length) {\r\n\t\t\t\tif (window.console) console.log(\"Shape adjusted 3\");\r\n\t\t\t\tthis.findNewPosition(shape1);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Change the size of all shapes in the system to\r\n\t// suit the size of the browser window\r\n\t//------------------------------------------------\r\n\tresize(stage, strokeWidth, scale) {\r\n\t\tlet previousStage = this.stage;\r\n\t\t\r\n\t\tlet scaleChangeX = (stage.width / this.stage.width);\r\n\t\tlet scaleChangeY = stage.height / this.stage.height;\r\n\r\n\t\tthis.stage = stage;\r\n\t\tfor (let i = 0, length = this.shapes.length; i < length; i++) {\r\n\t\t\tlet currentPos = this.shapes[i].getPosition();\r\n\t\t\tthis.shapes[i].resize(strokeWidth, scale);\r\n\r\n\t\t\tlet boundingBox = this.shapes[i].getBoundingBox();\r\n\t\t\t// Calculate the new X position based on the shape's current position, while factoring in the scale change\r\n\t\t\tlet newX = stage.x + ((currentPos.x - previousStage.x) * scaleChangeX);\r\n\t\t\tif (newX > (stage.x + stage.width) - boundingBox.width) {\r\n\t\t\t\tnewX = (stage.x + stage.width) - (boundingBox.width+40);\r\n\t\t\t}\r\n\t\t\t// Do the same for the Y position\r\n\t\t\tlet newY = currentPos.y * scaleChangeY;\r\n\t\t\tif (currentPos.y + boundingBox.height + 40 > (stage.y + (stage.height/2))) {\r\n\t\t\t\tnewY = (stage.height/2) - ((boundingBox.height/2) + 40);\r\n\t\t\t} else if (currentPos.y < stage.y) {\r\n\t\t\t\tnewY = stage.y + ((boundingBox.height*scaleChangeY)/2);\r\n\t\t\t}\r\n\t\t\t// Gets the shape to update it's current position\r\n\t\t\tthis.shapes[i].setPosition(newX, newY);\r\n\t\t}\r\n\t\t// Loop through the newly positioned shapes, and if this new position \r\n\t\t// results in this shape overlapping another, find a new position for it\r\n\t\tfor (let i = 0, length = this.shapes.length; i < length; i++) {\r\n\t\t\tlet shape = this.shapes[i];\r\n\t\t\tthis.findNewPosition(shape);\r\n\t\t}\r\n\t\tthis.scale = scale;\r\n\t\tthis.strokeWidth = strokeWidth;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Find an empty area to place the passed shape\r\n\t//------------------------------------------------\r\n\tfindNewPosition(shape) {\r\n\t\tlet newX = this.stage.x, newY = this.stage.y;\r\n\t\twhile ((this.checkBoundingBoxes(shape) || this.checkScreenEdges(shape) || this.checkBackgroundLine(shape))) {\r\n\t\t\tshape.setPosition(newX, newY);\r\n\t\t\tnewX += 50;\r\n\t\t\tif (newX > (this.stage.x + this.stage.width)) {\r\n\t\t\t\tnewX = this.stage.x;\r\n\t\t\t\tnewY += 50;\r\n\t\t\t}\r\n\t\t\tif (newY > this.stage.y + ((this.stage.height/2) - 150)) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","////////////////////////////////////////////////////////////////////////////////\r\n// Syrup Sounds Website\r\n// Main Site Background\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nclass SiteBackground extends EventDispatcher {\r\n\r\n\t//------------------------------------------------\r\n\t// Constructor\r\n\t//------------------------------------------------\r\n\tconstructor(DOMElement) {\r\n\t\tsuper();\r\n\t\t// Variables\r\n\t\tthis.DOMElement = DOMElement;\r\n\t\tthis.shapesElement = this.DOMElement.querySelector(\".js-background-shapes\");\r\n\t\tthis.backgroundElement = this.DOMElement.querySelector(\".js-background-lines\");\r\n\t\tthis.currentScale = 1;\r\n\t\tthis.naturalScale = 1;\r\n\t\tthis.previousSection = 0;\r\n\t\tthis.currentSection = 0;\r\n\t\tthis.siteSections = 1;\r\n\t\tthis.originalStrokeWidth = 53;\r\n\t\tthis.previousScale = 1;\r\n\t\tthis.previousX = 0;\r\n\t\tthis.animating = false;\r\n\t\tthis.shapeSystems = [];\r\n\t\tthis.calculateScale();\r\n\t\tthis.frameRequest = null;\r\n\t\tthis.backgroundLines = null;\r\n\t\tthis.strokeWidth = this.currentScale * this.originalStrokeWidth;\r\n\t\tlet halfWidth = window.innerWidth/2;\r\n\t\tNATION.Utils.setStyle(this.DOMElement, {transformOrigin: halfWidth + \"px 50%\"});\r\n\t\tNATION.Utils.setStyle(this.DOMElement, {transform: \"translateX(0) scale(1)\"});\r\n\t\tthis.createBackgroundLines();\r\n\t\tthis.createShapeSystems();\r\n\t\tthis.createListeners();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\toverrideScale(newScale) {\r\n\t\tnewScale = this.naturalScale * newScale;\r\n\t\tthis.currentScale = newScale;\r\n\t\tthis.strokeWidth = this.currentScale * this.originalStrokeWidth;\r\n\t\tthis.resizeShapes();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\trandomiseBackgroundLines() {\r\n\t\tthis.backgroundLines.randomise();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tupdateShapeSpeeds() {\r\n\t\tfor (let i = 0, length = this.shapeSystems.length; i < length; i++) {\r\n\t\t\tthis.shapeSystems[i].updateSpeeds();\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\trandomiseShapes() {\r\n\t\tfor (let i = 0, length = this.shapeSystems.length; i < length; i++) {\r\n\t\t\tthis.shapeSystems[i].randomise();\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tshowOnlyArcs() {\r\n\t\tfor (let i = 0, length = this.shapeSystems.length; i < length; i++) {\r\n\t\t\tthis.shapeSystems[i].showArcs();\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tshowOnlyCorners() {\r\n\t\tfor (let i = 0, length = this.shapeSystems.length; i < length; i++) {\r\n\t\t\tthis.shapeSystems[i].showCorners();\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tshowOnlyTriangles() {\r\n\t\tfor (let i = 0, length = this.shapeSystems.length; i < length; i++) {\r\n\t\t\tthis.shapeSystems[i].showTriangles();\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tshowOnlyLines() {\r\n\t\tfor (let i = 0, length = this.shapeSystems.length; i < length; i++) {\r\n\t\t\tthis.shapeSystems[i].showLines();\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tshowOnlyCircles() {\r\n\t\tfor (let i = 0, length = this.shapeSystems.length; i < length; i++) {\r\n\t\t\tthis.shapeSystems[i].showCircles();\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tshowAllShapes() {\r\n\t\tfor (let i = 0, length = this.shapeSystems.length; i < length; i++) {\r\n\t\t\tthis.shapeSystems[i].showAllShapes();\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\trandomiseAll() {\r\n\t\tthis.randomiseShapes();\r\n\t\tthis.randomiseBackgroundLines();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Listen for requests to add a new shape\r\n\t//------------------------------------------------\r\n\tcreateListeners() {\r\n\t\twindow.addEventListener(\"resize\", (e) => this.onWindowResized(e));\r\n\t\tMediator.subscribe(Events.SHAPE_REQUESTED, (e) => this.onShapeRequested(e));\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Fade in the wole background at once\r\n\t//------------------------------------------------\r\n\tfadeIn(immediate) {\r\n\t\tif (!immediate) {\r\n\t\t\tthis.DOMElement.style.opacity = 0;\r\n\t\t\tNATION.Animation.start(this.DOMElement, {opacity: 1}, {duration: Settings.BG_FADE_DURTION});\r\n\t\t} else {\r\n\t\t\tthis.DOMElement.style.opacity = 1;\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Resize the background lines and shapes to suit\r\n\t// the new browser dimensions\r\n\t//------------------------------------------------\r\n\tresize() {\r\n\t\tif (this.frameRequest) {\r\n\t\t\tif (cancelAnimationFrame) cancelAnimationFrame(this.frameRequest);\r\n\t\t}\r\n\t\tthis.calculateScale();\r\n\t\tthis.strokeWidth = this.originalStrokeWidth * this.currentScale;\r\n\t\tthis.backgroundLines.resize(this.strokeWidth, this.currentScale);\r\n\r\n\t\tthis.resizeShapes();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tresizeShapes() {\r\n\t\tlet windowWidth = window.innerWidth;\r\n\t\tlet windowHeight = window.innerHeight;\r\n\r\n\t\tfor (let i = 0, length = this.shapeSystems.length; i < length; i++) {\r\n\t\t\tlet stage = {\r\n\t\t\t\tx: i * windowWidth,\r\n\t\t\t\ty: 0,\r\n\t\t\t\twidth: windowWidth,\r\n\t\t\t\theight: windowHeight\r\n\t\t\t};\r\n\t\t\tthis.shapeSystems[i].resize(stage, this.strokeWidth, this.currentScale);\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Work out the general scale for width and height\r\n\t// of browser - this is applied to shapes when\r\n\t// resizing them\r\n\t//------------------------------------------------\r\n\tcalculateScale() {\r\n\t\tlet widthScale = 0;\r\n\t\tif (window.innerWidth >= 1400) {\r\n\t\t\twidthScale = 1;\r\n\t\t} else {\r\n\t\t\twidthScale = window.innerWidth / 1400;\r\n\t\t}\r\n\t\tlet heightScale = 0;\r\n\t\tif (window.innerHeight >= 800) {\r\n\t\t\theightScale = 1;\r\n\t\t} else {\r\n\t\t\theightScale = window.innerHeight / 800;\r\n\t\t}\r\n\t\tthis.currentScale = (widthScale < heightScale) ? widthScale : heightScale;\r\n\t\tthis.naturalScale = this.currentScale;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Class that handles the creation and resizing of\r\n\t// the background lines\r\n\t//------------------------------------------------\r\n\tcreateBackgroundLines() {\r\n\t\tthis.backgroundLines = new BackgroundLines(this.backgroundElement, this.siteSections, this.strokeWidth);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Create each of the shape systems, one per section\r\n\t//------------------------------------------------\r\n\tcreateShapeSystems() {\r\n\t\tlet windowWidth = window.innerWidth;\r\n\t\tlet windowHeight = window.innerHeight;\r\n\t\tfor (let i = 0; i < this.siteSections; i++) {\r\n\t\t\tlet stage = {\r\n\t\t\t\tx: i * windowWidth,\r\n\t\t\t\ty: 0,\r\n\t\t\t\twidth: windowWidth,\r\n\t\t\t\theight: windowHeight\r\n\t\t\t};\r\n\t\t\tthis.shapeSystems.push(new ShapeSystem(this.shapesElement, this.backgroundLines, stage, this.strokeWidth, this.currentScale));\r\n\t\t}\r\n\t\tthis.shapeSystems[0].resume();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Scroll the background to an x position based on\r\n\t// the index of the section required\r\n\t//------------------------------------------------\r\n\tscrollToSection(index, duration, immediate) {\r\n\t\tif (this.animating) {\r\n\t\t\t// If we were already scrolling, that means deep linking is interupting the scroll\r\n\t\t\t// So here we make sure that he previous shape system has been paused, as it wont get to\r\n\t\t\t// it's 'complete' event.\r\n\t\t\tthis.shapeSystems[this.previousSection].pause();\r\n\t\t\tthis.shapeSystems[this.currentSection].pause();\r\n\t\t}\r\n\t\tthis.previousSection = this.currentSection;\r\n\t\tthis.currentSection = index;\r\n\t\tlet targetX = -(window.innerWidth/this.DOMElement.clientWidth) * 100* index;\r\n\t\tthis.shapeSystems[index].resume();\r\n\r\n\t\tif (!immediate) {\r\n\t\t\tthis.aniamting = true;\r\n\t\t\tNATION.Animation.start(this.DOMElement, {transform: \"translateX(\" + targetX + \"%) scale(1)\"}, {duration: duration, easing: \"easeInOutQuad\"}, (e) => this.onSectionScrollComplete(e));\r\n\t\t} else {\r\n\t\t\tNATION.Utils.setStyle(this.DOMElement, {transform: \"translateX(\" + targetX + \"%) scale(1)\"});\r\n\t\t\tthis.onSectionScrollComplete();\r\n\t\t}\r\n\t\tthis.previousScale = 1;\r\n\t\tthis.previousX = targetX;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Scale up while keeping a particular section centered\r\n\t//------------------------------------------------\r\n\tscaleSection(sectionID, newScale, duration = 0) {\r\n\t\tlet targetX = -(window.innerWidth/this.DOMElement.clientWidth) * 100  * sectionID;\r\n\t\tlet originX = (sectionID * window.innerWidth) + (window.innerWidth/2);\r\n\t\tNATION.Utils.setStyle(this.DOMElement, {transformOrigin: originX + \"px 50%\"});\r\n\t\tif (duration) {\r\n\t\t\tNATION.Animation.start(this.DOMElement, {transform: \"translateX(\" + targetX + \"%) scale(\" + newScale + \")\"}, {duration: duration, easing: \"easeInOutQuad\"}, (e) => this.onScaleComplete(e, sectionID));\r\n\t\t} else {\r\n\t\t\tNATION.Utils.setStyle(this.DOMElement, {transform: \"translateX(\" + targetX + \"%) scale(\" + newScale + \")\"});\r\n\t\t\tthis.onScaleComplete(null, sectionID);\r\n\t\t}\r\n\t\tthis.previousScale = newScale;\r\n\t\tthis.previousX = targetX;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Pause the previous shape section, since it's\r\n\t// off-screen now\r\n\t//------------------------------------------------\r\n\tonSectionScrollComplete(e) {\r\n\t\tthis.animating = false;\r\n\t\tthis.shapeSystems[this.previousSection].pause();\r\n\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Inform the app that scaling has finished\r\n\t//------------------------------------------------\r\n\tonScaleComplete(e, index) {\r\n\t\tif (index === 0) {\r\n\t\t\tthis.trigger(Events.INTRO_SCALE_COMPLETE);\r\n\t\t} else {\r\n\t\t\tthis.trigger(Events.SCALE_COMPLETE);\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Delay resizes to prevent killing the browser\r\n\t//------------------------------------------------\r\n\tonWindowResized(e) {\r\n\t\tthis.frameRequest = requestAnimationFrame(() => this.resize());\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Only create new shapes if not on a touch device\r\n\t// as otherwise this causes a user to have to double\r\n\t// click stuff to get anywhere\r\n\t//------------------------------------------------\r\n\tonShapeRequested(e) {\r\n\t\tif (!Settings.isTouchDevice) {\r\n\t\t\tthis.shapeSystems[this.currentSection].createNewShape(true);\r\n\t\t}\r\n\t}\r\n}","////////////////////////////////////////////////////////////////////////////////\r\n// Syrup Sounds Website\r\n// Options to control app output\r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nclass SiteOptions extends EventDispatcher {\r\n\r\n\t//------------------------------------------------\r\n\t// Constructor\r\n\t//------------------------------------------------\r\n\tconstructor(DOMElement) {\r\n\t\tsuper();\r\n\t\t// Variables\r\n\t\tthis.DOMElement = DOMElement;\r\n\t\tthis.SNAP_SEGMENTS = 9;\r\n\t\tthis.showCollisions = null;\r\n\t\tthis.hideCollisions = null;\r\n\t\tthis.randomiseShapes = null;\r\n\t\tthis.randomiseBackground = null;\r\n\t\tthis.randomiseAll = null;\r\n\t\tthis.originalShapeSpeed = Settings.MAX_SHAPE_SPEED;\r\n\t\tthis.originalRotationSpeed = Settings.MAX_ROTATION;\r\n\t\tthis.requestedScale = 1;\r\n\t\tthis.speedProgressBar = null;\r\n\t\tthis.scaleProgressBar = null;\r\n\t\tthis.speedDisplay = null;\r\n\t\tthis.scaleDisplay = null;\r\n\t\tthis.reset = null;\r\n\t\tthis.getReferences();\r\n\t\tthis.createProgressBars();\r\n\t\tthis.createListeners();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tcreateProgressBars() {\r\n\t\tvar options = {\r\n\t\t\tsnapSegments: this.SNAP_SEGMENTS,\r\n\t\t\thandlePositioning: \"inside\"\r\n\t\t};\r\n\t\tthis.speedProgressBar = new NATION.ProgressBar(this.DOMElement.querySelector(\".speed-progress-bar\"), options);\r\n\t\tthis.scaleProgressBar = new NATION.ProgressBar(this.DOMElement.querySelector(\".scale-progress-bar\"), options);\r\n\t\tthis.scaleProgressBar.setProgress(1);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tgetReferences() {\r\n\t\tthis.showCollisions = this.DOMElement.querySelector(\".show-collisions\");\r\n\t\tthis.hideCollisions = this.DOMElement.querySelector(\".hide-collisions\");\r\n\t\tthis.randomiseShapes = this.DOMElement.querySelector(\".randomise-shapes\");\r\n\t\tthis.randomiseBackground = this.DOMElement.querySelector(\".randomise-background\");\r\n\t\tthis.randomiseAll = this.DOMElement.querySelector(\".randomise-all\");\r\n\t\tthis.shapesArcs = this.DOMElement.querySelector(\".shapes-arcs\");\r\n\t\tthis.shapesCorners = this.DOMElement.querySelector(\".shapes-corners\");\r\n\t\tthis.shapesTriangles = this.DOMElement.querySelector(\".shapes-triangles\");\r\n\t\tthis.shapesLines = this.DOMElement.querySelector(\".shapes-lines\");\r\n\t\tthis.shapesCircles = this.DOMElement.querySelector(\".shapes-circles\");\r\n\t\tthis.shapesAll = this.DOMElement.querySelector(\".shapes-all\");\r\n\t\tthis.speedDisplay = this.DOMElement.querySelector(\".speed .js-number-display\");\r\n\t\tthis.scaleDisplay = this.DOMElement.querySelector(\".scale .js-number-display\");\r\n\t\tthis.reset = this.DOMElement.querySelector(\".reset\");\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tcreateListeners() {\r\n\t\tthis.showCollisions.addEventListener(\"click\", (e) => this.onShowCollisionsClicked(e));\r\n\t\tthis.hideCollisions.addEventListener(\"click\", (e) => this.onHideCollisionsClicked(e));\r\n\t\tthis.randomiseShapes.addEventListener(\"click\", (e) => this.onRandomiseShapesClicked(e));\r\n\t\tthis.randomiseBackground.addEventListener(\"click\", (e) => this.onRandomiseBackgroundClicked(e));\r\n\t\tthis.randomiseAll.addEventListener(\"click\", (e) => this.onRandomiseAllClicked(e));\r\n\t\t// Shape selection\r\n\t\tthis.shapesArcs.addEventListener(\"click\", (e) => this.onArcsClicked(e));\r\n\t\tthis.shapesCorners.addEventListener(\"click\", (e) => this.onCornersClicked(e));\r\n\t\tthis.shapesTriangles.addEventListener(\"click\", (e) => this.onTrianglesClicked(e));\r\n\t\tthis.shapesLines.addEventListener(\"click\", (e) => this.onLinesClicked(e));\r\n\t\tthis.shapesCircles.addEventListener(\"click\", (e) => this.onCirclesClicked(e));\r\n\t\tthis.shapesAll.addEventListener(\"click\", (e) => this.onAllShapesClicked(e));\r\n\t\tthis.reset.addEventListener(\"click\", (e) => this.onResetClicked(e));\r\n\t\tthis.speedProgressBar.addListener(this.speedProgressBar.VALUE_CHANGED, (e) => this.onSpeedChanged(e));\r\n\t\tthis.scaleProgressBar.addListener(this.scaleProgressBar.VALUE_CHANGED, (e) => this.onScaleChanged(e));\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tshowActive(element) {\r\n\t\tif (element.className.search(\"active\") < 0) {\r\n\t\t\telement.className += \" active\";\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tshowInactive(element) {\r\n\t\telement.className = element.className.replace(/ active|active/gi, \"\");\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tonRandomiseShapesClicked(e) {\r\n\t\tthis.trigger(Events.RANDOMISE_SHAPES);\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tonRandomiseBackgroundClicked(e) {\r\n\t\tthis.trigger(Events.RANDOMISE_BACKGROUND_LINES);\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tonRandomiseAllClicked(e) {\r\n\t\tthis.trigger(Events.RANDOMISE_ALL);\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tonShowCollisionsClicked(e) {\r\n\t\tthis.showActive(this.showCollisions);\r\n\t\tthis.showInactive(this.hideCollisions);\r\n\t\tthis.trigger(Events.ENABLE_DEBUG_MODE);\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tonHideCollisionsClicked(e) {\r\n\t\tthis.showActive(this.hideCollisions);\r\n\t\tthis.showInactive(this.showCollisions);\r\n\t\tthis.trigger(Events.DISABLE_DEBUG_MODE);\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tonArcsClicked(e) {\r\n\t\tthis.showActive(this.shapesArcs);\r\n\t\tthis.showInactive(this.shapesCorners);\r\n\t\tthis.showInactive(this.shapesTriangles);\r\n\t\tthis.showInactive(this.shapesLines);\r\n\t\tthis.showInactive(this.shapesCircles);\r\n\t\tthis.showInactive(this.shapesAll);\r\n\t\tthis.trigger(Events.SHOW_ONLY_ARCS);\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tonCornersClicked(e) {\r\n\t\tthis.showInactive(this.shapesArcs);\r\n\t\tthis.showActive(this.shapesCorners);\r\n\t\tthis.showInactive(this.shapesTriangles);\r\n\t\tthis.showInactive(this.shapesLines);\r\n\t\tthis.showInactive(this.shapesCircles);\r\n\t\tthis.showInactive(this.shapesAll);\r\n\t\tthis.trigger(Events.SHOW_ONLY_CORNERS);\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tonTrianglesClicked(e) {\r\n\t\tthis.showInactive(this.shapesArcs);\r\n\t\tthis.showInactive(this.shapesCorners);\r\n\t\tthis.showActive(this.shapesTriangles);\r\n\t\tthis.showInactive(this.shapesLines);\r\n\t\tthis.showInactive(this.shapesCircles);\r\n\t\tthis.showInactive(this.shapesAll);\r\n\t\tthis.trigger(Events.SHOW_ONLY_TRIANGLES);\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tonLinesClicked(e) {\r\n\t\tthis.showInactive(this.shapesArcs);\r\n\t\tthis.showInactive(this.shapesCorners);\r\n\t\tthis.showInactive(this.shapesTriangles);\r\n\t\tthis.showActive(this.shapesLines);\r\n\t\tthis.showInactive(this.shapesCircles);\r\n\t\tthis.showInactive(this.shapesAll);\r\n\t\tthis.trigger(Events.SHOW_ONLY_LINES);\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tonCirclesClicked(e) {\r\n\t\tthis.showInactive(this.shapesArcs);\r\n\t\tthis.showInactive(this.shapesCorners);\r\n\t\tthis.showInactive(this.shapesTriangles);\r\n\t\tthis.showInactive(this.shapesLines);\r\n\t\tthis.showActive(this.shapesCircles);\r\n\t\tthis.showInactive(this.shapesAll);\r\n\t\tthis.trigger(Events.SHOW_ONLY_CIRCLES);\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tonAllShapesClicked(e) {\r\n\t\tthis.showInactive(this.shapesArcs);\r\n\t\tthis.showInactive(this.shapesCorners);\r\n\t\tthis.showInactive(this.shapesTriangles);\r\n\t\tthis.showInactive(this.shapesLines);\r\n\t\tthis.showInactive(this.shapesCircles);\r\n\t\tthis.showActive(this.shapesAll);\r\n\t\tthis.trigger(Events.SHOW_ALL_SHAPES);\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tonSpeedChanged(e) {\r\n\t\tSettings.MAX_SHAPE_SPEED = this.originalShapeSpeed + (this.originalShapeSpeed * (15 * this.speedProgressBar.getPercentage()));\r\n\t\tSettings.MAX_ROTATION = this.originalRotationSpeed + (this.originalRotationSpeed * (15 * this.speedProgressBar.getPercentage()));\r\n\t\tthis.speedDisplay.innerHTML = Settings.MAX_SHAPE_SPEED.toFixed(2);\r\n\t\tthis.trigger(Events.UPDATE_SHAPE_SPEEDS);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tonScaleChanged(e) {\r\n\t\tthis.requestedScale = 0.1 + (0.9 * this.scaleProgressBar.getPercentage());\r\n\t\tthis.scaleDisplay.innerHTML = this.requestedScale.toFixed(2);\r\n\t\tthis.trigger(Events.SCALE_CHANGE_REQUESTED);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tonResetClicked(e) {\r\n\t\t// Reset progress bars\r\n\t\tif (this.scaleProgressBar.getPercentage() !== 1) {\r\n\t\t\tthis.scaleProgressBar.setProgress(1);\r\n\t\t\tthis.onScaleChanged(e);\r\n\t\t}\r\n\t\tif (this.speedProgressBar.getPercentage() !== 0) {\r\n\t\t\tthis.speedProgressBar.setProgress(0);\r\n\t\t\tthis.onSpeedChanged(e);\r\n\t\t}\r\n\r\n\t\t// Reset other settings\r\n\t\tthis.onHideCollisionsClicked(e);\r\n\t\tif (this.shapesAll.className.search(\"active\") < 0) {\r\n\t\t\tthis.onAllShapesClicked(e);\r\n\t\t}\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t}\r\n}","////////////////////////////////////////////////////////////////////////////////\r\n// Syrup Sounds Website\r\n// \r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nclass SiteSettings {\r\n\r\n\t//------------------------------------------------\r\n\t// Constructor\r\n\t//------------------------------------------------\r\n\tconstructor() {\r\n\t\tthis._isTouchDevice = (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));\r\n\t\tthis._isIPhone = (/iPhone/i.test(navigator.userAgent));\r\n\t\tif (this._isTouchDevice) {\r\n\t\t\tdocument.body.className += \" touch\";\r\n\t\t}\r\n\t\tthis._isIE9 = (document.body.className.search(/ie9/i) > -1);\r\n\t\tif (this._isIE9) {\r\n\t\t\tdocument.body.className += \" ie9\";\r\n\t\t}\r\n\t\tthis._iDevice = (/iPhone|iPad|iPod/i.test(navigator.userAgent));\r\n\t\tthis._isFirefox = (/firefox/i.test(navigator.userAgent));\r\n\t\tthis.maxShapeSpeed = 0.7;\r\n\t\tthis.maxRotation = 0.2;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Getters\r\n\t//------------------------------------------------\r\n\tget isTouchDevice() {\r\n\t\treturn this._isTouchDevice;\r\n\t}\r\n\r\n\tget isFirefox() {\r\n\t\treturn this._isFirefox;\r\n\t}\r\n\r\n\tget isIDevice() {\r\n\t\treturn this._iDevice;\r\n\t}\r\n\r\n\tget isIPhone() {\r\n\t\treturn this._isIPhone;\r\n\t}\r\n\r\n\tget IS_IE9() {\r\n\t\treturn this._isIE9;\r\n\t}\r\n\r\n\tget WORK_NAV_DURATION() {\r\n\t\treturn 400;\r\n\t}\r\n\r\n\tget WORK_ZOOM_DURATION() {\r\n\t\treturn 600;\r\n\t}\r\n\r\n\tget MAX_SHAPE_SPEED() {\r\n\t\treturn this.maxShapeSpeed;\r\n\t}\r\n\r\n\tget MAX_ROTATION() {\r\n\t\treturn this.maxRotation;\r\n\t}\r\n\r\n\tget MIN_TRANSITION_DURATION() {\r\n\t\treturn 1000;\r\n\t}\r\n\r\n\tget TRANSITION_MULTIPLIER() {\r\n\t\treturn 800;\r\n\t}\r\n\r\n\tget ZOOMED_OUT_SCALE() {\r\n\t\treturn 0.8;\r\n\t}\r\n\r\n\tget NAV_ZOOMED_OUT_SCALE() {\r\n\t\treturn 1.7;\r\n\t}\r\n\r\n\tset MAX_SHAPE_SPEED(value) {\r\n\t\tthis.maxShapeSpeed = value;\r\n\t}\r\n\r\n\tset MAX_ROTATION(value) {\r\n\t\tthis.maxRotation = value;\r\n\t}\r\n}","////////////////////////////////////////////////////////////////////////////////\r\n// Syrup Sounds Website\r\n// \r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nclass BasicShape extends EventDispatcher {\r\n\r\n\t//------------------------------------------------\r\n\t// Constructor\r\n\t//------------------------------------------------\r\n\tconstructor(DOMElement, color, strokeWidth, scale) {\r\n\t\tsuper();\r\n\t\t// Variables\r\n\t\tthis.DOMElement = DOMElement;\r\n\t\t\r\n\t\tthis.frameTimer = null;\r\n\t\tthis.endTime = 0;\r\n\t\tthis.currentTime = 0;\r\n\t\tthis.startTime = 0;\r\n\t\tthis.previousSegments = [];\r\n\r\n\t\tthis.shape = null;\r\n\t\tthis._mass = 1;\r\n\t\tthis.selectSpeed();\r\n\t\tthis._angle = Math.random() * 180;\r\n\t\tthis._colliders = [];\r\n\t\tthis.segments = [];\r\n\t\tthis.boundingBox = {};\r\n\t\tthis.segmentPath = \"\";\r\n\t\tthis.minX = 0;\r\n\t\tthis.minY = 0;\r\n\t\tthis.maxX = 0;\r\n\t\tthis.maxY = 0;\r\n\t\tthis.originX = 0;\r\n\t\tthis.originY = 0;\r\n\t\tthis.effectsShape = null;\r\n\t\tthis.boundingBoxGuide = null;\r\n\t\tthis.segmentGuide = null;\r\n\t\tthis.centerGuide = null;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Decide how fast this shape should move\r\n\t//------------------------------------------------\r\n\tselectSpeed() {\r\n\t\tthis._xSpeed = (Math.random() * (Settings.MAX_SHAPE_SPEED*2) - Settings.MAX_SHAPE_SPEED);\r\n\t\tthis._ySpeed = (Math.random() * (Settings.MAX_SHAPE_SPEED*2) - Settings.MAX_SHAPE_SPEED);\r\n\r\n\t\tif (this._xSpeed === 0) this._xSpeed = (Math.random() > 0.5) ? -Settings.MAX_SHAPE_SPEED : Settings.MAX_SHAPE_SPEED;\r\n\t\tif (this._ySpeed === 0) this._ySpeed = (Math.random() > 0.5) ? -Settings.MAX_SHAPE_SPEED : Settings.MAX_SHAPE_SPEED;\r\n\t\tthis._rotationSpeed = (Math.random() * (Settings.MAX_ROTATION*2)) - Settings.MAX_ROTATION;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Start rendering the collision model for this shape\r\n\t//------------------------------------------------\r\n\tshowCollisionModel() {\r\n\t\tthis.shape.setAttribute(\"stroke-opacity\", 0);\r\n\r\n\t\tthis.DOMElement.appendChild(this.boundingBoxGuide);\r\n\t\tthis.DOMElement.appendChild(this.centerGuide);\r\n\t\tthis.DOMElement.appendChild(this.segmentGuide);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Hide the collision model for this shape\r\n\t//------------------------------------------------\r\n\thideCollisionModel() {\r\n\t\tthis.shape.setAttribute(\"stroke-opacity\", 1);\r\n\r\n\t\tif (this.contains(this.boundingBoxGuide)) {\r\n\t\t\tthis.DOMElement.removeChild(this.boundingBoxGuide);\r\n\t\t\tthis.DOMElement.removeChild(this.centerGuide);\r\n\t\t\tthis.DOMElement.removeChild(this.segmentGuide);\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Getters\r\n\t//------------------------------------------------\r\n\tget color() {\r\n\t\treturn this._color;\r\n\t}\r\n\r\n\tget xSpeed() {\r\n\t\treturn this._xSpeed;\r\n\t}\r\n\r\n\tget ySpeed() {\r\n\t\treturn this._ySpeed;\r\n\t}\r\n\r\n\tget mass() {\r\n\t\treturn this._mass;\r\n\t}\r\n\r\n\tget rotationSpeed() {\r\n\t\treturn this._rotationSpeed;\r\n\t}\r\n\r\n\tget angle() {\r\n\t\treturn this._angle;\r\n\t}\r\n\r\n\tget colliders() {\r\n\t\treturn this._colliders;\r\n\t}\r\n\r\n\tget origin() {\r\n\t\treturn {\r\n\t\t\tx: this.originX,\r\n\t\t\ty: this.originY\r\n\t\t}\r\n\t}\r\n\r\n\tget width() {\r\n\t\treturn this.halfWidth*2;\r\n\t}\r\n\r\n\tget center() {\r\n\t\treturn {\r\n\t\t\tx: this.boundingBox.x + (this.boundingBox.width/2),\r\n\t\t\ty: this.boundingBox.y + (this.boundingBox.height/2)\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Setters\r\n\t//------------------------------------------------\r\n\tset xSpeed(value) {\r\n\t\tthis._xSpeed = value;\r\n\t}\r\n\r\n\tset ySpeed(value) {\r\n\t\tthis._ySpeed = value;\r\n\t}\r\n\r\n\tset mass(value) {\r\n\t\tthis.mass = value;\r\n\t}\r\n\r\n\tset rotationSpeed(value) {\r\n\t\tthis._rotationSpeed = value;\r\n\t}\r\n\r\n\tset angle(value) {\r\n\t\tthis._angle = value;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Draw the guides if required\r\n\t//------------------------------------------------\r\n\tdraw() {\r\n\t\tthis.boundingBoxGuide = document.createElementNS(\"http://www.w3.org/2000/svg\", \"rect\");\r\n\t\tthis.boundingBoxGuide.setAttribute(\"stroke-width\", 2);\r\n\t\tthis.boundingBoxGuide.setAttribute(\"fill\", \"transparent\");\r\n\t\tthis.boundingBoxGuide.setAttribute(\"stroke\", \"#ff0066\");\r\n\t\t\r\n\r\n\t\tthis.centerGuide = document.createElementNS(\"http://www.w3.org/2000/svg\", \"circle\");\r\n\t\tthis.centerGuide.setAttribute(\"r\", 10);\r\n\t\tthis.centerGuide.setAttribute(\"fill\", \"#ff0066\");\r\n\t\t\r\n\r\n\t\tthis.segmentGuide = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\r\n\t\tthis.segmentGuide.setAttribute(\"fill\", \"transparent\");\r\n\t\tthis.segmentGuide.setAttribute(\"stroke\", \"#000000\");\r\n\t\tthis.segmentGuide.setAttribute(\"stroke-width\", 2);\r\n\t\t\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Return the x/y co-ordinates of this shape\r\n\t//------------------------------------------------\r\n\tgetPosition() {\r\n\t\treturn {\r\n\t\t\tx: this.x,\r\n\t\t\ty: this.y\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\thide() {\r\n\t\tthis.shape.style.strokeOpacity = 0;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// \r\n\t//------------------------------------------------\r\n\tfadeIn() {\r\n\t\tNATION.Animation.start(this.shape, {strokeOpacity: 1}, {forcejs: true, duration: Settings.SHAPE_FADE_DURATION});\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// IE-friendly version of Node.contains\r\n\t//------------------------------------------------\r\n\tcontains(target) {\r\n\t\tif (!this.DOMElement.contains) {\r\n\t\t\treturn this.DOMElement === target || Boolean(this.DOMElement.compareDocumentPosition(target) & 16);\r\n\r\n\t\t} else {\r\n\t\t\treturn this.DOMElement.contains(target);\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Increment the current rotation\r\n\t//------------------------------------------------\r\n\tupdateRotation() {\r\n\t\tthis._angle += this._rotationSpeed;\r\n\t\tif (this._angle > 360) this._angle = 0;\r\n\t\tif (this._angle < 0) this._angle = 360;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Currently colliding with passed shape\r\n\t//------------------------------------------------\r\n\taddCollider(shape) {\r\n\t\tif (this._colliders.indexOf(shape) < 0) {\r\n\t\t\tthis._colliders.push(shape);\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// No longer colliding with passed shape\r\n\t//------------------------------------------------\r\n\tremoveCollider(shape) {\r\n\t\tfor (let i = 0, length = this._colliders.length; i < length; i++) {\r\n\t\t\tif (this._colliders[i] === shape) {\r\n\t\t\t\tthis._colliders.splice(i, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Set new x/y co-ordinate\r\n\t//------------------------------------------------\r\n\tsetPosition(x, y) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Returns x/y/width/height in an object\r\n\t//------------------------------------------------\r\n\tgetBoundingBox() {\r\n\t\treturn this.boundingBox;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Returns an array of line segments\r\n\t// Each is an object of x1,y1,x2,y2\r\n\t//------------------------------------------------\r\n\tgetLineSegments() {\r\n\t\treturn this.segments;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Return an array of the line segments for the shape\r\n\t// as it was in the previous frame\r\n\t//------------------------------------------------\r\n\tgetPreviousLineSegments() {\r\n\t\treturn this.previousSegments;\r\n\t}\r\n\t\r\n\r\n\t//------------------------------------------------\r\n\t// Check the stage bounds for collisions\r\n\t//------------------------------------------------\r\n\tupdate() {\r\n\t\tthis.x += this._xSpeed;\r\n\t\tthis.y += this._ySpeed;\r\n\t\tthis.updateRotation();\r\n\t\tthis.setPosition(this.x, this.y);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Remove this shape from the DOM\r\n\t//------------------------------------------------\r\n\tdestroy(immediate=false) {\r\n\t\tthis.hideCollisionModel();\r\n\t\tif (this.contains(this.shape)) {\r\n\t\t\tif (!immediate) {\r\n\t\t\t\tNATION.Animation.start(this.shape, {opacity: 1}, {duration: 100, easing: \"easeInOutQuad\"}, (e) => this.onShapeHidden(e));\r\n\t\t\t} else {\r\n\t\t\t\tthis.onShapeHidden();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\tif (this.contains(this.effectsShape)) {\r\n\t\t\tthis.DOMElement.removeChild(this.effectsShape);\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Remove this shape from the DOM\r\n\t//------------------------------------------------\r\n\tonShapeHidden() {\r\n\t\tNATION.Animation.stop(this.shape);\r\n\t\tthis.DOMElement.removeChild(this.shape);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Add the shape to the DOM\r\n\t//------------------------------------------------\r\n\taddToStage() {\r\n\t\tthis.DOMElement.appendChild(this.shape);\r\n\t\tthis.shape.style.strokeWidth = this.strokeWidth/2;\r\n\t\tthis.shape.style.opacity = 0;\r\n\t\tNATION.Animation.start(this.shape, {opacity: 1, strokeWidth: this.strokeWidth}, {duration: 1000, easing: \"easeInOutQuad\"});\r\n\t\t//this.DOMElement.appendChild(this.boundingBoxGuide);\r\n\t\t//this.DOMElement.appendChild(this.centerGuide);\r\n\t\t//this.DOMElement.appendChild(this.segmentGuide);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Show a visual effect after a collision, and request\r\n\t// for a sound to be played by the audio manager\r\n\t//------------------------------------------------\r\n\tcollide(stagePercentage, bgImpact) {\r\n\t\t// Play the visual impact effect if we're not rendering the bounding box\r\n\t\tif (this.effectsShape && !this.contains(this.boundingBoxGuide)) {\r\n\t\t\tif (this.frameTimer) {\r\n\t\t\t\tcancelAnimationFrame(this.frameTimer);\r\n\t\t\t}\r\n\t\t\tthis.endTime = Date.now() + 300;\r\n\t\t\tthis.currentTime = this.startTime = Date.now();\r\n\t\t\tthis.DOMElement.insertBefore(this.effectsShape, this.shape);\r\n\t\t\tthis.frameTimer = requestAnimationFrame(() => this.animateCollision());\r\n\t\t}\r\n\t\t// Play this shape's sound effect via the central audio manager\r\n\t\tthis.playCollisionSound(stagePercentage, bgImpact);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Get the audio manager to play this shape's collision sound\r\n\t//------------------------------------------------\r\n\tplayCollisionSound(percentage, bgImpact) {\r\n\t\t//AudioManager.playSound(this.audioID, percentage, bgImpact);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Progress the collision animation until complete\r\n\t//------------------------------------------------\r\n\tanimateCollision() {\r\n\t\tthis.currentTime = Date.now();\r\n\t\tlet progress = (this.currentTime - this.startTime) / (this.endTime - this.startTime);\r\n\t\tif (progress > 1) progress = 1;\r\n\r\n\t\tlet newWidth = this.strokeWidth + ((this.strokeWidth*0.6) * progress);\r\n\r\n\t\tthis.effectsShape.setAttribute(\"stroke-width\", newWidth);\r\n\t\tthis.effectsShape.setAttribute(\"stroke-opacity\", 0.9 * (1-progress));\r\n\r\n\t\tif (progress < 1) { \r\n\t\t\tthis.frameTimer = requestAnimationFrame(() => this.animateCollision());\r\n\t\t} else {\r\n\t\t\tif (this.contains(this.effectsShape)) {\r\n\t\t\t\tthis.DOMElement.removeChild(this.effectsShape);\r\n\t\t\t}\r\n\t\t\tcancelAnimationFrame(this.frameTimer);\r\n\t\t}\r\n\t}\r\n}","////////////////////////////////////////////////////////////////////////////////\r\n// Syrup Sounds Website\r\n// \r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nclass ArcShape extends BasicShape {\r\n\r\n\t//------------------------------------------------\r\n\t// Constructor\r\n\t//------------------------------------------------\r\n\tconstructor(DOMElement, color, strokeWidth, scale) {\r\n\t\tsuper();\r\n\t\tthis.DOMElement = DOMElement;\r\n\t\tthis._color = color;\r\n\t\t\r\n\t\tthis.originalHalfWidth = 140;\r\n\t\tthis.halfWidth = scale * this.originalHalfWidth;\r\n\r\n\t\tthis.strokeWidth = strokeWidth;\r\n\t\tthis.shape = null;\r\n\t\tthis.x = 0;\r\n\t\tthis.y = 0;\r\n\t\tthis.scale = scale;\r\n\t\tthis.boundingBoxGuide = null;\r\n\t\tthis.segmentGuide = null;\r\n\t\tthis.centerGuide = null;\r\n\t\t\r\n\t\tthis.arcStart = {};\r\n\t\tthis.arcEnd = {};\r\n\r\n\t\tthis.radius = (Math.random() > 0.7) ? 140 : 140 + (Math.random() * 140);\r\n\r\n\t\tthis.draw();\r\n\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Create the required SVG elements\r\n\t//------------------------------------------------\r\n\tdraw() {\r\n\t\tthis.shape = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\r\n\t\tlet path = \"M \" + this.x + \" \" + (this.y+this.halfWidth) + \" A \" + (this.radius*this.scale) + \" \" + (this.radius*this.scale) + \" 0 0 1 \";\r\n\t\tpath += (this.x + (this.halfWidth*2)) + \" \" + (this.y+this.halfWidth);\r\n\t\tthis.shape.setAttribute(\"d\", path);\r\n\t\tthis.shape.setAttribute(\"fill\", \"transparent\");\r\n\t\tthis.shape.setAttribute(\"stroke\", this.color);\r\n\t\tthis.shape.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\r\n\t\tthis.effectsShape = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\r\n\t\tthis.effectsShape.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\t\tthis.effectsShape.setAttribute(\"stroke-linecap\", \"butt\");\r\n\t\tthis.effectsShape.setAttribute(\"stroke\", this.color);\r\n\t\tthis.effectsShape.setAttribute(\"fill\", \"transparent\");\r\n\r\n\t\tsuper.draw();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Change the x/y co-ordinates of the shape as a whole\r\n\t//------------------------------------------------\r\n\tsetPosition(x, y) {\r\n\t\tsuper.setPosition(x, y);\r\n\r\n\t\tthis.originX = x + (this.halfWidth);\r\n\t\tthis.originY = y + (this.halfWidth/2);\r\n\r\n\t\t// We need to build the collision model first, because where that line starts and ends\r\n\t\t// is where the visible arc has to start and end. The buildCollisionModel method stores\r\n\t\t// the Y pos of the first point as this.arcStart.y, and the Y pos of the last point as this.arcEndY\r\n\t\tthis.buildCollisionModel();\r\n\r\n\t\tlet tempX1 = 0;\r\n\t\tlet tempY1 = 0;\r\n\t\tlet tempX2 = 0;\r\n\t\tlet tempY2 = 0;\r\n\r\n\t\tlet path = \"M \";\r\n\t\tlet effectsPath = \"M \";\r\n\r\n\t\tlet angle = Math.abs(this._angle * Math.PI / 180.0);\r\n\r\n\t\tlet testX = this.x;\r\n\t\t// Here we use the startY worked out by buildCollisionModel\r\n\t\tlet testY = this.arcStart.y;\r\n\t\ttempX1 =  Math.cos(angle) * (testX - this.originX) - Math.sin(angle) * (testY - this.originY) + this.originX\r\n\t\ttempY1 = Math.sin(angle) * (testX - this.originX) + Math.cos(angle) * (testY - this.originY) + this.originY;\r\n\t\tpath += tempX1 + \" \" + tempY1 + \" A \" + (this.radius*this.scale) + \" \" + (this.radius*this.scale) + \" 0 0 1 \";\r\n\t\ttestX = (this.x + (this.halfWidth*2));\r\n\t\t// Here we use the endY worked out by buildCollisionModel\r\n\t\ttestY = this.arcEnd.y;\r\n\t\ttempX2 =  Math.cos(angle) * (testX - this.originX) - Math.sin(angle) * (testY - this.originY) + this.originX\r\n\t\ttempY2 = Math.sin(angle) * (testX - this.originX) + Math.cos(angle) * (testY - this.originY) + this.originY;\r\n\r\n\t\tpath += tempX2 + \" \" + tempY2;\r\n\t\tthis.shape.setAttribute(\"d\", path);\r\n\r\n\t\tthis.effectsShape.setAttribute(\"d\", path);\r\n\t}\r\n\t\r\n\r\n\t//------------------------------------------------\r\n\t// Recalculate the collision model, which is a series\r\n\t// of straight line segments running around the outside\r\n\t// of the arc\r\n\t//------------------------------------------------\r\n\tbuildCollisionModel() {\r\n\t\tlet minX = 0;\r\n\t\tlet minY = 0;\r\n\t\tlet maxX = 0;\r\n\t\tlet maxY = 0;\r\n\t\tlet point1 = {};\r\n\t\tlet point2 = {};\r\n\r\n\t\t// We need to find the angle of the circle that the resulting arc represents\r\n\t\t// This involves basic trig, eg. https://www.mathsisfun.com/algebra/trig-solving-sss-triangles.html\r\n\t\t// First we find the length of the line between the start and end points (horizontal)\r\n\t\tlet thisAngle = this.halfWidth*2;\r\n\t\t// Then we use trig to find the angle of the pie section at the circle's centre\r\n\t\t// The angle of the circle that the arc represents will always be the same as this.\r\n\t\tvar scaledRadius = (this.radius*this.scale);\r\n\t\tthisAngle = (Math.pow(scaledRadius, 2) + Math.pow(scaledRadius, 2) - Math.pow(thisAngle, 2)) / (2*scaledRadius*scaledRadius);\r\n\t\tthisAngle = Math.acos(thisAngle) * 180/Math.PI;\r\n\t\t// Now we can use this angle to work out where the arc's collision segments should be positioned\r\n\t\t// The maths is easy when we've got half a circle (180 degrees angle), but otherwise we need to offset the start and end positions\r\n\t\t// This keeps the arc centred, we just have to work out how far off -180 the start needs to be\r\n\r\n\t\tlet requiredSegments = 8;\r\n\t\t// Make sure the guide arc starts in the right place\r\n\t\tlet start = -((thisAngle/2)) - 90;\r\n\t\tlet end = -((thisAngle/2)) - 90;\r\n\t\tlet line = {};\r\n\t\t// Store the previous frame's segment data\r\n\t\tthis.previousSegments = this.segments;\r\n\t\tthis.segments = [];\r\n\t\tlet guidePath = \"\";\r\n\t\t// Convert angle to radians, since cos/sin take radians as their arg\r\n\t\tlet angle = this._angle * Math.PI / 180.0;\r\n\r\n\t\tlet arcCenterX = this.x + this.halfWidth;\r\n\t\tlet arcCenterY = this.originY + scaledRadius;\r\n\r\n\t\tlet radius = scaledRadius + (this.strokeWidth/2);\r\n\t\tlet rotatedArcStart = {};\r\n\r\n\t\tfor (let i = 0; i < requiredSegments; i++) {\r\n\t\t\tstart = end;\r\n\t\t\tend = start + (thisAngle/requiredSegments);\r\n\t\t\t// Work out positions needed for the actual green arc drawing\r\n\t\t\t// These remain un-rotated for now\r\n\t\t\tif (i === 0) {\r\n\t\t\t\tthis.arcStart = {\r\n\t\t\t\t\tx: parseInt(arcCenterX + scaledRadius * Math.cos(Math.PI * start/180)),\r\n\t\t\t\t\ty: parseInt(arcCenterY + scaledRadius * Math.sin(Math.PI * start/180))\r\n\t\t\t\t};\r\n\t\t\t} else if (i === requiredSegments-1) { \r\n\t\t\t\tthis.arcEnd = {\r\n\t\t\t\t\tx: parseInt(arcCenterX + scaledRadius * Math.cos(Math.PI * end/180)),\r\n\t\t\t\t\ty: parseInt(arcCenterY + scaledRadius * Math.sin(Math.PI * end/180))\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tline = {};\r\n\t\t\t// Centre of circle + radius + cos or sin of angle in radians (Math.PI * angle in degrees / 180)\r\n\t\t\tlet testX1 = parseInt(arcCenterX + radius * Math.cos(Math.PI * start/180));\r\n\t\t\tlet testY1 = parseInt(arcCenterY + radius * Math.sin(Math.PI * start/180));\r\n\t\t\tlet testX2 = parseInt(arcCenterX + radius * Math.cos(Math.PI * end/180));\r\n\t\t\tlet testY2 = parseInt(arcCenterY + radius * Math.sin(Math.PI * end/180));\r\n\t\t\tpoint1 = this.rotateCoords(testX1, testY1, angle);\r\n\t\t\tpoint2 = this.rotateCoords(testX2, testY2, angle);\r\n\r\n\t\t\t// Store the rotated start position of the outer arc\r\n\t\t\tif (i === 0) {\r\n\t\t\t\trotatedArcStart = point1;\r\n\t\t\t}\r\n\r\n\t\t\t// Store the new line values\r\n\t\t\tline.x1 = point1.x;\r\n\t\t\tline.x2 = point2.x;\r\n\t\t\tline.y1 = point1.y;\r\n\t\t\tline.y2 = point2.y;\r\n\r\n\t\t\t// Build the guide path\r\n\t\t\tif (i === 0) {\r\n\t\t\t\tguidePath = \"M \" + line.x1 + \" \" + line.y1 + \" L \" + line.x2 + \" \" + line.y2;\r\n\t\t\t} else {\r\n\t\t\t\tguidePath += \" L \" + line.x2 + \" \" + line.y2;\r\n\t\t\t}\r\n\r\n\t\t\t// Update min/max values for the bounding box\r\n\t\t\tif (i === 0) {\r\n\t\t\t\tminX = maxX = line.x1;\r\n\t\t\t\tminY = maxY = line.y1;\r\n\t\t\t}\r\n\t\t\tif (line.x1 < minX) minX = line.x1;\r\n\t\t\tif (line.x2 < minX) minX = line.x2;\r\n\t\t\tif (line.x1 > maxX) maxX = line.x1;\r\n\t\t\tif (line.x2 > maxX) maxX = line.x2;\r\n\r\n\t\t\tif (line.y1 < minY) minY = line.y1;\r\n\t\t\tif (line.y2 < minY) minY = line.y2;\r\n\t\t\tif (line.y1 > maxY) maxY = line.y1;\r\n\t\t\tif (line.y2 > maxY) maxY = line.y2;\r\n\r\n\t\t\t// Add to the segments array\r\n\t\t\tthis.segments.push(line);\r\n\t\t}\r\n\r\n\t\t// Create a line joining the two arcs on the right side (the bottom of the arc)\r\n\t\tlet x1 = parseInt(arcCenterX + radius * Math.cos(Math.PI * end/180));\r\n\t\tlet y1 = parseInt(arcCenterY + radius * Math.sin(Math.PI * end/180));\r\n\t\tlet joinPoint1 = this.rotateCoords(x1, y1, angle);\r\n\t\tlet joinPoint2 = {};\r\n\r\n\t\t// Now draw the inner arc\r\n\t\tradius = scaledRadius - (this.strokeWidth/2);\r\n\t\tfor (let i = requiredSegments; i > 0; i--) {\r\n\t\t\tstart = end;\r\n\t\t\tend = start - (thisAngle/requiredSegments);\r\n\t\t\t// Work out positions needed for the actual green arc drawing\r\n\t\t\t// These remain un-rotated for now\r\n\t\t\tline = {};\r\n\t\t\t// Centre of circle + radius + cos or sin of angle in radians (Math.PI * angle in degrees / 180)\r\n\t\t\tlet testX1 = parseInt(arcCenterX + radius * Math.cos(Math.PI * start/180));\r\n\t\t\tlet testY1 = parseInt(arcCenterY + radius * Math.sin(Math.PI * start/180));\r\n\t\t\tlet testX2 = parseInt(arcCenterX + radius * Math.cos(Math.PI * end/180));\r\n\t\t\tlet testY2 = parseInt(arcCenterY + radius * Math.sin(Math.PI * end/180));\r\n\t\t\tpoint1 = this.rotateCoords(testX1, testY1, angle);\r\n\t\t\tpoint2 = this.rotateCoords(testX2, testY2, angle);\r\n\r\n\t\t\t// Create the joining line between the two arcs\r\n\t\t\tif (i === requiredSegments) {\r\n\t\t\t\tjoinPoint2 = point1;\r\n\t\t\t\tlet joinLine = {\r\n\t\t\t\t\tx1: joinPoint1.x,\r\n\t\t\t\t\ty1: joinPoint1.y,\r\n\t\t\t\t\tx2: joinPoint2.x,\r\n\t\t\t\t\ty2: joinPoint2.y\r\n\t\t\t\t};\r\n\t\t\t\tguidePath += \" L \" + joinLine.x2 + \" \" + joinLine.y2;\r\n\t\t\t\tthis.segments.push(joinLine);\r\n\t\t\t}\r\n\t\t\t// Store the new line values\r\n\t\t\tline.x1 = point1.x;\r\n\t\t\tline.x2 = point2.x;\r\n\t\t\tline.y1 = point1.y;\r\n\t\t\tline.y2 = point2.y;\r\n\r\n\t\t\t// Build the guide path\r\n\t\t\tif (i === 0) {\r\n\t\t\t\tguidePath = \"M \" + line.x1 + \" \" + line.y1 + \" L \" + line.x2 + \" \" + line.y2;\r\n\t\t\t} else {\r\n\t\t\t\tguidePath += \" L \" + line.x2 + \" \" + line.y2;\r\n\t\t\t}\r\n\r\n\t\t\t// Update min/max values for the bounding box\r\n\t\t\tif (i === 0) {\r\n\t\t\t\tminX = maxX = line.x1;\r\n\t\t\t\tminY = maxY = line.y1;\r\n\t\t\t}\r\n\t\t\tif (line.x1 < minX) minX = line.x1;\r\n\t\t\tif (line.x2 < minX) minX = line.x2;\r\n\t\t\tif (line.x1 > maxX) maxX = line.x1;\r\n\t\t\tif (line.x2 > maxX) maxX = line.x2;\r\n\r\n\t\t\tif (line.y1 < minY) minY = line.y1;\r\n\t\t\tif (line.y2 < minY) minY = line.y2;\r\n\t\t\tif (line.y1 > maxY) maxY = line.y1;\r\n\t\t\tif (line.y2 > maxY) maxY = line.y2;\r\n\r\n\t\t\t// Add to the segments array\r\n\t\t\tthis.segments.push(line);\r\n\r\n\t\t\t// If this is the end of the second arc, join back up to the first one\r\n\t\t\tif (i === 1) {\r\n\t\t\t\tjoinPoint2 = point2;\r\n\t\t\t\tlet joinLine = {\r\n\t\t\t\t\tx1: joinPoint2.x,\r\n\t\t\t\t\ty1: joinPoint2.y,\r\n\t\t\t\t\tx2: rotatedArcStart.x,\r\n\t\t\t\t\ty2: rotatedArcStart.y\r\n\t\t\t\t};\r\n\t\t\t\tguidePath += \" L \" + joinLine.x2 + \" \" + joinLine.y2;\r\n\t\t\t\tthis.segments.push(joinLine);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.segmentGuide.setAttribute(\"d\", guidePath);\r\n\r\n\t\t// Generate the bounding box\r\n\t\tthis.boundingBox.x = minX;\r\n\t\tthis.boundingBox.y = minY;\r\n\r\n\t\tthis.boundingBox.width = (maxX - minX);\r\n\t\tthis.boundingBox.height = (maxY - minY);\r\n\r\n\t\tthis.boundingBoxGuide.setAttribute(\"x\", this.boundingBox.x);\r\n\t\tthis.boundingBoxGuide.setAttribute(\"y\", this.boundingBox.y);\r\n\t\tthis.boundingBoxGuide.setAttribute(\"width\", this.boundingBox.width);\r\n\t\tthis.boundingBoxGuide.setAttribute(\"height\", this.boundingBox.height);\r\n\r\n\t\tthis.centerGuide.setAttribute(\"cx\", this.originX);\r\n\t\tthis.centerGuide.setAttribute(\"cy\", this.originY);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Work out the co-ordinates of a point after being\r\n\t// rotated by a given angle around the shape's origin\r\n\t//------------------------------------------------\r\n\trotateCoords(x, y, angle) {\r\n\t\tlet rotatedX = Math.cos(angle) * (x - this.originX) - Math.sin(angle) * (y - this.originY) + this.originX;\r\n\t\tlet rotatedY = Math.sin(angle) * (x - this.originX) + Math.cos(angle) * (y - this.originY) + this.originY;\r\n\t\treturn {\r\n\t\t\tx: rotatedX,\r\n\t\t\ty: rotatedY\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Change the radius of the arc to suit the current\r\n\t// browser dimensions, and change the stroke width\r\n\t//------------------------------------------------\r\n\tresize(strokeWidth, scale) {\r\n\t\tthis.strokeWidth = strokeWidth;\r\n\t\tthis.halfWidth = this.originalHalfWidth * scale;\r\n\t\tthis.scale = scale;\r\n\t\tthis.shape.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\t\tthis.shape.style.strokeWidth = this.strokeWidth;\r\n\t}\r\n}","////////////////////////////////////////////////////////////////////////////////\r\n// Syrup Sounds Website\r\n// \r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nclass CircleShape extends BasicShape {\r\n\r\n\t//------------------------------------------------\r\n\t// Constructor\r\n\t//------------------------------------------------\r\n\tconstructor(DOMElement, color, strokeWidth, scale) {\r\n\t\tsuper();\r\n\t\tthis.DOMElement = DOMElement;\r\n\t\tthis._color = color;\r\n\t\tthis.x = 0;\r\n\t\tthis.y = 0;\r\n\r\n\t\tthis.originalHalfWidth = 80;\r\n\t\tthis.halfWidth = scale * this.originalHalfWidth;\r\n\t\tthis.strokeWidth = strokeWidth;\r\n\r\n\t\tthis.draw();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Create the required SVG elements\r\n\t//------------------------------------------------\r\n\tdraw() {\r\n\t\tthis.shape = document.createElementNS(\"http://www.w3.org/2000/svg\", \"circle\");\r\n\t\tthis.shape.setAttribute(\"fill\", \"transparent\");\r\n\t\tthis.shape.setAttribute(\"stroke\", this.color);\r\n\t\tthis.shape.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\t\tthis.shape.setAttribute(\"r\", this.halfWidth);\r\n\r\n\t\tthis.effectsShape = document.createElementNS(\"http://www.w3.org/2000/svg\", \"circle\");\r\n\t\tthis.effectsShape.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\t\tthis.effectsShape.setAttribute(\"stroke-linecap\", \"butt\");\r\n\t\tthis.effectsShape.setAttribute(\"stroke\", this.color);\r\n\t\tthis.effectsShape.setAttribute(\"fill\", \"transparent\");\r\n\t\tthis.effectsShape.setAttribute(\"r\", this.halfWidth);\r\n\r\n\t\tsuper.draw();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Change the x/y position of the circle's center\r\n\t//------------------------------------------------\r\n\tsetPosition(x, y) {\r\n\t\tsuper.setPosition(x, y);\r\n\t\tthis.shape.setAttribute(\"cx\", x);\r\n\t\tthis.shape.setAttribute(\"cy\", y);\r\n\t\tthis.effectsShape.setAttribute(\"cx\", x);\r\n\t\tthis.effectsShape.setAttribute(\"cy\", y);\r\n\t\tthis.buildCollisionModel();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Calculate the straight line segments that should\r\n\t// run around the outside of the circle, that will\r\n\t// form the collision model for this shape\r\n\t//------------------------------------------------\r\n\tbuildCollisionModel() {\r\n\t\tlet tempX1 = 0;\r\n\t\tlet tempX2 = 0;\r\n\t\tlet tempY1 = 0;\r\n\t\tlet tempY2 = 0;\r\n\t\t// Increase this number to increase accuracy (less is better for performance)\r\n\t\tlet requiredSegments = 12;\r\n\t\t// Make sure the guide arc starts in the right place\r\n\t\tlet start = -180;\r\n\t\tlet end = -180;\r\n\t\tlet line = {};\r\n\t\t// Store the previous frame's segment data\r\n\t\tthis.previousSegments = this.segments;\r\n\t\tthis.segments = [];\r\n\t\tlet guidePath = \"\";\r\n\t\t// Convert angle to radians, since cos/sin take radians as their arg\r\n\t\tlet angle = this._angle * Math.PI / 180.0;\r\n\t\tfor (let i = 0; i < requiredSegments; i++) {\r\n\t\t\tstart = end;\r\n\t\t\tend = start + (360/requiredSegments);\r\n\t\t\tline = {};\r\n\t\t\tline.x1 = parseInt(this.x + (this.halfWidth+(this.strokeWidth/2)) * Math.cos(Math.PI * start/180));\r\n\t\t\tline.y1 = parseInt(this.y + (this.halfWidth+(this.strokeWidth/2)) * Math.sin(Math.PI * start/180));\r\n\t\t\tline.x2 = parseInt(this.x + (this.halfWidth+(this.strokeWidth/2)) * Math.cos(Math.PI * end/180));\r\n\t\t\tline.y2 = parseInt(this.y + (this.halfWidth+(this.strokeWidth/2)) * Math.sin(Math.PI * end/180));\r\n\t\t\t// Build the guide path\r\n\t\t\tif (i === 0) {\r\n\t\t\t\tguidePath = \"M \" + line.x1 + \" \" + line.y1 + \" L \" + line.x2 + \" \" + line.y2;\r\n\t\t\t} else {\r\n\t\t\t\tguidePath += \" L \" + line.x2 + \" \" + line.y2;\r\n\t\t\t}\r\n\t\t\t// Add to the segments array\r\n\t\t\tthis.segments.push(line);\r\n\t\t}\r\n\t\tthis.segmentGuide.setAttribute(\"d\", guidePath);\r\n\r\n\t\t// Update bounding box\r\n\t\tthis.boundingBox.x = this.x - (this.halfWidth + (this.strokeWidth/2));\r\n\t\tthis.boundingBox.y = this.y - (this.halfWidth + (this.strokeWidth/2));\r\n\t\tthis.boundingBox.width = (this.halfWidth * 2) + this.strokeWidth;\r\n\t\tthis.boundingBox.height = this.boundingBox.width;\r\n\t\t// Update bounding box guide\r\n\t\tthis.boundingBoxGuide.setAttribute(\"x\", this.boundingBox.x);\r\n\t\tthis.boundingBoxGuide.setAttribute(\"y\", this.boundingBox.y);\r\n\t\tthis.boundingBoxGuide.setAttribute(\"width\", this.boundingBox.width);\r\n\t\tthis.boundingBoxGuide.setAttribute(\"height\", this.boundingBox.height);\r\n\t\t// Update the center point guide\r\n\t\tthis.centerGuide.setAttribute(\"cx\", this.x);\r\n\t\tthis.centerGuide.setAttribute(\"cy\", this.y);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Change the circle radius to match the current browser\r\n\t// dimensions, and change the stroke width\r\n\t//------------------------------------------------\r\n\tresize(strokeWidth, scale) {\r\n\t\tthis.strokeWidth = strokeWidth;\r\n\t\tthis.halfWidth = this.originalHalfWidth * scale;\r\n\t\tthis.shape.setAttribute(\"r\", this.halfWidth);\r\n\t\tthis.shape.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\t\tthis.shape.style.strokeWidth = this.strokeWidth;\r\n\r\n\t\tthis.effectsShape.setAttribute(\"r\", this.halfWidth);\r\n\t\tthis.effectsShape.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\t}\r\n}\r\n","////////////////////////////////////////////////////////////////////////////////\r\n// Syrup Sounds Website\r\n// \r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nclass LineShape extends BasicShape {\r\n\r\n\t//------------------------------------------------\r\n\t// Constructor\r\n\t//------------------------------------------------\r\n\tconstructor(DOMElement, color, strokeWidth, scale) {\r\n\t\tsuper();\r\n\t\tthis.DOMElement = DOMElement;\r\n\t\tthis._color = color;\r\n\r\n\t\tthis.originalHalfWidth = 150;\r\n\t\tthis.halfWidth = scale * this.originalHalfWidth;\r\n\t\tthis.strokeWidth = strokeWidth;\r\n\r\n\t\tthis.draw();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Create the required SVG elements\r\n\t//------------------------------------------------\r\n\tdraw() {\r\n\t\tthis.shape = document.createElementNS(\"http://www.w3.org/2000/svg\", \"line\");\r\n\t\tthis.shape.setAttribute(\"fill\", \"transparent\");\r\n\t\tthis.shape.setAttribute(\"stroke\", this.color);\r\n\t\tthis.shape.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\r\n\t\tthis.effectsShape = document.createElementNS(\"http://www.w3.org/2000/svg\", \"line\");\r\n\t\tthis.effectsShape.setAttribute(\"fill\", \"transparent\");\r\n\t\tthis.effectsShape.setAttribute(\"stroke-linecap\", \"butt\");\r\n\t\tthis.effectsShape.setAttribute(\"stroke\", this.color);\r\n\t\tthis.effectsShape.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\r\n\t\tsuper.draw();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Change the x/y position of the shape\r\n\t//------------------------------------------------\r\n\tsetPosition(x, y) {\r\n\t\tsuper.setPosition(x, y);\r\n\r\n\t\t// Perform rotation\r\n\t\tlet angle = this._angle * Math.PI / 180.0;\r\n\r\n\t\tlet x1 = x;\r\n\t\tlet x2 = x + (this.halfWidth*2);\r\n\t\tlet y1 = y;\r\n\t\tlet y2 = y;\r\n\r\n\t\tthis.originX = x + (this.halfWidth);\r\n\t\tthis.originY = y;\r\n\r\n\t\tlet tempx1 = Math.cos(angle) * (x1 - this.originX) - Math.sin(angle) * (y1 - this.originY) + this.originX;\r\n\t\tlet tempy1 = Math.sin(angle) * (x1 - this.originX) + Math.cos(angle) * (y1 - this.originY) + this.originY;\r\n\t\t\r\n\t\tlet tempx2 = Math.cos(angle) * (x2 - this.originX) - Math.sin(angle) * (y2 - this.originY) + this.originX;\r\n\t\tlet tempy2 = Math.sin(angle) * (x2 - this.originX) + Math.cos(angle) * (y2 - this.originY) + this.originY;\r\n\r\n\t\tthis.shape.setAttribute(\"x1\", tempx1);\r\n\t\tthis.shape.setAttribute(\"x2\", tempx2);\r\n\t\tthis.shape.setAttribute(\"y1\", tempy1);\r\n\t\tthis.shape.setAttribute(\"y2\", tempy2);\r\n\t\tthis.effectsShape.setAttribute(\"x1\", tempx1);\r\n\t\tthis.effectsShape.setAttribute(\"x2\", tempx2);\r\n\t\tthis.effectsShape.setAttribute(\"y1\", tempy1);\r\n\t\tthis.effectsShape.setAttribute(\"y2\", tempy2);\r\n\r\n\t\t// Work out the bounding box\r\n\t\tlet boxX = (tempx1 < tempx2) ? tempx1 : tempx2;\r\n\t\tlet boxY = (tempy1 < tempy2) ? tempy1 : tempy2;\r\n\t\tlet width = (tempx1 < tempx2) ? tempx2 - tempx1 : tempx1 - tempx2;\r\n\t\tlet height = (tempy1 < tempy2) ? tempy2 - tempy1 : tempy1 - tempy2;\r\n\t\tangle = (this._angle > 180) ? this._angle - 180 : this._angle;\r\n\t\tangle = Math.abs(angle * Math.PI / 180.0);\r\n\t\t\r\n\t\tthis.createLineSegments(angle, this.originX, this.originY);\r\n\t\tthis.updateBoundingBox();\r\n\r\n\t\tthis.centerGuide.setAttribute(\"cx\", this.originX);\r\n\t\tthis.centerGuide.setAttribute(\"cy\", this.originY);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Update the bounding box rect\r\n\t//------------------------------------------------\r\n\tupdateBoundingBox() {\r\n\t\tthis.boundingBox = {\r\n\t\t\tx: this.minX,\r\n\t\t\ty: this.minY,\r\n\t\t\twidth: this.maxX - this.minX,\r\n\t\t\theight: this.maxY - this.minY\r\n\t\t};\r\n\t\tthis.boundingBoxGuide.setAttribute(\"x\", this.boundingBox.x);\r\n\t\tthis.boundingBoxGuide.setAttribute(\"y\", this.boundingBox.y);\r\n\t\tthis.boundingBoxGuide.setAttribute(\"width\", this.boundingBox.width);\r\n\t\tthis.boundingBoxGuide.setAttribute(\"height\", this.boundingBox.height);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Recalculate the x/y of all points based on current\r\n\t// shape x/y, and angle of rotation\r\n\t//------------------------------------------------\r\n\tcreateLineSegments(angle, originX, originY) {\r\n\t\t// Store the previous frame's segment data\r\n\t\tthis.previousSegments = this.segments;\r\n\t\tthis.segments = [];\r\n\t\tthis.segmentPath = \"\";\r\n\t\tlet x1 = 0, y1 = 0, x2 = 0, y2 = 0;\r\n\t\tthis.minX = 0; this.minY = 0; this.maxX = 0; this.maxY = 0;\r\n\r\n\t\tx1 = this.x;\r\n\t\ty1 = this.y - (this.strokeWidth/2);\r\n\t\tx2 = this.x + (this.halfWidth*2);\r\n\t\ty2 = y1;\r\n\t\tthis.addSegment(x1, y1, x2, y2, angle, originX, originY);\r\n\r\n\t\tx1 = x2;\r\n\t\ty1 = y2;\r\n\t\tx2 = x2;\r\n\t\ty2 = this.y + (this.strokeWidth/2);\r\n\t\tthis.addSegment(x1, y1, x2, y2, angle, originX, originY);\r\n\r\n\t\tx1 = x2;\r\n\t\ty1 = y2;\r\n\t\tx2 = this.x;\r\n\t\ty2 = y2;\r\n\t\tthis.addSegment(x1, y1, x2, y2, angle, originX, originY);\r\n\r\n\t\tx1 = x2;\r\n\t\ty1 = y2;\r\n\t\tx2 = x2;\r\n\t\ty2 = this.y - (this.strokeWidth/2);\r\n\t\tthis.addSegment(x1, y1, x2, y2, angle, originX, originY);\r\n\r\n\t\tthis.segmentGuide.setAttribute(\"d\", this.segmentPath);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Calculate the position of a point after being rotated\r\n\t// by a given angle around the shape's origin\r\n\t//------------------------------------------------\r\n\taddSegment(x1, y1, x2, y2, angle, originX, originY) {\r\n\t\tlet tempx1 = Math.cos(angle) * (x1 - originX) - Math.sin(angle) * (y1 - originY) + originX;\r\n\t\tlet tempy1 = Math.sin(angle) * (x1 - originX) + Math.cos(angle) * (y1 - originY) + originY;\r\n\t\tlet tempx2 = Math.cos(angle) * (x2 - originX) - Math.sin(angle) * (y2 - originY) + originX;\r\n\t\tlet tempy2 = Math.sin(angle) * (x2 - originX) + Math.cos(angle) * (y2 - originY) + originY;\r\n\t\t// Set the min/max values to that of the first point, if they have yet to be set\r\n\t\tif (this.minX === 0 && this.minY === 0 && this.maxX === 0 && this.maxY === 0) {\r\n\t\t\tthis.minX = this.maxX = tempx1;\r\n\t\t\tthis.minY = this.maxY = tempy1;\r\n\t\t}\r\n\t\t// Add this new line to the collision segments\r\n\t\tthis.segments.push({x1: tempx1, y1: tempy1, x2: tempx2, y2: tempy2});\r\n\t\tif (this.segmentPath === \"\") {\r\n\t\t\tthis.segmentPath = \"M \" + tempx1 + \" \" + tempy1;\r\n\t\t}\r\n\t\tthis.segmentPath += \" L \" + tempx2 + \" \" + tempy2;\r\n\r\n\t\t// Update min/max values\r\n\t\tif (tempx1 < this.minX) this.minX = tempx1;\r\n\t\tif (tempx2 < this.minX) this.minX = tempx2;\r\n\t\tif (tempy1 < this.minY) this.minY = tempy1;\r\n\t\tif (tempy2 < this.minY) this.minY = tempy2;\r\n\r\n\t\tif (tempx1 > this.maxX) this.maxX = tempx1;\r\n\t\tif (tempx2 > this.maxX) this.maxX = tempx2;\r\n\t\tif (tempy1 > this.maxY) this.maxY = tempy1;\r\n\t\tif (tempy2 > this.maxY) this.maxY = tempy2;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Change the width of the shape and it's stroke width\r\n\t//------------------------------------------------\r\n\tresize(strokeWidth, scale) {\r\n\t\tthis.strokeWidth = strokeWidth;\r\n\t\tthis.halfWidth = this.originalHalfWidth * scale;\r\n\t\tthis.shape.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\t\tthis.shape.style.strokeWidth = this.strokeWidth;\r\n\t\t// We don't update the width of the effects shape stroke here,\r\n\t\t// since it could be currently animating\r\n\t}\r\n}","////////////////////////////////////////////////////////////////////////////////\r\n// Syrup Sounds Website\r\n// \r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nclass LShape extends BasicShape {\r\n\r\n\t//------------------------------------------------\r\n\t// Constructor\r\n\t//------------------------------------------------\r\n\tconstructor(DOMElement, color, strokeWidth, scale) {\r\n\t\tsuper();\r\n\t\t// Variables\r\n\t\tthis.DOMElement = DOMElement;\r\n\t\tthis._color = color;\r\n\r\n\t\tthis.originalHalfWidth = 100;\r\n\t\tthis.halfWidth = scale * this.originalHalfWidth;\r\n\t\tthis.strokeWidth = strokeWidth;\r\n\r\n\t\tthis.draw();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Draw the required svg elements\r\n\t//------------------------------------------------\r\n\tdraw() {\r\n\t\tthis.shape = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\r\n\t\tthis.shape.setAttribute(\"fill\", \"transparent\");\r\n\t\tthis.shape.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\t\tthis.shape.setAttribute(\"stroke\", this.color);\r\n\r\n\t\tthis.effectsShape = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\r\n\t\tthis.effectsShape.setAttribute(\"fill\", \"transparent\");\r\n\t\tthis.effectsShape.setAttribute(\"stroke-linecap\", \"butt\");\r\n\t\tthis.effectsShape.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\t\tthis.effectsShape.setAttribute(\"stroke\", this.color);\r\n\t\tsuper.draw();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Calculate the rotated x/y co-ordinates, and\r\n\t// store in the segment array\r\n\t//------------------------------------------------\r\n\taddSegment(x1, y1, x2, y2, angle, originX, originY) {\r\n\t\tlet tempx1 = Math.cos(angle) * (x1 - originX) - Math.sin(angle) * (y1 - originY) + originX;\r\n\t\tlet tempy1 = Math.sin(angle) * (x1 - originX) + Math.cos(angle) * (y1 - originY) + originY;\r\n\t\tlet tempx2 = Math.cos(angle) * (x2 - originX) - Math.sin(angle) * (y2 - originY) + originX;\r\n\t\tlet tempy2 = Math.sin(angle) * (x2 - originX) + Math.cos(angle) * (y2 - originY) + originY;\r\n\t\tthis.segments.push({x1: tempx1, y1: tempy1, x2: tempx2, y2: tempy2});\r\n\r\n\t\t// Set the min/max values to that of the first point, if they have yet to be set\r\n\t\tif (this.minX === 0 && this.minY === 0 && this.maxX === 0 && this.maxY === 0) {\r\n\t\t\tthis.minX = this.maxX = tempx1;\r\n\t\t\tthis.minY = this.maxY = tempy1;\r\n\t\t}\r\n\r\n\t\tif (this.segmentPath === \"\") {\r\n\t\t\tthis.segmentPath = \"M \" + tempx1 + \" \" + tempy1;\r\n\t\t}\r\n\t\tthis.segmentPath += \" L \" + tempx2 + \" \" + tempy2;\r\n\r\n\t\t// Update min/max values\r\n\t\tif (tempx1 < this.minX) this.minX = tempx1;\r\n\t\tif (tempx2 < this.minX) this.minX = tempx2;\r\n\t\tif (tempy1 < this.minY) this.minY = tempy1;\r\n\t\tif (tempy2 < this.minY) this.minY = tempy2;\r\n\r\n\t\tif (tempx1 > this.maxX) this.maxX = tempx1;\r\n\t\tif (tempx2 > this.maxX) this.maxX = tempx2;\r\n\t\tif (tempy1 > this.maxY) this.maxY = tempy1;\r\n\t\tif (tempy2 > this.maxY) this.maxY = tempy2;\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Generate new segment data based on current x and y position\r\n\t//------------------------------------------------\r\n\tcreateSegments(x, y, angle) {\r\n\t\tthis.minX = 0;\r\n\t\tthis.minY = 0;\r\n\t\tthis.maxX = 0;\r\n\t\tthis.maxY = 0;\r\n\t\t// Store the previous frame's segment data\r\n\t\tthis.previousSegments = this.segments;\r\n\t\t\r\n\t\tthis.segments = [];\r\n\t\tthis.segmentPath = \"\";\r\n\t\tlet x1 = x;\r\n\t\tlet y1 = y - (this.strokeWidth/2);\r\n\t\tlet x2 = x + (this.halfWidth*2) + (this.strokeWidth/2);\r\n\t\tlet y2 = y - (this.strokeWidth/2);\r\n\r\n\t\tthis.addSegment(x1, y1, x2, y2, angle, this.originX, this.originY);\r\n\r\n\t\tx1 = x2;\r\n\t\ty1 = y2;\r\n\t\tx2 = x2;\r\n\t\ty2 = y + (this.halfWidth*2);\r\n\t\tthis.addSegment(x1, y1, x2, y2, angle, this.originX, this.originY);\r\n\r\n\t\tx1 = x2;\r\n\t\ty1 = y2;\r\n\t\tx2 = x2 - (this.strokeWidth);\r\n\t\ty2 = y2;\r\n\t\tthis.addSegment(x1, y1, x2, y2, angle, this.originX, this.originY);\r\n\r\n\t\tx1 = x2;\r\n\t\ty1 = y2;\r\n\t\tx2 = x2;\r\n\t\ty2 = y + (this.strokeWidth/2);\r\n\t\tthis.addSegment(x1, y1, x2, y2, angle, this.originX, this.originY);\r\n\r\n\t\tx1 = x2;\r\n\t\ty1 = y2;\r\n\t\tx2 = x;\r\n\t\ty2 = y + (this.strokeWidth/2);\r\n\t\tthis.addSegment(x1, y1, x2, y2, angle, this.originX, this.originY);\r\n\r\n\t\tx1 = x2;\r\n\t\ty1 = y2;\r\n\t\tx2 = x2;\r\n\t\ty2 = y - (this.strokeWidth/2)\r\n\t\tthis.addSegment(x1, y1, x2, y2, angle, this.originX, this.originY);\r\n\r\n\t\tthis.segmentGuide.setAttribute(\"d\", this.segmentPath);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Calculate the co-ordinates of a point after \r\n\t// being rotated around the shape's origin\r\n\t//------------------------------------------------\r\n\trotateCoords(x, y, angle) {\r\n\t\tlet rotatedX = Math.cos(angle) * (x - this.originX) - Math.sin(angle) * (y - this.originY) + this.originX;\r\n\t\tlet rotatedY = Math.sin(angle) * (x - this.originX) + Math.cos(angle) * (y - this.originY) + this.originY;\r\n\t\treturn {\r\n\t\t\tx: rotatedX,\r\n\t\t\ty: rotatedY\r\n\t\t}\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Update the x/y co-ordinates of the shape\r\n\t//------------------------------------------------\r\n\tsetPosition(x, y) {\r\n\t\tsuper.setPosition(x, y);\r\n\t\t\r\n\t\tlet angle = this._angle * Math.PI / 180.0;\r\n\r\n\t\tthis.originX = x + (this.halfWidth*2);\r\n\t\tthis.originY = y;\r\n\r\n\t\tthis.createSegments(x, y, angle);\r\n\r\n\t\tthis.centerGuide.setAttribute(\"cx\", this.originX);\r\n\t\tthis.centerGuide.setAttribute(\"cy\", this.originY);\r\n\r\n\t\tlet path = \"\";\r\n\r\n\t\tlet point = this.rotateCoords(x, y, angle);\r\n\t\tpath = \"M \" + point.x + \" \" + point.y;\r\n\r\n\t\tpoint = this.rotateCoords(x + (this.halfWidth*2), y, angle);\r\n\t\tpath += \" L \" + point.x + \" \" + point.y;\r\n\r\n\t\tpoint = this.rotateCoords(x + (this.halfWidth*2), y + this.halfWidth*2, angle);\r\n\t\tpath += \" \" + point.x + \" \" + point.y;\r\n\r\n\t\tthis.shape.setAttribute(\"d\", path);\r\n\t\tthis.effectsShape.setAttribute(\"d\", path);\r\n\r\n\t\t// Figure out the new bounding box\r\n\t\tthis.boundingBox.x = this.minX;\r\n\t\tthis.boundingBox.y = this.minY;\r\n\t\tthis.boundingBox.width = (this.maxX - this.minX);\r\n\t\tthis.boundingBox.height = (this.maxY - this.minY);\r\n\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\r\n\t\tthis.boundingBoxGuide.setAttribute(\"x\", this.boundingBox.x);\r\n\t\tthis.boundingBoxGuide.setAttribute(\"y\", this.boundingBox.y);\r\n\t\tthis.boundingBoxGuide.setAttribute(\"width\", this.boundingBox.width);\r\n\t\tthis.boundingBoxGuide.setAttribute(\"height\", this.boundingBox.height);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Change the width/height of the shape and stroke width\r\n\t//------------------------------------------------\r\n\tresize(strokeWidth, scale) {\r\n\t\tthis.strokeWidth = strokeWidth;\r\n\t\tthis.halfWidth = this.originalHalfWidth * scale;\r\n\t\tthis.shape.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\t\tthis.shape.style.strokeWidth = this.strokeWidth;\r\n\t}\r\n}","////////////////////////////////////////////////////////////////////////////////\r\n// Syrup Sounds Website\r\n// \r\n////////////////////////////////////////////////////////////////////////////////\r\n\r\nclass TriangleShape extends BasicShape {\r\n\r\n\t//------------------------------------------------\r\n\t// Constructor\r\n\t//------------------------------------------------\r\n\tconstructor(DOMElement, color, strokeWidth, scale) {\r\n\t\tsuper();\r\n\t\tthis.DOMElement = DOMElement;\r\n\t\tthis._color = color;\r\n\t\tthis.x = 0;\r\n\t\tthis.y = 0;\r\n\r\n\t\tthis.originalHalfWidth = 90;\r\n\t\tthis.halfWidth = scale * this.originalHalfWidth;\r\n\t\tthis.strokeWidth = strokeWidth;\r\n\t\t\r\n\t\tthis.points = null;\r\n\t\tthis.pointArray = [];\r\n\r\n\t\tthis.draw();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Create the svg elements to be rendered later\r\n\t//------------------------------------------------\r\n\tdraw() {\r\n\t\tthis.shape = document.createElementNS(\"http://www.w3.org/2000/svg\", \"polygon\");\r\n\t\tthis.shape.setAttribute(\"fill\", \"transparent\");\r\n\t\tthis.shape.setAttribute(\"stroke\", this.color);\r\n\t\tthis.shape.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\r\n\t\tthis.effectsShape = document.createElementNS(\"http://www.w3.org/2000/svg\", \"polygon\");\r\n\t\tthis.effectsShape.setAttribute(\"fill\", \"transparent\");\r\n\t\tthis.effectsShape.setAttribute(\"stroke\", this.color);\r\n\t\tthis.effectsShape.setAttribute(\"stroke-linecap\", \"butt\");\r\n\t\tthis.effectsShape.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\r\n\t\tthis.generatePoints();\r\n\t\tsuper.draw();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Figure out the 3 points for the triangle, while\r\n\t// also factoring in the current rotation\r\n\t//------------------------------------------------\r\n\tgeneratePoints() {\r\n\t\tthis.pointArray = [];\r\n\t\tthis.originX = this.x;\r\n\t\tthis.originY = this.y + this.strokeWidth/2;\r\n\t\tlet angle = this._angle * Math.PI / 180.0;\r\n\t\tlet collisionX = 0, collisionY = 0;\r\n\r\n\t\tlet collisionWidth = (this.halfWidth + ((this.strokeWidth/4)*3));\r\n\t\tlet collisionHeight = (this.halfWidth + (this.strokeWidth/2));\r\n\r\n\t\tlet xPos = 0, yPos = 0;\r\n\t\txPos = Math.cos(angle) * (this.x - this.originX) - Math.sin(angle) * ((this.y - this.halfWidth) - this.originY) + this.originX;\r\n\t\tyPos = Math.sin(angle) * (this.x - this.originX) + Math.cos(angle) * ((this.y - this.halfWidth) - this.originY) + this.originY;\r\n\t\tcollisionX = Math.cos(angle) * (this.x - this.originX) - Math.sin(angle) * ((this.y - (collisionWidth + (this.strokeWidth/4))) - this.originY) + this.originX;\r\n\t\tcollisionY = Math.sin(angle) * (this.x - this.originX) + Math.cos(angle) * ((this.y - (collisionWidth + (this.strokeWidth/4))) - this.originY) + this.originY;\r\n\t\tthis.points = xPos + \" \" + yPos + \" \";\r\n\t\tthis.pointArray.push({x: xPos, y: yPos, collisionX: collisionX, collisionY: collisionY});\r\n\r\n\t\txPos = Math.cos(angle) * ((this.x + this.halfWidth) - this.originX) - Math.sin(angle) * ((this.y + this.halfWidth) - this.originY) + this.originX;\r\n\t\tyPos = Math.sin(angle) * ((this.x + this.halfWidth) - this.originX) + Math.cos(angle) * ((this.y + this.halfWidth) - this.originY) + this.originY;\r\n\t\tcollisionX = Math.cos(angle) * ((this.x + collisionWidth) - this.originX) - Math.sin(angle) * ((this.y + collisionHeight) - this.originY) + this.originX;\r\n\t\tcollisionY = Math.sin(angle) * ((this.x + collisionWidth) - this.originX) + Math.cos(angle) * ((this.y + collisionHeight) - this.originY) + this.originY;\r\n\t\tthis.points += xPos + \" \" + yPos + \" \";\r\n\t\tthis.pointArray.push({x: xPos, y: yPos, collisionX: collisionX, collisionY: collisionY});\r\n\r\n\t\txPos = Math.cos(angle) * ((this.x - this.halfWidth) - this.originX) - Math.sin(angle) * ((this.y + this.halfWidth) - this.originY) + this.originX;\r\n\t\tyPos = Math.sin(angle) * ((this.x - this.halfWidth) - this.originX) + Math.cos(angle) * ((this.y + this.halfWidth) - this.originY) + this.originY;\r\n\t\tcollisionX = Math.cos(angle) * ((this.x - collisionWidth) - this.originX) - Math.sin(angle) * ((this.y + collisionHeight) - this.originY) + this.originX;\r\n\t\tcollisionY = Math.sin(angle) * ((this.x - collisionWidth) - this.originX) + Math.cos(angle) * ((this.y + collisionHeight) - this.originY) + this.originY;\r\n\r\n\t\tthis.points += xPos + \" \" + yPos + \" \";\r\n\t\tthis.pointArray.push({x: xPos, y: yPos, collisionX: collisionX, collisionY: collisionY});\r\n\r\n\t\tthis.shape.setAttribute(\"points\", this.points);\r\n\t\tthis.effectsShape.setAttribute(\"points\", this.points);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Update the x/y position of the shape\r\n\t//------------------------------------------------\r\n\tsetPosition(x, y) {\r\n\t\tsuper.setPosition(x, y);\r\n\t\tthis.generatePoints();\r\n\r\n\t\tthis.buildCollisionModel();\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Figure out where the collision lines should be\r\n\t// Here they should be on the outside of the triangle\r\n\t//------------------------------------------------\r\n\tbuildCollisionModel() {\r\n\t\t// Store the previous frame's segment data\r\n\t\tthis.previousSegments = this.segments;\r\n\t\t\r\n\t\tthis.segments = [];\r\n\t\tlet line = {}, path = \"\";\r\n\t\tlet minX = this.pointArray[0].collisionX, minY = this.pointArray[0].collisionY, maxX = this.pointArray[0].collisionX, maxY = this.pointArray[0].collisionY;\r\n\r\n\t\tfor (let i = 0, length = this.pointArray.length; i < length; i++) {\r\n\t\t\tline = {};\r\n\t\t\tline.x1 = this.pointArray[i].collisionX;\r\n\t\t\tline.y1 = this.pointArray[i].collisionY;\r\n\t\t\tif (i < this.pointArray.length-1) {\r\n\t\t\t\tline.x2 = this.pointArray[i+1].collisionX;\r\n\t\t\t\tline.y2 = this.pointArray[i+1].collisionY;\r\n\t\t\t} else {\r\n\t\t\t\tline.x2 = this.pointArray[0].collisionX;\r\n\t\t\t\tline.y2 = this.pointArray[0].collisionY;\r\n\t\t\t}\r\n\t\t\tif (i === 0) {\r\n\t\t\t\tpath = \"M\" + line.x1 + \" \" + line.y1;\r\n\t\t\t}\r\n\t\t\tpath += \" L\" + line.x2 + \" \" + line.y2;\r\n\t\t\tthis.segments.push(line);\r\n\r\n\t\t\tif (line.x1 < minX) minX = line.x1;\r\n\t\t\tif (line.x2 < minX) minX = line.x2;\r\n\t\t\tif (line.y1 < minY) minY = line.y1;\r\n\t\t\tif (line.y2 < minY) minY = line.y2;\r\n\r\n\t\t\tif (line.x1 > maxX) maxX = line.x1;\r\n\t\t\tif (line.x2 > maxX) maxX = line.x2;\r\n\t\t\tif (line.y1 > maxY) maxY = line.y1;\r\n\t\t\tif (line.y2 > maxY) maxY = line.y2;\r\n\t\t}\r\n\t\tthis.segmentGuide.setAttribute(\"d\", path);\r\n\r\n\t\t// Update the center point guide\r\n\t\tthis.centerGuide.setAttribute(\"cx\", this.originX);\r\n\t\tthis.centerGuide.setAttribute(\"cy\", this.originY);\r\n\t\t// Update the actual bounding box\r\n\t\tthis.boundingBox.x = minX;\r\n\t\tthis.boundingBox.y = minY;\r\n\t\tthis.boundingBox.width = (maxX - minX);\r\n\t\tthis.boundingBox.height = (maxY - minY);\r\n\t\t// Update the bounding box guide line\r\n\t\tthis.boundingBoxGuide.setAttribute(\"x\", this.boundingBox.x);\r\n\t\tthis.boundingBoxGuide.setAttribute(\"y\", this.boundingBox.y);\r\n\t\tthis.boundingBoxGuide.setAttribute(\"width\", this.boundingBox.width);\r\n\t\tthis.boundingBoxGuide.setAttribute(\"height\", this.boundingBox.height);\r\n\t}\r\n\r\n\t//------------------------------------------------\r\n\t// Update the size of the shape and change the width\r\n\t// of stroke used\r\n\t//------------------------------------------------\r\n\tresize(strokeWidth, scale) {\r\n\t\tthis.strokeWidth = strokeWidth;\r\n\t\tthis.halfWidth = this.originalHalfWidth * scale;\r\n\t\tthis.shape.setAttribute(\"stroke-width\", this.strokeWidth);\r\n\t\tthis.shape.style.strokeWidth = this.strokeWidth;\r\n\t}\r\n}\r\n"],"sourceRoot":"/source/"}